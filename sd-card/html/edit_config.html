<!DOCTYPE html>
<html lang="en" xml:lang="en">

<head>
<meta charset="UTF-8"/>
<title>Configuration</title>

<style>
    h1 {font-size: 2em;}
    h2 {font-size: 1.5em; margin-block-start: 0.0em; margin-block-end: 0.2em;}
    h3 {font-size: 1.2em;}
    h4 {font-size: 1.05em; margin-bottom: 0;}
    h5 {font-size: 0.83em; margin-top: 0.2em; margin-bottom: 0;}
    p {font-size: 1em;}

    .table {
        border: 0pt;
        border-collapse: collapse;
        table-layout: fixed;
        width:100%;
    }

    td {
        padding: 10px;
        vertical-align: middle;
    }

    .button {
        padding: 5px 10px;
        width: 220px;
        font-size: 16px;	
    }

    input[type=number] {
        width: 60px;
        min-width: 60px;
        max-width: 60px;
        margin-right: 10px;
        padding: 3px 5px;
        display: inline-block;
        border: 1px solid #ccc;
        font-size: 16px;
        vertical-align: middle;
    }

    input[type=text] {
        width: 96%;
        min-width:240px;
        max-width:96%;
        margin-right: 10px;
        padding: 3px 5px;
        display: inline-block;
        border: 1px solid #ccc;
        font-size: 16px;
        vertical-align: middle;
    }

    select {
        min-width: 72px;
        max-width: 100%;
        padding: 3px 5px;
        display: inline-block;
        border: 1px solid #ccc;
        font-size: 16px; 
        margin-right: 10px;
        vertical-align: middle;
    }

    .select_large {
        width: 100%;
        min-width: 250px;
        max-width: 100%;
        padding: 3px 5px;
        display: inline-block;
        border: 1px solid #ccc;
        font-size: 16px; 
        margin-right: 10px;
        vertical-align: middle;
    }

    textarea {
        font-size: 14px;
    }

    .description {
        color: black;
        font-size: 80%;
    }

    .disabled {
        color:rgb(122, 122, 122);
    }

    #GPIO_LEDColor_value1 #GPIO_LEDColor_value2 #GPIO_LEDColor_value3 {
        width: 30px;
        font-size: 16px;
    }

    .invalid-input {
        background-color: #FFAA00;
    }

    input:out-of-range {
        background-color: rgba(255, 0, 0, 0.25);
        border: 1px solid red;
    }

    input:invalid {
        background-color: rgba(255, 0, 0, 0.25);
        border: 1px solid red;
    }

    .hidden {
        display: none;
    }

    .expert {
        background-color: #ffefef;
        font-size: 16px;
    }

    .indent1 {
        padding-left: 25px;
        font-size: 16px;
    }

    .indent2 {
        padding-left: 50px;
        font-size: 16px;
    }

    .tooltip {
        position: relative;
        display: inline-block;
    }

    .tooltip .tooltiptext {
        visibility: hidden;
        width: 600px;
        background-color: #fcfcfc;

        padding: 5px;
        padding-bottom: 0;

        border: solid black 2px; 

        /* Position the tooltip */
        position: absolute;
        z-index: 1;
        top: 100%;
        left: 100%;
        margin-left: -600px;
    }

    .tooltip:hover .tooltiptext {
        visibility: visible;
    }

    .tooltip-content {
        width: calc(100% - 2px);
        height: calc(100% - 2px);
        padding: 1px;
    }
	
    #overlay {
        position: fixed;
        display: none;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.8);
        z-index: 2;
    }

    #overlaytext{
        position: absolute;
        top: 50%;
        left: 50%;
        font-size: 150%;
        color: white;
        transform: translate(-50%,-50%);
        -ms-transform: translate(-50%,-50%);
    }

	#reboot_button {
		float: none;
		background-color: #f44336;
		color: white;
		padding: 5px;
		border-radius:
		5px; font-weight: bold;
		text-align: center;
		text-decoration: none;
		display: inline-block;
	}	
</style>

<link rel="stylesheet" href="mkdocs_theme.css?v=$COMMIT_HASH" />
<link rel="stylesheet" href="mkdocs_theme_extra.css?v=$COMMIT_HASH" />
<link rel="stylesheet" href="github.min.css?v=$COMMIT_HASH" />

<link href="firework.css?v=$COMMIT_HASH" rel="stylesheet">

<script type="text/javascript" src="common.js?v=$COMMIT_HASH"></script>
<script type="text/javascript" src="jquery-3.6.0.min.js?v=$COMMIT_HASH"></script>
<script type="text/javascript" src="firework.js?v=$COMMIT_HASH"></script>

</head>

<body style="font-family: arial; padding: 0px 10px;">
    <div id="overlay">
        <div id="overlaytext"></div>
    </div>

    <h2>Configuration</h2>

    <details id="desc_details">
        <summary><b>CLICK HERE</b> for usage description. More infos in documentation: 
            <a href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters" target="_blank">Parameter</a>
        </summary>
        <p>
            This page lists all available configuration parameters of the device.<br>
            The description of each parameter can be shown by hovering over or by clicking the <img src="help.png" width="16px"> icon.
        </p>
        <p>	
            The page gets opened with the default view which should be sufficient for regular configuration tasks. Enabling the <b>"Show Expert Parameters"</b>
            some expert parameters (light red background color) will be added to the parameter list. Additionally the button <b>"Edit "Config.ini" File"</b>
            to edit the underlaying configuration file (config.ini) manually is now shown on top of the page. This function should be only used for special cases.
        </p>
        <p>
            Sections (entire functionality) or single parameters having a checkbox can be enabled or disabled.
            Disabling a complete section results in a disabled functionality. Whenever only a single parameter of a section is disabled
            the hard-coded default value is used for the disabled parameter.
        </p>
        <p>
            Don't forget to save the changes with the button <b>"Save Config"</b> at the bottom of this page.<br>
            <label id="reboot_text" name="reboot_text">
                To apply the new configuration a restart of the device is neccessary: <b>"Reboot to apply changes"</b>
            </label>
        </p>
    </details>
    <hr />

<div id="divall" style="display:none">
    <table class="table">
        <colgroup>
            <col span="1" style="width:290px">
            <col span="1" style="width:300px;">
            <col span="1">
        </colgroup>

        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Configuration View</h4></td>
        </tr>

        <tr>
            <td class="indent1">
                <input style="margin-top:12px;margin-bottom:12px" type="checkbox" id="ExpertModus_enabled" value="1"  onclick='UpdateExpertModus()' unchecked>
                <label for="ExpertModus_enabled">Show Expert Parameters</label> 
            </td>
            <td>
                <button style="display:none;" class="button" id="Button_Edit_Config_Raw" onclick="editConfigRaw()">Edit Config file in raw mode</button>
            </td>
        </tr>

        <!------------- Take Image ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Take Image</h4></td>
        </tr> 

        <tr>
            <td class="indent1">
                <input type="checkbox" id="TakeImage_RawImagesLocation_enabled" value="1" onclick='InvertEnableItem("TakeImage", "RawImagesLocation")' unchecked >
                <label for=TakeImage_RawImagesLocation_enabled><class id="TakeImage_RawImagesLocation_text" style="color:black;">Raw Images Location</class></label>
            </td>
            <td>
                <input required type="text" name="name" id="TakeImage_RawImagesLocation_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>RawImagesLocation</code></h3>
<p>Location on the SD-Card to store the raw images.</p>
<p>Default Value: <code>/log/source</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A SD-Card has limited write cycles. Since the device does not do <a target=_blank href="https://en.wikipedia.org/wiki/Wear_leveling">Wear Leveling</a>, this can wear out your SD-Card!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent1">
                <input type="checkbox" id="TakeImage_RawImagesRetention_enabled" value="1" onclick='InvertEnableItem("TakeImage", "RawImagesRetention")' unchecked >
                <label for=TakeImage_RawImagesRetention_enabled><class id="TakeImage_RawImagesRetention_text" style="color:black;">Raw Images Retention</class></label>
            </td>
            <td>
                <input required type="number" id="TakeImage_RawImagesRetention_value1" size="13" min="0" step="1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Days
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>RawImagesRetention</code></h3>
<p>Number of days to keep the raw images (<code>0</code> = forever)</p>
<p>Unit: Days</p>
<p>Default Value: <code>15</code></p>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_WaitBeforeTakingPicture_ex3">
            <td class="indent1">
                <class id="TakeImage_WaitBeforeTakingPicture_text" style="color:black;">Wait Before Taking Picture</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_WaitBeforeTakingPicture_value1" size="13" min="0" step="any" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=0));">Seconds
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>WaitBeforeTakingPicture</code></h3>
<p>Waiting time between switching the flash light (onboard LED) on and taking the picture.</p>
<p>Unit: seconds</p>
<p>Default Value: <code>5</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamGainceiling_ex3">
            <td class="indent1">
                <class id="TakeImage_CamGainceiling_text" style="color:black;">CamGainceiling</class>
            </td>
            <td>
                <select id="TakeImage_CamGainceiling_value1" onchange="cameraParameterChanged()">
                    <option value="x2" selected>x2</option>
                    <option value="x4" >x4</option>
                    <option value="x8" >x8</option>	
                    <option value="x16" >x16</option>
                    <option value="x32" >x32</option>
                    <option value="x64" >x64</option>
                    <option value="x128" >x128</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamGainceiling</code></h3>
<p><strong>Gain-Ceiling</strong></p>
<p>Available options:</p>
<ul>
<li><code>x2</code></li>
<li><code>x4</code></li>
<li><code>x8</code></li>
<li><code>x16</code></li>
<li><code>x32</code></li>
<li><code>x64</code></li>
<li><code>x128</code></li>
</ul>
<p>Default Value for ov2640: <code>x4</code><br>
Default Value for ov5640: <code>x8</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A higher gain means that the sensor has a greater response to light, but also makes sensor noise more visible.</p>
<p>This is used when <strong>CamAgc</strong> is on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Gain</strong> is an analog multiplier applied to the raw sensor data.<br>
The <strong>Ceiling</strong> is the maximum gain value that the sensor will use.</p>
</div>
    </span></div></div>
</td>
        </tr>		
		
        <tr class="expert" unused_id="TakeImage_CamQuality_ex3">
            <td class="indent1">
                <class id="TakeImage_CamQuality_text" style="color:black;">Image Quality</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamQuality_value1" size="13" min="5" max="63" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=5)) && (!validity.rangeOverflow||(value=63)) &&
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamQuality</code></h3>
<p><strong>Image-Quality</strong></p>
<p>Range (<code>8</code> .. <code>63</code>)</p>
<p>Default Value: <code>10</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
<p>Value below 10 could result in system instabilities!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quality index for pictures: <code>8</code> (highest quality) ... <code>63</code> (lowest quality)</p>
<p>This is similar to the quality setting when exporting a jpeg image from photo editing software.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr unused_id="TakeImage_CamBrightness_ex3">
            <td class="indent1">
                <class id="TakeImage_CamBrightness_text" style="color:black;">Brightness</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamBrightness_value1" size="13" min="-2" max="2" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamBrightness</code></h3>
<p><strong>Image-Brightness</strong></p>
<p>Range (<code>-2</code> .. <code>2</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr unused_id="TakeImage_CamContrast_ex3">
            <td class="indent1">
                <class id="TakeImage_CamContrast_text" style="color:black;">Contrast</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamContrast_value1" size="13" min="-2" max="2" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamContrast</code></h3>
<p><strong>Image-Contrast</strong></p>
<p>Range (<code>-2</code> .. <code>2</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr unused_id="TakeImage_CamSaturation_ex3">
            <td class="indent1">
                <class id="TakeImage_CamSaturation_text" style="color:black;">Saturation</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamSaturation_value1" size="13" min="-2" max="2" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamSaturation</code></h3>
<p><strong>Image-Saturation</strong></p>
<p>Range (<code>-2</code> .. <code>2</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Positive values increase saturation (more vibrant colors), negative values lower it (more muted colors).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAutoSharpness_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAutoSharpness_text" style="color:black;">AutoSharpness</class>
            </td>
            <td>
                <select id="TakeImage_CamAutoSharpness_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAutoSharpness</code></h3>
<p><strong>Auto-Sharpness</strong></p>
<ul>
<li>When <strong>true</strong>, the camera attempts to automatically adjusts the sharpness.</li>
<li>When <strong>false</strong>, the <strong>CamSharpness</strong> setting is used instead.</li>
</ul>
<p>Default Value: <code>false</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OV2640 does not officially support auto sharpness, this is an experimental parameter!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamSharpness_ex3">
            <td class="indent1">
                <class id="TakeImage_CamSharpness_text" style="color:black;">Sharpness</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamSharpness_value1" size="13" min="-3" max="3" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=-3)) && (!validity.rangeOverflow||(value=3)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamSharpness</code></h3>
<p><strong>Image-Sharpness</strong></p>
<p>Range (<code>-2</code> .. <code>2</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The OV2640 does not officially support sharpness, this is an experimental parameter!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Positive values increase sharpness (more defined edges), negative values lower it (softer edges).</p>
<p>This is used when <strong>CamAutoSharpness</strong> is off.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamSpecialEffect_ex3">
            <td class="indent1">
                <class id="TakeImage_CamSpecialEffect_text" style="color:black;">SpecialEffect</class>
            </td>
            <td>
                <select id="TakeImage_CamSpecialEffect_value1" onchange="cameraParameterChanged()">
                    <option value="no_effect" selected>no effect</option>
                    <option value="negative" >negative</option>
                    <option value="grayscale" >grayscale</option>					
                    <option value="red" >red</option>					
                    <option value="green" >green</option>					
                    <option value="blue" >blue</option>					
                    <option value="retro" >retro</option>					
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamSpecialEffect</code></h3>
<p><strong>Image-Special-Effect</strong></p>
<p>Available options:</p>
<ul>
<li><code>no_effect</code></li>
<li><code>negative</code></li>
<li><code>grayscale</code></li>
<li><code>red</code></li>
<li><code>green</code></li>
<li><code>blue</code></li>
<li><code>retro</code></li>
</ul>
<p>Default Value: <code>no_effect</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>
		
        <tr class="expert" unused_id="TakeImage_CamWbMode_ex3">
            <td class="indent1">
                <class id="TakeImage_CamWbMode_text" style="color:black;">White Balance Mode</class>
            </td>
            <td>
                <select id="TakeImage_CamWbMode_value1" onchange="cameraParameterChanged()">
                    <option value="auto" selected>auto</option>
                    <option value="sunny" >sunny</option>
                    <option value="cloudy" >cloudy</option>
                    <option value="office" >office</option>
                    <option value="home" >home</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamWbMode</code></h3>
<p><strong>White-Balance-Mode</strong></p>
<p>Available options:</p>
<ul>
<li><code>auto</code></li>
<li><code>sunny</code></li>
<li><code>cloudy</code></li>
<li><code>office</code></li>
<li><code>home</code></li>
</ul>
<p>Default Value: <code>auto</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is used when <strong>CamAwb</strong> is off.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAwb_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAwb_text" style="color:black;">White Balance</class>
            </td>
            <td>
                <select id="TakeImage_CamAwb_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAwb</code></h3>
<p><strong>Auto-White-Balance</strong></p>
<ul>
<li>When <strong>true</strong>, the camera attempts to automatically control white balance.</li>
<li>When <strong>false</strong>, the <strong>CamWbMode</strong> setting is used instead.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAwbGain_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAwbGain_text" style="color:black;">Auto White Balance</class>
            </td>
            <td>
                <select id="TakeImage_CamAwbGain_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAwbGain</code></h3>
<p><strong>Auto-White-Balance-Gain</strong></p>
<ul>
<li>Enable/Disable <strong>CamAwbGain</strong> control.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAec_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAec_text" style="color:black;">Auto-Exposure Control</class>
            </td>
            <td>
                <select id="TakeImage_CamAec_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAec</code></h3>
<p><strong>Auto-Exposure-Control</strong></p>
<ul>
<li>When <strong>true</strong>, the camera attempts to automatically control the exposure.</li>
<li>When <strong>false</strong>, the <strong>CamAecValue</strong> setting is used instead.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAec2_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAec2_text" style="color:black;">Auto-Exposure Control 2</class>
            </td>
            <td>
                <select id="TakeImage_CamAec2_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAec2</code></h3>
<p><strong>Auto-Exposure-Control2</strong></p>
<ul>
<li>When <strong>true</strong>, the sensor’s "night mode" is enabled, extending the range of automatic gain control.</li>
<li>When <strong>false</strong>, the sensor’s "night mode" is disabled.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may resolve some over-exposure and under-exposure issues.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAeLevel_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAeLevel_text" style="color:black;">Auto Exposure Level</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamAeLevel_value1" size="13" min="-5" max="5" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=-5)) && (!validity.rangeOverflow||(value=5)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAeLevel</code></h3>
<p><strong>Auto-Exposure-Level</strong></p>
<p>range on OV2640 (<code>-2</code> .. <code>2</code>)<br>
range on OV3660 and OV5640 (<code>-5</code> .. <code>5</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exposure offset for automatic exposure, lower values produce darker image.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAecValue_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAecValue_text" style="color:black;">Auto Exposure Value</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamAecValue_value1" size="13" min="0" max="1200" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=1200)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAecValue</code></h3>
<p><strong>Auto-Exposure-Value</strong></p>
<p>Range (<code>0</code> .. <code>1200</code>)</p>
<p>Default Value: <code>160</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Access the exposure value of the camera, higher values produce brighter images.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamAgc_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAgc_text" style="color:black;">Auto Gain</class>
            </td>
            <td>
                <select id="TakeImage_CamAgc_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAgc</code></h3>
<p><strong>Auto-Gain-Control</strong></p>
<ul>
<li>When <strong>true</strong>, the camera attempts to automatically control the sensor gain, up to the value in the <strong>CamGainceiling</strong> property.</li>
<li>When <strong>false</strong>, the <strong>CamAgcGain</strong> setting is used instead.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
    </span></div></div>
</td>
        </tr>		

        <tr class="expert" unused_id="TakeImage_CamAgcGain_ex3">
            <td class="indent1">
                <class id="TakeImage_CamAgcGain_text" style="color:black;">Gain Manual Value</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamAgcGain_value1" size="13" min="0" max="30" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=30)) &&
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamAgcGain</code></h3>
<p><strong>Auto-Gain-Control-Value</strong></p>
<p>Range (<code>0</code> .. <code>30</code>)</p>
<p>Default Value: <code>15</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is used when <strong>CamAgc</strong> is off.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Access the gain level of the sensor, higher values produce brighter images.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamBpc_ex3">
            <td class="indent1">
                <class id="TakeImage_CamBpc_text" style="color:black;">Black Pixel Correction</class>
            </td>
            <td>
                <select id="TakeImage_CamBpc_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamBpc</code></h3>
<p><strong>Black-Pixel-Correction</strong></p>
<ul>
<li>Enable/Disable <strong>black point compensation</strong>, this can make black parts of the image darker.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
    </span></div></div>
</td>
        </tr>
		
        <tr class="expert" unused_id="TakeImage_CamWpc_ex3">
            <td class="indent1">
                <class id="TakeImage_CamWpc_text" style="color:black;">White Pixel Correction</class>
            </td>
            <td>
                <select id="TakeImage_CamWpc_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamWpc</code></h3>
<p><strong>White-Pixel-Correction</strong></p>
<ul>
<li>Enable/Disable <strong>white point compensation</strong>, his can make white parts of the image whiter.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamRawGma_ex3">
            <td class="indent1">
                <class id="TakeImage_CamRawGma_text" style="color:black;">CamRawGma</class>
            </td>
            <td>
                <select id="TakeImage_CamRawGma_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamRawGma</code></h3>
<p><strong>Raw-Gamma</strong></p>
<ul>
<li>Enable/Disable raw gamma mode.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main purpose of the Gamma (GMA) function is to compensate for the non-linear characteristics of the sensor. 
GMA converts the pixel values according to the Gamma curve to compensate the sensor output under different light strengths.
The non-linear gamma curve is approximately constructed with different linear functions. Raw gamma compensates the
image in the RAW domain.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamLenc_ex3">
            <td class="indent1">
                <class id="TakeImage_CamLenc_text" style="color:black;">Lens Correction</class>
            </td>
            <td>
                <select id="TakeImage_CamLenc_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamLenc</code></h3>
<p><strong>Lens-Correction</strong></p>
<ul>
<li>Enable/Disable lens correction.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can help compensate for light fall-off at the edge of the sensor area.</p>
</div>
    </span></div></div>
</td>
        </tr>
		
        <tr unused_id="TakeImage_CamHmirror_ex3">
            <td class="indent1">
                <class id="TakeImage_CamHmirror_text" style="color:black;">Mirror Image</class>
            </td>
            <td>
                <select id="TakeImage_CamHmirror_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamHmirror</code></h3>
<p><strong>Mirror-Image</strong></p>
<ul>
<li>When <strong>true</strong>, the camera image is mirrored left-to-right.</li>
</ul>
<p>Default Value: <code>false</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>		
		
        <tr unused_id="TakeImage_CamVflip_ex3">
            <td class="indent1">
                <class id="TakeImage_CamVflip_text" style="color:black;">Flip Image</class>
            </td>
            <td>
                <select id="TakeImage_CamVflip_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamVflip</code></h3>
<p><strong>Flip-Image</strong></p>
<ul>
<li>When <strong>true</strong>, the camera image is flipped top-to-bottom.</li>
</ul>
<p>Default Value: <code>false</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On some OV5640 Cameras, the image becomes reddish when Vflip is used in conjunction with the zoom function!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamDcw_ex3">
            <td class="indent1">
                <class id="TakeImage_CamDcw_text" style="color:black;">Downsize</class>
            </td>
            <td>
                <select id="TakeImage_CamDcw_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamDcw</code></h3>
<p><strong>Image-Downsize</strong></p>
<ul>
<li>When <strong>CamDcw</strong> is on, the image that you receive will be the size that you requested (VGA, QQVGA, etc).</li>
<li>When <strong>CamDcw</strong> is off, the image that you receive will be one of UXGA, SVGA, or CIF.</li>
</ul>
<p>Default Value: <code>true</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
<p>If <strong>CamZoom</strong> is used, this must be activated.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <strong>CamDcw</strong> is off, and you pick a different image size, this implicitly turns <strong>CamDcw</strong> back on again. </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamDenoise_ex3">
            <td class="indent1">
                <class id="TakeImage_CamDenoise_text" style="color:black;">Denoise</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamDenoise_value1" value="0" min="0" max="8" step="1" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeOverflow||(value=8)) && (!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamDenoise</code></h3>
<p><strong>Image-Denoise</strong></p>
<ul>
<li>Denoise Image, is only supported by OV3660 and OV5640</li>
</ul>
<p>range on OV3660 and OV5640 (0 .. 8)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamZoom_ex3">
            <td class="indent1">
                <class id="TakeImage_CamZoom_text" style="color:black;">Zoom</class>
            </td>
            <td>
                <select id="TakeImage_CamZoom_value1" onchange="cameraParameterChanged()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamZoom</code></h3>
<p><strong>Digital-Zoom</strong></p>
<ul>
<li>Enable/Disable digital zoom.</li>
</ul>
<p>Default Value: <code>false</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is always zoomed into the center of the image, if <strong>CamZoomOffsetX</strong> and <strong>CamZoomOffsetY</strong> are zero.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamZoomSize_ex3">
            <td class="indent1">
                <class id="TakeImage_CamZoomSize_text" style="color:black;">Zoom Size</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamZoomSize_value1" value="0" min="0" max="59" step="1" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeOverflow||(value=59)) && (!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamZoomSize</code></h3>
<p><strong>Digital-Zoom-Size</strong></p>
<p>range on OV2640 (<code>0</code> .. <code>29</code>)<br>
range on OV3660 (<code>0</code> .. <code>43</code>)<br>
range on OV5640 (<code>0</code> .. <code>59</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Zoom factor/level of the digital zoom, the larger the value, the more it zooms in.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>			
        </tr>

        <tr class="expert" unused_id="TakeImage_CamZoomOffsetX_ex3">
            <td class="indent1">
                <class id="TakeImage_CamZoomOffsetX_text" style="color:black;">Zoom Offset X</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamZoomOffsetX_value1" value="0" min="-960" max="960" step="8" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeOverflow||(value=960)) && (!validity.rangeUnderflow||(value=-960)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Pixel
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamZoomOffsetX</code></h3>
<p><strong>Digital-Zoom-OffsetX</strong></p>
<p>range on OV2640 (<code>-480</code> .. <code>480</code>)<br>
range on OV3660 (<code>-704</code> .. <code>704</code>)<br>
range on OV5640 (<code>-960</code> .. <code>960</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>X displacement of the image from the center.<br>
Positive values ​​shift the image to the right, negative values ​​to the left.<br>
The maximum possible offset depends on the value of the <strong>CamZoomSize</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="TakeImage_CamZoomOffsetY_ex3">
            <td class="indent1">
                <class id="TakeImage_CamZoomOffsetY_text" style="color:black;">Zoom Offset Y</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_CamZoomOffsetY_value1" value="0" min="-720" max="720" step="8" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeOverflow||(value=720)) && (!validity.rangeUnderflow||(value=-720)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Pixel
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CamZoomOffsetY</code></h3>
<p><strong>Digital-Zoom-OffsetY</strong></p>
<p>range on OV2640 (<code>-360</code> .. <code>360</code>)<br>
range on OV3660 (<code>-528</code> .. <code>528</code>)<br>
range on OV5640 (<code>-720</code> .. <code>720</code>)</p>
<p>Default Value: <code>0</code></p>
<p>See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/Camera.ov2640_ds_1.8_.pdf">here</a> for the ov2640 camera datasheet.<br>
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/datasheets/OV5640_datasheet.pdf">here</a> for the ov5640 camera datasheet.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Y displacement of the image from the center.<br>
Positive values ​​move the image up, negative values ​​move the image down.<br>
The maximum possible offset depends on the value of the <strong>CamZoomSize</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr unused_id="TakeImage_LEDIntensity_ex3">
            <td class="indent1">
                <class id="TakeImage_LEDIntensity_text" style="color:black;">LED Intensity</class>
            </td>
            <td>
                <input required type="number" id="TakeImage_LEDIntensity_value1" size="13" min="0" max="100" onchange="cameraParameterChanged()"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=100)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LEDIntensity</code></h3>
<p>Set the Flash LED Intensity: (<code>0</code> .. <code>100</code>)</p>
<p>Default Value: <code>50</code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
    </span></div></div>
</td>
        </tr>
		
        <tr class="expert" unused_id="TakeImage_Demo_ex3">
            <td class="indent1">
                <label>
                    <class id="TakeImage_Demo_text" style="color:black;">Demo Mode</class>
                </label>
            </td>
            <td>
                <select id="TakeImage_Demo_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Demo</code></h3>
<p>Enable to use demo images instead of the real camera images.
Make sure to have a <code>/demo</code> folder on your SD-Card and make sure it contains the expected files!
Check <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Demo-Mode">here</a> for details.</p>
<p>Default Value: <code>false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- Alignment ------------------>
        <tr  style="border-bottom: 2px solid lightgray;" id="ex4">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Alignment</h4></td>
        </tr>

        <tr class="expert" unused_id="Alignment_SearchFieldX_ex6">
            <td class="indent1">
                <class id="Alignment_SearchFieldX_text" style="color:black;">Search Field X</class>
            </td>
            <td>
                <input required type="number" name="name" id="Alignment_SearchFieldX_value1" size="13" min="1"  step="1"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Pixel
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>SearchFieldX</code></h3>
<p>Default Value: <code>20</code></p>
<p>Unit: Pixels</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>X-size (width) in which the reference is searched.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the alignment is one of the steps using a lot of computation time, 
 the search field should be as small as possible.
 The calculation time goes quadratic with the search field size.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="Alignment_SearchFieldY_ex8">
            <td class="indent1">
                <class id="Alignment_SearchFieldY_text" style="color:black;">Search Field Y</class>
            </td>
            <td>
                <input required type="number" name="name" id="Alignment_SearchFieldY_value1" size="13" min="1"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Pixel
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>SearchFieldY</code></h3>
<p>Default Value: <code>20</code></p>
<p>Unit: Pixels</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Y-size (height) in which the reference is searched.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the alignment is one of the steps using a lot of computation time, 
 the search field should be as small as possible.
 The calculation time goes quadratic with the search field size.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="Alignment_AlignmentAlgo_ex8">
            <td class="indent1">
                <input type="checkbox" id="Alignment_AlignmentAlgo_enabled" value="1"  onclick = 'InvertEnableItem("Alignment", "AlignmentAlgo")' unchecked >
                <label for=Alignment_AlignmentAlgo_enabled><class id="Alignment_AlignmentAlgo_text" style="color:black;">Alignment Algorithm</class></label>
            </td>
            <td>
                <select id="Alignment_AlignmentAlgo_value1">
                    <option value="default" selected>Default</option>
                    <option value="highAccuracy" >HighAccuracy</option>
                    <option value="fast" >Fast</option>
                    <option value="off" >Off</option><!-- add disable aligment algo |01.2023 -->
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>AlignmentAlgo</code></h3>
<p>Default Value: <code>Default</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Algorithm used for the alignment step.</p>
<p>Available options:</p>
<ul>
<li><code>Default</code>: Use only red color channel</li>
<li><code>HighAccuracy</code>: Use all 3 color channels (3x slower)</li>
<li><code>Fast</code>: First time use <code>HighAccuracy</code>, then only check if the image is shifted</li>
<li><code>Off</code>: Disable alignment algorithm</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr unused_id="Alignment_InitialRotate_ex8">
            <td class="indent1">
                <class id="Alignment_InitialRotate_text" style="color:black;">Rotation angle</class>
            </td>
            <td>
                <input required type="number" name="name" id="Alignment_InitialRotate_value1" size="13" min="-180" max="+180" step="0.1"
                    oninput="(!validity.rangeOverflow||(value=180)) && (!validity.rangeUnderflow||(value=-180)) && (!validity.stepMismatch||(value=parseInt(this.value)));">degree
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>InitialRotate</code></h3>
<p>Default Value: <code>0</code></p>
<p>Unit: Degrees</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter can also be set on the Reference Image configuration page!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After changing this parameter you need to update your reference image and alignment markers!</p>
</div>
<p>Initial rotation of image before alignment in degree (<code>-360</code> .. <code>+360</code>)</p>
    </span></div></div>
</td>
        </tr>

        <!------------- Digit ROIs ------------------>
        <tr style="border-bottom: 2px solid lightgray;" id="Category_Digits_ex4">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4><input type="checkbox" id="Category_Digits_enabled" value="1"  onclick ='UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_Digits_enabled>Digit ROI Processing</label></h4>
            </td>
        </tr>

        <tr class="DigitItem">
            <td class="indent1" >
                <class id="Digits_Model_text" style="color:black;">Model</class>
            </td>
            <td>
                <select required class="select_large" id="Digits_Model_value1">
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Model</code></h3>
<p>Default Value: <code>/config/dig-cont_*.tflite</code> (See <a target=_blank href="https://github.com/jomjol/AI-on-the-edge-device/blob/master/sd-card/config/config.ini">/config/config.ini</a>)</p>
<p>Path to CNN model file for image recognition. See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Choosing-the-Model">here</a> for details. </p>
    </span></div></div>
</td>
        </tr>
		
        <tr class="DigitItem expert" unused_id="ex91">
            <td class="indent1">
                <input type="checkbox" id="Digits_CNNGoodThreshold_enabled" value="1"  onclick = 'InvertEnableItem("Digits", "CNNGoodThreshold")' unchecked >
                <label for=Digits_CNNGoodThreshold_enabled><class id="Digits_CNNGoodThreshold_text" style="color:black;">CNN Good Threshold</class></label>
            </td>
            <td>
                <input required type="number" id="Digits_CNNGoodThreshold_value1" min="0" max="1" step="0.1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=1)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CNNGoodThreshold</code></h3>
<p>Default Value: <code>0.5</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Threshold above which the classification should be to accept the value (only meaningful for digits).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is only supported for the <code>dig-class100</code> models!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="DigitItem">
            <td class="indent1">
                <input type="checkbox" id="Digits_ROIImagesLocation_enabled" value="1"  onclick = 'InvertEnableItem("Digits", "ROIImagesLocation")' unchecked >
                <label for=Digits_ROIImagesLocation_enabled><class id="Digits_ROIImagesLocation_text" style="color:black;">ROI Images Location</class></label>
            </td>
            <td>
                <input required type="text" name="name" id="Digits_ROIImagesLocation_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ROIImagesLocation</code></h3>
<p>Default Value: <code>/log/digit</code></p>
<p>Location to store separated digit images on the SD-Card.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A SD-Card has limited write cycles. Since the device does not do <a target=_blank href="https://en.wikipedia.org/wiki/Wear_leveling">Wear Leveling</a>, this can wear out your SD-Card!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="DigitItem">
            <td class="indent1">
                <input type="checkbox" id="Digits_ROIImagesRetention_enabled" value="1"  onclick = 'InvertEnableItem("Digits", "ROIImagesRetention")' unchecked >
                <label for=Digits_ROIImagesRetention_enabled><class id="Digits_ROIImagesRetention_text" style="color:black;">ROI Images Retention</class></label>
            </td>
            <td>
                <input required type="number" id="Digits_ROIImagesRetention_value1" min="0"  step="1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Days
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ROIImagesRetention</code></h3>
<p>Default Value: <code>3</code></p>
<p>Unit: Days</p>
<p>Days to keep the separated digit images (<code>0</code> = forever).</p>
    </span></div></div>
</td>
        </tr>

        <!------------- Ananlog ROIs ------------------>
        <tr style="border-bottom: 2px solid lightgray;" id="Category_Analog_ex4">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4><input type="checkbox" id="Category_Analog_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_Analog_enabled>Analog ROI Processing</label></h4>
            </td>
        </tr>

        <tr class="AnalogItem">
            <td class="indent1">
                <class id="Analog_Model_text" style="color:black;">Model</class>
            </td>
            <td> 
                <select required class="select_large" id="Analog_Model_value1"></select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Model</code></h3>
<p>Default Value: <code>/config/ana-cont_*.tflite</code> (See <a target=_blank href="https://github.com/jomjol/AI-on-the-edge-device/blob/master/sd-card/config/config.ini">/config/config.ini</a>)</p>
<p>Path to CNN model file for image recognition. See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Choosing-the-Model">here</a> for details. </p>
    </span></div></div>
</td>
        </tr>

        <tr class="AnalogItem">
            <td class="indent1">
                <input type="checkbox" id="Analog_ROIImagesLocation_enabled" value="1"  onclick = 'InvertEnableItem("Analog", "ROIImagesLocation")' unchecked >
                <label for=Analog_ROIImagesLocation_enabled><class id="Analog_ROIImagesLocation_text" style="color:black;">ROI Images Location</class></label>
            </td>
            <td> <input required type="text" name="name" id="Analog_ROIImagesLocation_value1"> </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ROIImagesLocation</code></h3>
<p>Default Value: <code>/log/analog</code></p>
<p>Location to store separated analog images on the SD-Card.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A SD-Card has limited write cycles. Since the device does not do <a target=_blank href="https://en.wikipedia.org/wiki/Wear_leveling">Wear Leveling</a>, this can wear out your SD-Card!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="AnalogItem">
            <td class="indent1">
                <input type="checkbox" id="Analog_ROIImagesRetention_enabled" value="1"  onclick = 'InvertEnableItem("Analog", "ROIImagesRetention")' unchecked >
                <label for=Analog_ROIImagesRetention_enabled><class id="Analog_ROIImagesRetention_text" style="color:black;">ROI Images Retention</class></label>
            </td>
            <td> 
                <input required type="number" id="Analog_ROIImagesRetention_value1" min="0" step="1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Days
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ROIImagesRetention</code></h3>
<p>Default Value: <code>3</code></p>
<p>Unit: Days</p>
<p>Days to keep the separated analog images (<code>0</code> = forever).</p>
    </span></div></div>
</td>
        </tr>

        <!------------- Post-Processing ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Post-Processing</h4></td>
        </tr>

        <tr>
            <td class="indent1">
                <label><class id="PostProcessing_PreValueUse_text" style="color:black;">Previous Value</class></label>
            </td>
            <td>
                <select id="PostProcessing_PreValueUse_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>PreValueUse</code></h3>
<p>Default Value: <code>true</code></p>
<p>Use the previous value (value from previous round) for consistency checks.
This also works through a reboot of the device!</p>
    </span></div></div>
</td>
        </tr>
		
        <tr class="expert" unused_id="ex11">
            <td class="indent1">
                <input type="checkbox" id="PostProcessing_PreValueAgeStartup_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "PreValueAgeStartup")' unchecked >
                <label for=PostProcessing_PreValueAgeStartup_enabled><class id="PostProcessing_PreValueAgeStartup_text" style="color:black;">Maximum Age of Previous Value after Startup</class></label>
            </td>
            <td>
                <input required type="number" id="PostProcessing_PreValueAgeStartup_value1" size="13" min="0"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Minutes
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>PreValueAgeStartup</code></h3>
<p>Default Value: <code>720</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Time in minutes, how long a previous read value is valid after reboot.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="ex12">
            <td class="indent1">
                <label><class id="PostProcessing_ErrorMessage_text" style="color:black;">Skip Messages on Error</class></label>
            </td>
            <td>
                <select id="PostProcessing_ErrorMessage_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ErrorMessage</code></h3>
<p>Default Value: <code>true</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Do not show error message in return value.
In an error case, the last valid number will be used for the various transmission protocols (MQTT, InfluxDB, REST, ...).</p>
    </span></div></div>
</td>
        </tr>

        <tr style="margin-top:12px">
            <td class="indent1" style="padding-top:25px" colspan="3">
                <b>The following parameters are configurable individually for each number sequence:</b>
                <select style="font-weight: bold; margin-left:17px" id="Numbers_value1" onchange="numberChanged()"></select>
            </td>
        </tr>

        <tr>
            <td class="indent2">
                <label><class id="PostProcessing_AllowNegativeRates_text" style="color:black;">Allow Negative Rate</class></label>
            </td>
            <td>
                <select id="PostProcessing_AllowNegativeRates_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>AllowNegativeRates</code></h3>
<p>Default Value: <code>false</code></p>
<p>Allow a meter to count backwards (decreasing values).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is unusual (it means there is a negative rate) and not wanted in most cases!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.AllowNegativeRates</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <input type="checkbox" id="PostProcessing_DecimalShift_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "DecimalShift")' unchecked >
                <label for=PostProcessing_DecimalShift_enabled><class id="PostProcessing_DecimalShift_text" style="color:black;">Decimal Shift</class></label>
            </td>
            <td>
                <input required type="number" id="PostProcessing_DecimalShift_value1" value="0" step="1" min="-9" max="9"
                    oninput="(!validity.rangeUnderflow||(value=-9)) && (!validity.rangeOverflow||(value=9)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>DecimalShift</code></h3>
<p>Default Value: <code>0</code></p>
<p>Shift the decimal separator (positiv or negativ).
Eg. to move from <code>m³</code> to <code>liter</code> (<code>1 m³</code> equals <code>1000 liters</code>), you need to set it to <code>+3</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.DecimalShift</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <input type="checkbox" id="PostProcessing_AnalogToDigitTransitionStart_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "AnalogToDigitTransitionStart")' unchecked >
                <label for=PostProcessing_AnalogToDigitTransitionStart_enabled><class id="PostProcessing_AnalogToDigitTransitionStart_text" style="color:black;">Analog to Digit Transition Start</class></label>
            </td>
            <td>
                <input required type="number" id="PostProcessing_AnalogToDigitTransitionStart_value1" step="0.1" min="5.0" max="9.9" value="9.2"
                    oninput="(!validity.rangeUnderflow||(value=5.0)) && (!validity.rangeOverflow||(value=9.9)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>AnalogToDigitTransitionStart</code></h3>
<p>Default Value: <code>9.2</code></p>
<p>This can be used if you have wrong values, but the recognition of the individual ROIs are correct.
Look for the start of changing of the first digit and note the analog pointer value behind.
Set it here. Only used on combination of digits and analog pointers.
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Watermeter-specific-analog---digit-transition">here</a> for details.</p>
<p>Range: <code>6.0</code> .. <code>9.9</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.AnalogToDigitTransitionStart</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <input type="checkbox" id="PostProcessing_MaxRateValue_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "MaxRateValue")' unchecked >
                <label for=PostProcessing_MaxRateValue_enabled><class id="PostProcessing_MaxRateValue_text" style="color:black;">Maximum Rate Value</class></label>
            </td>
            <td>
                <input required type="number" id="PostProcessing_MaxRateValue_value1" size="13" min="0" step="any"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>MaxRateValue</code></h3>
<p>Default Value: <code>0,05</code></p>
<p>Maximum allowed change between two readings, if exceeded the last reading will be rejected. Depending on the settings of <code>&lt;NUMBER&gt;.MaxRateType</code> the <code>MaxRateValue</code> is either treated as the difference between the two measurements (<code>AbsoluteChange</code> = difference) not taking the set time interval into account or as the difference normalized to the interval (<code>RateChange</code> = difference per minute).</p>
<p>If negative rate is disallowed and no maximum rate value is set, one false high reading will lead to a period of missing measurements until the measurement reaches the previous false high reading. E.g. if the counter is at <code>600,00</code> and it's read incorrectly as<code>610,00</code>, all measurements will be skipped until the counter reaches <code>610,00</code>. Setting the MaxRateValue to <code>0,05</code> leads to a rejection of all readings with a difference <code>&gt; 0,05</code>, in this case <code>610,00</code>. The rejection also applies to correct readings with a difference <code>&gt; 0,05</code>!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.MaxRateValue</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <input type="checkbox" id="PostProcessing_MaxRateType_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "MaxRateType")' unchecked >
                <label for=PostProcessing_MaxRateType_enabled><class id="PostProcessing_MaxRateType_text" style="color:black;">Maximum Rate Type</class></label>
            </td>
            <td>
                <select id="PostProcessing_MaxRateType_value1">
                    <option value="AbsoluteChange" >AbsoluteChange</option>
                    <option value="RateChange" selected>RateChange</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>MaxRateType</code></h3>
<p>Default Value: <code>AbsoluteChange</code></p>
<p>Defines if the <strong>Change Rate</strong> is calculated as the difference between the last two readings (<code>AbsoluteChange</code> = difference) or
as the difference normalized to the interval (<code>RateChange</code> = difference per minute).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.MaxRateType</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <input type="checkbox" id="PostProcessing_ChangeRateThreshold_enabled" value="1"  onclick = 'InvertEnableItem("PostProcessing", "ChangeRateThreshold")' unchecked >
                <label for=PostProcessing_ChangeRateThreshold_enabled><class id="PostProcessing_ChangeRateThreshold_text" style="color:black;">Change Rate Threshold</class></label>
            </td>
            <td>
                <input required type="number" id="PostProcessing_ChangeRateThreshold_value1" step="1" min="0" max="9" value="2"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=9)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ChangeRateThreshold</code></h3>
<p>Default Value: <code>2</code></p>
<p>Range: <code>0</code> .. <code>9</code>.</p>
<p>Threshold parameter for change rate detection.<br>
This parameter is intended to compensate for small reading fluctuations that occur when the meter does not change its value for a long time (e.g. at night) or slightly turns backwards. This can eg. happen on watermeters.</p>
<p>It is only applied to the last digit of the read value (See example below).
If the read value is within PreValue +/- Threshold, no further calculation is carried out and the Value/Prevalue remains at the old value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.ChangeRateThreshold</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
<h4>Example</h4>
<ul>
<li>Smallest ROI provides value for <code>0.000'x</code> (Eg. a water meter with 4 pointers behind the decimal point)</li>
<li>ChangeRateThreshold = 2</li>
</ul>
<h6>With <code>ExtendedResolution</code> <strong>disabled</strong></h6>
<p>PreValue: <code>123.456'7</code> -&gt; Threshold = <code>+/-0.000'2</code>.<br>
All changes between <code>123.456'5</code> and <code>123.456'9</code> get ignored</p>
<h6>With <code>ExtendedResolution</code> <strong>enabled</strong></h6>
<p>PreValue: <code>123.456'78</code> -&gt; Threshold = <code>+/-0.000'02</code>.<br>
All changes between <code>123.456'76</code> and <code>123.456'80</code> get ignored.</p>
<p><img alt="" src="img/ChangeRateThreshold.png" /></p>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <label><class id="PostProcessing_ExtendedResolution_text" style="color:black;">Extended Resolution</class></label>
            </td>
            <td>
                <select id="PostProcessing_ExtendedResolution_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ExtendedResolution</code></h3>
<p>Default Value: <code>false</code></p>
<p>Use the decimal place of the last analog counter for increased accuracy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This parameter is only supported on the <code>*-class*</code> and <code>*-const</code> models! See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Choosing-the-Model">Choosing-the-Model</a> for details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.ExtendedResolution</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent2">
                <label><class id="PostProcessing_IgnoreLeadingNaN_text" style="color:black;">Ignore Leading NaNs</class></label>
            </td>
            <td>
                <select id="PostProcessing_IgnoreLeadingNaN_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IgnoreLeadingNaN</code></h3>
<p>Default Value: <code>true</code></p>
<p>Leading <code>N</code>'s will be deleted before further processing.
This is only relevant for models which use <code>N</code>!
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Choosing-the-Model">here</a> for details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.IgnoreLeadingNaN</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>	
        <!-------------
        <tr>
            <td class="indent2">
                <label><class id="PostProcessing_IgnoreAllNaN_text" style="color:black;">Ignore All NaNs</class></label>
            </td>
            <td>
                <select id="PostProcessing_IgnoreAllNaN_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>$TOOLTIP_PostProcessing_NUMBER.IgnoreAllNaN</td>
        </tr>		
        ------------------>
        <tr class="expert" unused_id="ex1dddd">
            <td class="indent2">
                <label><class id="PostProcessing_CheckDigitIncreaseConsistency_text" style="color:black;">Check Digit Increase Consistency</class></label>
            </td>
            <td>
                <select id="PostProcessing_CheckDigitIncreaseConsistency_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CheckDigitIncreaseConsistency</code></h3>
<p>Default Value: <code>false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>An additional consistency check.
It especially improves the zero crossing check between digits.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.CheckDigitIncreaseConsistency</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- MQTT ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_MQTT_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_MQTT_enabled>MQTT</label>
                </h4>
            </td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_Uri_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "Uri")' unchecked >
                <label for=MQTT_Uri_enabled><class id="MQTT_Uri_text" style="color:black;">URI</class></label>
            </td>
            <td>
                <input required type="text" id="MQTT_Uri_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Uri</code></h3>
<p>Default Value: <code>mqtt://example.com:1883</code></p>
<p>URI to the MQTT broker including the port. E.g. <code>mqtt://192.168.1.1:1883</code>.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_MainTopic_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "MainTopic")' unchecked >
                <label for=MQTT_MainTopic_enabled><class id="MQTT_MainTopic_text" style="color:black;">Main Topic</class></label>
            </td>
            <td>
                <input required type="text" id="MQTT_MainTopic_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>MainTopic</code></h3>
<p>Default Value: <code>watermeter</code></p>
<p>MQTT main topic, under which the counters are published.</p>
<p>The single value will be published with the following key: <code>MAINTOPIC/NUMBER/RESULT_TOPIC</code></p>
<p>With:</p>
<ul>
<li><code>NUMBER</code>: The name of the value (a meter might have more than one value). 
  The names get defined in the analog and digit ROI configuration (defaults to <code>main</code>).</li>
<li><code>RESULT_TOPIC</code>: Automatically filled with the right name, eg. <code>value</code>, <code>rate</code>, <code>timestamp</code>, <code>error</code>, ....</li>
</ul>
<p>The general connection status can be found in <code>MAINTOPIC/CONNECTION</code>. 
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT-API#result">MQTT Result Topics</a> for a full list of topics.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main topic is allowed to contain <code>/</code> which can be used to split it into multiple levels, eg. <code>/basement/meters/watermeter/1/</code> if you have multiple water meters in your basement.</p>
</div>
<p>The nodeId for the Home Assistant MQTT Service Discovery must follow the schema <code>&lt;discovery_prefix&gt;/&lt;component&gt;/[&lt;node_id&gt;/]&lt;object_id&gt;/config</code>. The node_id is not configurable but derived from the <code>MainTopic</code> by stripping any but the last topic level. A <code>MainTopic</code> with the value <code>home/basement/watermeter</code> is transformed into the node_id <code>watermeter</code>, resulting in the discovery topic <code>homeassistant/sensor/watermeter/value/config</code> for the current value.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_ClientID_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "ClientID")' unchecked >
                <label for=MQTT_ClientID_enabled><class id="MQTT_ClientID_text" style="color:black;">Client ID</class></label>
            </td>
            <td>
                <input required type="text" id="MQTT_ClientID_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ClientID</code></h3>
<p>Default Value: <code>watermeter</code></p>
<p>Client ID used to connect to the MQTT broker.
If disabled, the <code>hostname</code> will be used.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_user_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "user")' unchecked >
                <label for=MQTT_user_enabled><class id="MQTT_user_text" style="color:black;">Username</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_user_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>user</code></h3>
<p>Default Value: <code>USERNAME</code></p>
<p>Username for MQTT authentication.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_password_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "password")' unchecked >
                <label for=MQTT_password_enabled><class id="MQTT_password_text" style="color:black;">Password</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_password_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>password</code></h3>
<p>Default Value: <code>PASSWORD</code></p>
<p>Password for MQTT authentication.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem expert" unused_id="exMqtt">
            <td class="indent1">
                <input type="checkbox" id="MQTT_CACert_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "CACert")' unchecked >
                <label for=MQTT_CACert_enabled><class id="MQTT_CACert_text" style="color:black;">Root CA Certificate file</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_CACert_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CACert</code></h3>
<p>Default Value: <code>""</code></p>
<p>Example: <code>/config/certs/RootCA.crt</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Path to the CA certificate file.</p>
<p>This is part of the configuration to enable TLS 1.2 for MQTT.<br></p>
<p>The CA Certificate is used by the client to validate the broker is who it claims to be.
It allows the client to authenticate the server, which is the first part of the MTLS handshake.</p>
<p>Usually there is a common RootCA certificate for the MQTT broker.
More information is available <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT-API/#mqtt-tls">here</a>.</p>
<p>For more information on how to create your own certificate, see: <a target=_blank href="https://mosquitto.org/man/mosquitto-tls-7.html">mosquitto.org</a> or <a target=_blank href="https://www.emqx.com/en/blog/emqx-server-ssl-tls-secure-connection-configuration-guide">emqx.com</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This also means that you might have to change the protocol and port in <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters/#parameter-uri">uri</a> to <code>mqtts://example.com:8883</code>!</p>
<p>Only Certificates up to 4096 Bit are supported!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem expert" unused_id="exMqtt">
            <td class="indent1">
                <input type="checkbox" id="MQTT_ClientCert_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "ClientCert")' unchecked >
                <label for=MQTT_ClientCert_enabled><class id="MQTT_ClientCert_text" style="color:black;">Client Certificate file</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_ClientCert_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ClientCert</code></h3>
<p>Default Value: <code>""</code></p>
<p>Example: <code>/config/certs/client.crt</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Path to the Client Certificate file.</p>
<p>This is part of the configuration to enable TLS 1.2 for MQTT.<br></p>
<p>The Client Certificate is used by the client to prove its identity to the server, in conjunction with the Client Key. 
It is the second part of the MTLS handshake.</p>
<p>Usually there is a one pair of Client Certificate/Key for each client that connects to the MQTT broker.
More information is available <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT-API/#mqtt-tls">here</a>.</p>
<p>For more information on how to create your own certificate, see: <a target=_blank href="https://mosquitto.org/man/mosquitto-tls-7.html">mosquitto.org</a> or <a target=_blank href="https://www.emqx.com/en/blog/emqx-server-ssl-tls-secure-connection-configuration-guide">emqx.com</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If set, <code>ClientKey</code> must be set too.
This also means that you might have to change the protocol and port in <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters/#parameter-uri">uri</a> to <code>mqtts://example.com:8883</code>!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem expert" unused_id="exMqtt">
            <td class="indent1">
                <input type="checkbox" id="MQTT_ClientKey_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "ClientKey")' unchecked >
                <label for=MQTT_ClientKey_enabled><class id="MQTT_ClientKey_text" style="color:black;">Client Key file</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_ClientKey_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ClientKey</code></h3>
<p>Default Value: <code>""</code></p>
<p>Example: <code>/config/certs/client.key</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Path to the Client Key file.</p>
<p>This is part of the configuration to enable TLS 1.2 for MQTT.<br></p>
<p>The Client Key is used by the client to prove its identity to the server, in conjunction with the Client Certificate.
It is the second part of the MTLS handshake.</p>
<p>Usually there is a one pair of Client Certificate/Key for each client that connects to the MQTT broker</p>
<p>For more information on how to create your own certificate, see: <a target=_blank href="https://mosquitto.org/man/mosquitto-tls-7.html">mosquitto.org</a> or <a target=_blank href="https://www.emqx.com/en/blog/emqx-server-ssl-tls-secure-connection-configuration-guide">emqx.com</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If set, <code>ClientCert</code> must be set too.
This also means that you might have to change the protocol and port in <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters/#parameter-uri">uri</a> to <code>mqtts://example.com:8883</code>!</p>
</div>
    </span></div></div>
</td>
        </tr>
		
        <tr class="MQTTItem expert" unused_id="exMqtt">
            <td class="indent1">
                <input type="checkbox" id="MQTT_ValidateServerCert_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "ValidateServerCert")' unchecked >
                <label for=MQTT_ValidateServerCert_enabled><class id="MQTT_ValidateServerCert_text" style="color:black;">Validate ServerCert</class></label>
            </td>
            <td>
                <select id="MQTT_ValidateServerCert_value1">
                    <option value="true" selected>enabled (true)</option>
                    <option value="false">disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ValidateServerCert</code></h3>
<p>Default Value: <code>true</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Enable or disable the validation of the server certificate CN field.<br></p>
<p>If <code>enabled (true)</code>, the certificate sent by the server is validated using the configured <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters/#parameter-cacert">Root CA Certificate file</a>.<br>
The server name in <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Parameters/#parameter-uri">uri</a> is compared with the CN field of the server certificate.<br>
A connection is only established if they agree. It ensures the origin of the server.</p>
<p>If <code>disabled (false)</code>, the ESP32 skipped any validation of server certificate CN field.<br>
This reduces the security of TLS and makes the <em>MQTT</em> client susceptible to MITM attacks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This also means that you might have to change the protocol and port in  to <code>mqtts://example.com:8883</code>!</p>
<p>If you use public brokers, is recommended to set this parameter to "enabled (true)".</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <label><class id="MQTT_RetainMessages_text" style="color:black;">Retain Messages</class></label>
            </td>
            <td>
                <select id="MQTT_RetainMessages_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>RetainMessages</code></h3>
<p>Default Value: <code>true</code></p>
<p>Enable or disable the <a target=_blank href="https://www.hivemq.com/blog/mqtt-essentials-part-8-retained-messages/">Retain Flag</a> for all MQTT entries.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Disabling (set to <code>false</code>) this does not clear the last retained value on the MQTT broker! This must be done manually, see <a target=_blank href="https://www.hivemq.com/blog/mqtt-essentials-part-8-retained-messages/#heading-how-to-delete-retained-messages-in-mqtt">How to Delete Retained Messages in MQTT?</a> and this <a target=_blank href="https://github.com/jomjol/AI-on-the-edge-device/discussions/3534#discussioncomment-12199543">discussion</a>!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1" style="padding-top:25px" colspan="2">
                <b>Homeassistant Discovery (using MQTT)</b><br>
                If activated, the discovery topics gets automatically scheduled to sent once after device startup during state "Publish to MQTT".
                To schedule a retransmission: Use "Manual Control > Resend HA Discovery" or call REST API: 
                <a href=mqtt_publish_discovery target="_blank">http://&lt;IP&gt;/mqtt_publish_discovery</a>
            </td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent2">
                <label><class id="MQTT_HomeassistantDiscovery_text" style="color:black;">Homeassistant Discovery</class></label>
            </td>
            <td>
                <select id="MQTT_HomeassistantDiscovery_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>HomeassistantDiscovery</code></h3>
<p>Default Value: <code>true</code></p>
<p>Enable or disable the Homeassistant Discovery.
See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/Integration-Home-Assistant">here</a> for details about the discovery.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent2">
                <input type="checkbox" id="MQTT_MeterType_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "MeterType")' unchecked >
                <label for=MQTT_MeterType_enabled><class id="MQTT_MeterType_text" style="color:black;">Meter Type</class></label>
            </td>
            <td>
                <select class="select_large" id="MQTT_MeterType_value1"> <!-- See https://developers.home-assistant.io/docs/core/entity/sensor/#available-device-classes -->
                    <option value="other" selected>Other (no Units)</option>
                    <option value="water_m3">Watermeter (Value: m³, Rate: m³/h)</option>
                    <option value="water_l">Watermeter (Value: l, Rate: l/h)    ⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</option>
                    <option value="water_gal">Watermeter (Value: gal, Rate: gal/h)    ⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</option>
                    <option value="water_gal_min">Watermeter (Value: gal, Rate: gal/min)</option>
                    <option value="water_ft3">Watermeter (Value: ft³, Rate: ft³/min)</option>
                    <option value="gas_m3">Gasmeter (Value: m³, Rate: m³/h)</option>
                    <option value="gas_ft3">Gasmeter (Value: ft³, Rate: ft³/min)</option>
                    <option value="energy_wh">Energymeter (Value: Wh, Rate: W)</option>
                    <option value="energy_kwh">Energymeter (Value: kWh, Rate: kW)</option>
                    <option value="energy_mwh">Energymeter (Value: MWh, Rate: MW)</option>
                    <option value="energy_gj">Energymeter (Value: GJ, Rate: GJ/h)    ⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</option>
                    <option value="temperature_c">Thermometer (Value: °C, Rate: °C/min)</option>
                    <option value="temperature_c">Thermometer (Value: °F, Rate: °F/min)</option>
                    <option value="temperature_c">Thermometer (Value: K, Rate: K/min)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>MeterType</code></h3>
<p>Default Value: <code>other</code></p>
<p>Select the Meter Type so the sensors have the right units in Homeassistant.</p>
<p>Please also make sure that the selected Meter Type matches the dimension of the value provided by the meter!
Eg. if your meter provides <code>m³</code>, you need to also set it to <code>m³</code>.
Alternatively you can set the parameter <code>DecimalShift</code> to <code>3</code> so the value is converted to <code>liters</code>!</p>
<p>List of supported options:</p>
<ul>
<li><code>other</code></li>
<li><code>water_m3</code> (uses <code>m^3/h</code> as rate)</li>
<li><code>water_l</code>  (uses <code>l/h</code> as rate) <strong>⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</strong></li>
<li><code>water_gal</code>  (uses <code>gal/h</code> as rate) <strong>⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</strong></li>
<li><code>water_gal_min</code>  (uses <code>gal/min</code> as rate)</li>
<li><code>water_ft3</code> (uses <code>ft^3/min</code> as rate)</li>
<li><code>gas_m3</code> (uses <code>m^3/h</code> as rate)</li>
<li><code>gas_ft3</code> (uses <code>ft^3/min</code> as rate)</li>
<li><code>energy_wh</code> (uses <code>W</code> as rate)</li>
<li><code>energy_kwh</code> (uses <code>KW</code> as rate)</li>
<li><code>energy_mwh</code> (uses <code>MW</code> as rate)</li>
<li><code>energy_gj</code>  (uses <code>GJ/h</code> as rate) <strong>⚠️ Not supported by Homeassistant 2025.7 and later! ⚠️</strong></li>
<li><code>temperature_c</code> (uses <code>+C/min</code> as rate)</li>
<li><code>temperature_f</code> (uses <code>°F/min</code> as rate)</li>
<li><code>temperature_k</code> (uses <code>K/min</code> as rate)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all options are supported by Homeassistant, see <code>SensorDeviceClass.VOLUME_FLOW_RATE</code> in <a target=_blank href="https://developers.home-assistant.io/docs/core/entity/sensor/#available-device-classes">https://developers.home-assistant.io/docs/core/entity/sensor/#available-device-classes</a>!</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since Homeassistant 2025.7, the unsupported options will no longer work, see change in Homeassistant: <a target=_blank href="https://github.com/home-assistant/core/pull/146722">Ensure MQTT sensor has a valid native unit of measurement</a>.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent1">
                <input type="checkbox" id="MQTT_DomoticzTopicIn_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "DomoticzTopicIn")' unchecked >
                <label for=MQTT_DomoticzTopicIn_enabled><class id="MQTT_DomoticzTopicIn_text" style="color:black;">Domoticz "in" topic</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_DomoticzTopicIn_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>DomoticzTopicIn</code></h3>
<p>Default Value: <code>domoticz/in</code></p>
<p>Domoticz "in" topic as configured on the "MQTT Client Gateway" setup page on the Domoticz system. Used to publish counter/s value/s.</p>
<p>Parameter &lt;NUMBER&gt;.DomoticzIDX is required (see below).</p>
    </span></div></div>
</td>
        </tr>
		
        <tr class="MQTTItem" style="margin-top:12px">
            <td class="indent1" style="padding-top:25px" colspan="3">
                <b>The following parameters are configurable individually for each number sequence:</b>
                <select style="font-weight: bold; margin-left:17px" id="NumbersMQTTIdx_value1" onchange="numberMQTTIdxChanged()"></select>
            </td>
        </tr>

        <tr class="MQTTItem">
            <td class="indent2">
                <input type="checkbox" id="MQTT_DomoticzIDX_enabled" value="1"  onclick = 'InvertEnableItem("MQTT", "DomoticzIDX")' unchecked >
                <label for=MQTT_DomoticzIDX_enabled><class id="MQTT_DomoticzIDX_text" style="color:black;">Domoticz Counter Idx:</class></label>
            </td>
            <td>
                <input type="text" id="MQTT_DomoticzIDX_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>DomoticzIDX</code></h3>
<p>Default Value: <code>0</code></p>
<p>The Idx number for the counter device. Can be obtained from the devices setup page on the Domoticz system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.DomoticzIDX</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- INFLUXDB v1 ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_InfluxDB_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_InfluxDB_enabled>InfluxDB v1.x</label>
                </h4>
            </td>
        </tr>
		
        <tr class="InfluxDBv1Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDB_Uri_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "Uri")' unchecked >
                <label for=InfluxDB_Uri_enabled><class id="InfluxDB_Uri_text" style="color:black;">URI</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDB_Uri_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Uri</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>URI of the HTTP interface to InfluxDB v1, without trailing slash, e.g. <code>http://192.168.1.1:8086</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See section <code>InfluxDBv2</code> for InfluxDB v2 support! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv1Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDB_Database_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "Database")' unchecked >
                <label for=InfluxDB_Database_enabled><class id="InfluxDB_Database_text" style="color:black;">Database</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDB_Database_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Database</code></h3>
<p>Default Value: <code>''</code></p>
<p>Name of the InfluxDB v1 Database into which to publish the values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See section <code>InfluxDBv2</code> for InfluxDB v2 support! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv1Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDB_user_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "user")' unchecked >
                <label for=InfluxDB_user_enabled><class id="InfluxDB_user_text" style="color:black;">Username</class></label>
            </td>
            <td>
                <input type="text" id="InfluxDB_user_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>user</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Username for the InfluxDB v1 authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See section <code>InfluxDBv2</code> for InfluxDB v2 support! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv1Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDB_password_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "password")' unchecked >
                <label for=InfluxDB_password_enabled><class id="InfluxDB_password_text" style="color:black;">Password</class></label>
            </td>
            <td>
                <input type="text" id="InfluxDB_password_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>password</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Password for the InfluxDB v1 authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See section <code>InfluxDBv2</code> for InfluxDB v2 support! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv1Item" style="margin-top:12px">
            <td class="indent1" style="padding-top:25px" colspan="3">
                <b>Parameter per number sequence:</b>
                <select style="font-weight: bold; margin-left:17px" id="NumbersInfluxDB_value1" onchange="numberInfluxDBChanged()"></select>
            </td>
        </tr>
		
        <tr class="InfluxDBv1Item">
            <td class="indent2">
                <input type="checkbox" id="InfluxDB_Measurement_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "Measurement")' unchecked >
                <label for=InfluxDB_Measurement_enabled><class id="InfluxDB_Measurement_text" style="color:black;">Measurement</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDB_Measurement_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Measurement</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Name of the InfluxDB v1 Measurement to use to publish the value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See section <code>InfluxDBv2</code> for InfluxDB v2 support! </p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv1Item">
            <td class="indent2">
                <input type="checkbox" id="InfluxDB_Field_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDB", "Field")' unchecked >
                <label for=InfluxDB_Field_enabled><class id="InfluxDB_Field_text" style="color:black;">Field</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDB_Field_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Field</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Dedicated definition of the field for InfluxDB use for saving in the Influx database (e.g.: "watermeter/value").</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.Field</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- INFLUXDB v2 ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_InfluxDBv2_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_InfluxDBv2_enabled>InfluxDB v2.x</label>
                </h4>		
            </td>
        </tr>

        <tr class="InfluxDBv2Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDBv2_Uri_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Uri")' unchecked >
                <label for=InfluxDBv2_Uri_enabled><class id="InfluxDBv2_Uri_text" style="color:black;">URI</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDBv2_Uri_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Uri</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>URI of the HTTP interface to InfluxDB v2, without trailing slash, e.g. <code>http://192.168.1.1:8086</code>.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv2Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDBv2_Bucket_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Bucket")' unchecked >
                <label for=InfluxDBv2_Bucket_enabled><class id="InfluxDBv2_Bucket_text" style="color:black;">Bucket</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDBv2_Bucket_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Bucket</code></h3>
<p>Default Value: <code>''</code></p>
<p>Name of the InfluxDB v2 Bucket into which to publish the values.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv2Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDBv2_Org_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Org")' unchecked >
                <label for=InfluxDBv2_Org_enabled><class id="InfluxDBv2_Org_text" style="color:black;">Organization (Org)</class></label>
            </td>
            <td>
                <input type="text" id="InfluxDBv2_Org_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Org</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Organisation (Org) for InfluxDB v2 authentication</p>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv2Item">
            <td class="indent1">
                <input type="checkbox" id="InfluxDBv2_Token_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Token")' unchecked >
                <label for=InfluxDBv2_Token_enabled><class id="InfluxDBv2_Token_text" style="color:black;">Token</class></label>
            </td>
            <td>
                <input type="text" id="InfluxDBv2_Token_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Token</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Token for InfluxDB v2 authentication</p>
    </span></div></div>
</td>
        </tr>

        <tr class="InfluxDBv2Item" style="margin-top:12px">
            <td class="indent1" style="padding-top:25px" colspan="3">
                <b>Parameter per number sequence:</b>
                <select style="font-weight: bold; margin-left:17px" id="NumbersInfluxDBv2_value1" onchange="numberInfluxDBv2Changed()"></select>
            </td>
        </tr>

        <tr class="InfluxDBv2Item">
            <td class="indent2">
                <input type="checkbox" id="InfluxDBv2_Measurement_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Measurement")' unchecked >
                <label for=InfluxDBv2_Measurement_enabled><class id="InfluxDBv2_Measurement_text" style="color:black;">Measurement</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDBv2_Measurement_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Measurement</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Name of the InfluxDB v2 Measurement to use to publish the value.</p>
    </span></div></div>
</td>
        </tr>
		
        <tr class="InfluxDBv2Item">
            <td class="indent2">
                <input type="checkbox" id="InfluxDBv2_Field_enabled" value="1"  onclick = 'InvertEnableItem("InfluxDBv2", "Field")' unchecked >
                <label for=InfluxDBv2_Field_enabled><class id="InfluxDBv2_Field_text" style="color:black;">Field</class></label>
            </td>
            <td>
                <input required type="text" id="InfluxDBv2_Field_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Field</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>Field for InfluxDB v2 to use for saving.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you edit the config file manually, you must prefix this parameter with <code>&lt;NUMBER&gt;</code> followed by a dot (eg. <code>main.Field</code>). The reason is that this parameter is specific for each <code>&lt;NUMBER&gt;</code> (<code>&lt;NUMBER&gt;</code> is the name of the number sequence defined in the ROI's).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- Webhook ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_Webhook_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_Webhook_enabled>Webhook</label>
                </h4>		
            </td>
        </tr>

        <tr class="WebhookItem">
            <td class="indent1">
                <input type="checkbox" id="Webhook_Uri_enabled" value="1"  onclick = 'InvertEnableItem("Webhook", "Uri")' unchecked >
                <label for=Webhook_Uri_enabled><class id="Webhook_Uri_text" style="color:black;">URI</class></label>
            </td>
            <td>
                <input required type="text" id="Webhook_Uri_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Uri</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>URI of the HTTP Endpoint receiving requests, e.g. <code>http://192.168.1.1/watermeter/webhook</code>.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="WebhookItem">
            <td class="indent1">
                <input type="checkbox" id="Webhook_ApiKey_enabled" value="1"  onclick = 'InvertEnableItem("Webhook", "ApiKey")' unchecked >
                <label for=Webhook_ApiKey_enabled><class id="Webhook_ApiKey_text" style="color:black;">ApiKey</class></label>
            </td>
            <td>
                <input required type="text" id="Webhook_ApiKey_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>ApiKey</code></h3>
<p>Default Value: <code>undefined</code></p>
<p>ApiKey sent as Header</p>
    </span></div></div>
</td>
        </tr>

        <tr class="WebhookItem">
            <td class="indent1">
                <input type="checkbox" id="Webhook_UploadImg_enabled" value="1"  onclick = 'InvertEnableItem("Webhook", "UploadImg")' unchecked>
                <label for=Webhook_UploadImg_enabled><class id="Webhook_UploadImg_text" style="color:black;">Upload Image</class></label>
            </td>
            <td>
                <select id="Webhook_UploadImg_value1">
                    <option value="0" selected>NEVER</option>
                    <option value="1">ALWAYS</option>
                    <option value="2">ON_ERROR</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>UploadImg</code></h3>
<p>Default Value: <code>0</code> (<code>NEVER</code>)</p>
<p>Available options:</p>
<ul>
<li><code>0</code>: <code>NEVER</code></li>
<li><code>1</code>: <code>ALWAYS</code></li>
<li><code>2</code>: <code>ON_ERROR</code></li>
</ul>
    </span></div></div>
</td>
        </tr>

        <!------------- SHT3x Sensor ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_SHT3x_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_SHT3x_enabled>SHT3x (Temperature & Humidity Sensor)</label>
                </h4>
                <div style="background-color: #e7f3ff; border-left: 4px solid #2196F3; padding: 10px; margin: 5px 0; font-size: 0.9em;">
                    <strong>⚠️ GPIO Configuration Required:</strong> Before enabling this sensor, you must configure GPIO pins for I²C communication.
                    <br><br>
                    <strong>Steps:</strong>
                    <ol style="margin: 5px 0; padding-left: 20px;">
                        <li>Scroll down to the <strong>GPIO</strong> section below</li>
                        <li>Click <strong>"Show Expert Parameters"</strong> checkbox to reveal GPIO settings</li>
                        <li>Set one GPIO pin to <strong>i2c-sda</strong> (e.g., IO12)</li>
                        <li>Set another GPIO pin to <strong>i2c-scl</strong> (e.g., IO13)</li>
                        <li>Save configuration and restart device</li>
                        <li>Then return here to enable and configure the SHT3x sensor</li>
                    </ol>
                    See <a href="https://jomjol.github.io/AI-on-the-edge-device-docs/parameter-pages/Sensors-Overview/" target="_blank">Sensors Overview Documentation</a> for detailed wiring and setup instructions.
                </div>
            </td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">I²C Address</td>
            <td>
                <select id="SHT3x_Address_value1">
                    <option value="0x44">0x44 (default)</option>
                    <option value="0x45">0x45</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x Address</h3>
<p>Set the I²C address for the SHT3x temperature and humidity sensor.</p>
<h4>Value</h4>
<ul>
<li><code>0x44</code> - Default I²C address (most common)</li>
<li><code>0x45</code> - Alternative I²C address</li>
</ul>
<h4>Description</h4>
<p>The SHT3x sensor communicates over the I²C bus and can have one of two addresses, selectable by a hardware pin on the sensor module.</p>
<h5>Address Selection</h5>
<p>Most SHT3x breakout boards use <strong>0x44</strong> as the default address. Some boards allow changing the address to <strong>0x45</strong> by:
- Cutting a trace
- Moving a jumper
- Bridging solder pads</p>
<p>Consult your sensor's documentation for address configuration.</p>
<h5>Why Two Addresses?</h5>
<p>The dual-address capability allows you to connect <strong>two SHT3x sensors</strong> to the same I²C bus:
- One sensor configured at 0x44
- Another sensor configured at 0x45</p>
<p>This is useful for:
- Comparing inside vs. outside enclosure conditions
- Monitoring multiple locations with one device
- Redundant sensing for critical applications</p>
<h4>⚠️ Prerequisites - GPIO Configuration Required!</h4>
<p><strong>Before the SHT3x sensor can be detected at any address, you MUST configure GPIO pins for I²C communication.</strong></p>
<h5>Quick GPIO Setup</h5>
<ol>
<li>Navigate to the <strong>Configuration</strong> page</li>
<li>Scroll to the <strong>GPIO</strong> section</li>
<li>Click <strong>"Show Expert Options"</strong> or <strong>"Advanced Settings"</strong> to reveal GPIO configuration</li>
<li>Configure two pins:</li>
<li>One pin set to <strong><code>i2c-sda</code></strong> (e.g., IO12)</li>
<li>One pin set to <strong><code>i2c-scl</code></strong> (e.g., IO13)</li>
<li>Save configuration and restart</li>
</ol>
<p>See detailed guides:
- <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SDA.md">GPIO I²C SDA Configuration</a>
- <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SCL.md">GPIO I²C SCL Configuration</a>
- <a target=_blank href="Enable.md">SHT3x Enable</a> - Complete setup walkthrough</p>
<h5>Physical Wiring</h5>
<p>After GPIO configuration, wire the sensor:
- VDD → 3.3V (<strong>NOT 5V!</strong>)
- GND → GND
- SDA → Configured SDA GPIO (e.g., IO12)
- SCL → Configured SCL GPIO (e.g., IO13)
- Add 4.7kΩ pull-up resistors on both SDA and SCL lines</p>
<h4>Configuration Example</h4>
<p>```ini
[GPIO]
IO3 = i2c-sda                ; * Requires disabling USB logging
IO1 = i2c-scl                ; * Requires disabling USB logging</p>
<p>[SHT3x]
Enable = true
Address = 0x44           ; Default address
Interval = -1
I2C_Frequency = 100000
```</p>
<h4>Troubleshooting</h4>
<p><strong>Sensor not detected:</strong>
1. Verify GPIO pins are configured as <code>i2c-sda</code> and <code>i2c-scl</code>
2. Check physical wiring (SDA, SCL, VDD, GND)
3. Confirm pull-up resistors (4.7kΩ) are installed
4. Try the alternative address (0x45 if using 0x44, or vice versa)
5. Use an I²C scanner tool to verify the sensor is responding
6. Check device logs for I²C initialization errors</p>
<p><strong>Wrong readings or erratic behavior:</strong>
- EMI interference: Add shorter wires, better shielding
- Loose connections: Secure all pins
- Incorrect address: Verify hardware address matches config</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="I2C_Frequency.md">SHT3x I2C_Frequency</a> - I²C bus speed</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SDA.md">GPIO I²C SDA</a> - Data line configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SCL.md">GPIO I²C SCL</a> - Clock line configuration</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">Read Interval (seconds)</td>
            <td>
                <input type="number" id="SHT3x_Interval_value1" min="-1" step="1" value="-1">
                <span style="font-size: 0.9em; color: #666;">(-1 = follow flow cycle)</span>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x Interval</h3>
<p>Set the reading interval for the SHT3x temperature and humidity sensor.</p>
<h4>Value</h4>
<ul>
<li><code>-1</code> - Follow flow cycle (default) - Read on every main flow execution</li>
<li><code>0</code> or positive integer - Custom interval in seconds</li>
</ul>
<h4>Description</h4>
<p>Controls how often the sensor is read and data is published.</p>
<h5>Follow Flow Mode (Interval = -1)</h5>
<p><strong>Recommended for most users</strong></p>
<p>When set to <code>-1</code>, the sensor is read every time the main flow executes. This synchronizes sensor readings with meter readings.</p>
<p><strong>Benefits:</strong>
- Sensor data timestamped with meter data
- Correlate environmental conditions with meter readings
- No additional timer overhead
- Simple configuration</p>
<p><strong>Example:</strong>
```ini
[AutoTimer]
Interval = 10        ; Main flow every 10 minutes</p>
<p>[SHT3x]
Interval = -1        ; Read sensor every 10 minutes (follows flow)
```</p>
<p>Result: Sensor read every 10 minutes, aligned with meter readings.</p>
<h5>Custom Interval Mode (Interval &gt; 0)</h5>
<p><strong>For advanced monitoring scenarios</strong></p>
<p>Set a specific interval in seconds, independent of the main flow cycle.</p>
<p><strong>Use Cases:</strong>
- <strong>High-frequency monitoring</strong>: Interval = 60 (every minute) for rapid temperature changes
- <strong>Low-frequency logging</strong>: Interval = 3600 (every hour) to reduce data volume
- <strong>Different cadence</strong>: Flow every 5 min, sensors every 15 min</p>
<p><strong>Example 1: Rapid Environmental Monitoring</strong>
```ini
[AutoTimer]
Interval = 10        ; Flow every 10 minutes</p>
<p>[SHT3x]
Interval = 60        ; Read sensor every 1 minute
```</p>
<p>Use when: Monitoring rapidly changing conditions (e.g., heater cycling, direct sun exposure)</p>
<p><strong>Example 2: Low-Frequency Trending</strong>
```ini
[AutoTimer]
Interval = 2         ; Flow every 2 minutes</p>
<p>[SHT3x]
Interval = 900       ; Read sensor every 15 minutes
```</p>
<p>Use when: Long-term trending, reduce InfluxDB storage</p>
<h4>Choosing the Right Interval</h4>
<h5>For Device Health Monitoring</h5>
<p><strong>General Purpose (Recommended):</strong>
<code>ini
Interval = -1        ; Follow flow cycle</code>
Good for: Most installations, balanced data collection</p>
<p><strong>Outdoor Extreme Weather:</strong>
<code>ini
Interval = 300       ; Every 5 minutes</code>
Good for: Detecting rapid temperature/humidity changes, weather events</p>
<p><strong>Indoor Stable Environment:</strong>
<code>ini
Interval = 1800      ; Every 30 minutes</code>
Good for: Basement, garage, minimal variation</p>
<p><strong>Failure Detection:</strong>
<code>ini
Interval = 60        ; Every 1 minute</code>
Good for: Debugging overheating, tracking cooling system performance</p>
<h5>Performance Considerations</h5>
<p><strong>SHT3x Measurement Time:</strong>
- High repeatability: ~15ms
- Medium repeatability: ~6ms
- Low repeatability: ~4ms</p>
<p>The sensor is fast, so reading every minute is not a problem.</p>
<p><strong>Data Volume:</strong>
- Every minute: 1440 readings/day, 43,200/month
- Every 5 minutes: 288 readings/day, 8,640/month
- Every hour: 24 readings/day, 720/month</p>
<p>Consider InfluxDB storage and retention policies.</p>
<h4>Example Scenarios</h4>
<h5>Scenario 1: Correlation Analysis</h5>
<p><strong>Goal</strong>: Understand if temperature affects meter accuracy</p>
<p>```ini
[AutoTimer]
Interval = 5         ; Read meter every 5 minutes</p>
<p>[SHT3x]
Interval = -1        ; Read environment every 5 minutes (synced)
```</p>
<p>Now you can correlate temperature with meter readings in Grafana:
- Does meter read high when temp &gt; 30°C?
- Does humidity affect OCR accuracy?</p>
<h5>Scenario 2: Thermal Event Detection</h5>
<p><strong>Goal</strong>: Get alert when enclosure overheats</p>
<p><code>ini
[SHT3x]
Interval = 120       ; Check every 2 minutes
MQTT_Enable = true</code></p>
<p>In Home Assistant:
<code>yaml
automation:
  - alias: "Enclosure Overheat Alert"
    trigger:
      platform: numeric_state
      entity_id: sensor.enclosure_temperature
      above: 65
      for: "00:04:00"  ### 2 consecutive readings
    action:
      - service: notify.mobile_app
        data:
          message: "Watermeter enclosure temperature critical: {{ states('sensor.enclosure_temperature') }}°C"</code></p>
<h5>Scenario 3: Diurnal Trending</h5>
<p><strong>Goal</strong>: Understand daily temperature cycle</p>
<p><code>ini
[SHT3x]
Interval = 600       ; Every 10 minutes
InfluxDB_Enable = true</code></p>
<p>Grafana query:
<code>SELECT mean("temperature") 
FROM "environment" 
WHERE time &gt; now() - 7d 
GROUP BY time(1h)</code></p>
<p>Reveals: Peak temperature at 3 PM, lowest at 5 AM, helps plan heater activation</p>
<h4>Minimum Interval</h4>
<p>While technically you could set <code>Interval = 1</code> (every second), this is <strong>not recommended</strong>:
- Unnecessary wear on sensor
- Floods MQTT broker
- Fills InfluxDB quickly
- No benefit (environment doesn't change that fast)</p>
<p><strong>Minimum recommended</strong>: 30 seconds for debugging, 60 seconds for monitoring</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="MQTT_Enable.md">SHT3x MQTT Enable</a> - Publish to MQTT</li>
<li><a target=_blank href="InfluxDB_Enable.md">SHT3x InfluxDB Enable</a> - Log to InfluxDB</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/AutoTimer/Interval.md">AutoTimer Interval</a> - Main flow cycle</li>
</ul>
<h4>Troubleshooting</h4>
<p><strong>Readings not updating:</strong>
1. Check sensor is enabled
2. Verify interval is not too long (e.g., 86400 = once per day)
3. Look in device logs for read errors
4. Confirm MQTT/InfluxDB is configured if expecting data</p>
<p><strong>Too much data:</strong>
- Increase interval to reduce volume
- Adjust InfluxDB retention policy
- Use downsampling in Grafana</p>
<p><strong>Missed critical events:</strong>
- Decrease interval for faster response
- Use Home Assistant automation with state change triggers
- Consider multiple intervals (frequent for alerts, slow for trending)</p>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">I²C Frequency (Hz)</td>
            <td>
                <select id="SHT3x_I2C_Frequency_value1">
                    <option value="100000">100000 (Standard - 100 kHz, recommended)</option>
                    <option value="400000">400000 (Fast - 400 kHz, advanced)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x I2C_Frequency</h3>
<p>Set the I²C bus frequency (clock speed) for communication with the SHT3x sensor.</p>
<h4>Value</h4>
<ul>
<li><code>100000</code> - 100 kHz (default, most reliable)</li>
<li><code>400000</code> - 400 kHz (fast mode, for short wires)</li>
</ul>
<h4>Description</h4>
<p>The I²C bus frequency determines how fast data is transferred between the ESP32 and the SHT3x sensor.</p>
<h5>Standard Mode - 100 kHz (Recommended)</h5>
<p><strong>Default: 100000 Hz (100 kHz)</strong></p>
<p>Use this setting for:
- <strong>Maximum reliability</strong> - Works in most conditions
- <strong>Longer wire runs</strong> - Up to 1 meter without issues
- <strong>Noisy environments</strong> - Better noise immunity
- <strong>Multiple sensors</strong> - When sharing the I²C bus</p>
<p><strong>Advantages:</strong>
- More robust communication
- Less sensitive to capacitance on the bus
- Lower EMI (electromagnetic interference)
- Works with longer wires and more devices</p>
<h5>Fast Mode - 400 kHz</h5>
<p><strong>Advanced: 400000 Hz (400 kHz)</strong></p>
<p>Use this setting only if:
- Wire length is <strong>very short</strong> (&lt; 10 cm)
- You need <strong>faster read times</strong> (rare requirement)
- Bus capacitance is low (few devices, short traces)</p>
<p><strong>Considerations:</strong>
- More susceptible to noise and interference
- Requires shorter wires
- May fail with poor connections or long cable runs
- Not recommended for outdoor or industrial installations</p>
<h4>⚠️ Prerequisites - GPIO Configuration Required!</h4>
<p><strong>Before configuring I²C frequency, you MUST set up GPIO pins for I²C communication.</strong></p>
<h5>Quick GPIO Setup</h5>
<ol>
<li>Navigate to the <strong>Configuration</strong> page</li>
<li>Scroll to the <strong>GPIO</strong> section</li>
<li>Click <strong>"Show Expert Options"</strong> or <strong>"Advanced Settings"</strong> to reveal GPIO configuration</li>
<li>Configure two pins:</li>
<li>One pin set to <strong><code>i2c-sda</code></strong> (e.g., IO12)</li>
<li>One pin set to <strong><code>i2c-scl</code></strong> (e.g., IO13)</li>
<li>Save configuration and restart</li>
</ol>
<p>See detailed guides:
- <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SDA.md">GPIO I²C SDA Configuration</a>
- <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SCL.md">GPIO I²C SCL Configuration</a>
- <a target=_blank href="Enable.md">SHT3x Enable</a> - Complete setup walkthrough</p>
<h4>When to Change from Default</h4>
<h5>Keep at 100 kHz if:</h5>
<ul>
<li>✅ Sensor works reliably (default setting)</li>
<li>✅ Using standard wiring (jumper wires, breadboard)</li>
<li>✅ Wire length &gt; 10 cm</li>
<li>✅ Outdoor or harsh environment</li>
<li>✅ Multiple I²C devices on the bus</li>
</ul>
<h5>Consider 400 kHz only if:</h5>
<ul>
<li>⚠️ Very short, direct PCB traces or custom board</li>
<li>⚠️ Need faster update rates (usually not needed)</li>
<li>⚠️ Confirmed stable communication at higher speed</li>
<li>⚠️ Indoor, controlled environment</li>
</ul>
<p><strong>Default is best for 99% of users.</strong></p>
<h4>Configuration Example</h4>
<p>```ini
[GPIO]
IO3 = i2c-sda                ; * Requires disabling USB logging
IO1 = i2c-scl                ; * Requires disabling USB logging</p>
<p>[SHT3x]
Enable = true
Address = 0x44
Interval = -1
I2C_Frequency = 100000   ; Standard mode (recommended)
```</p>
<h4>Troubleshooting</h4>
<p><strong>Sensor not detected or intermittent readings:</strong>
1. <strong>First, try lowering frequency</strong> to 100000 Hz
2. Check wire length - should be &lt; 50 cm for 100 kHz
3. Verify 4.7kΩ pull-up resistors are installed on SDA and SCL
4. Inspect for loose connections or poor solder joints
5. Check for electrical noise sources near I²C wires
6. Ensure GPIO pins are properly configured</p>
<p><strong>Changing from 400 kHz to 100 kHz:</strong>
If experiencing issues at 400 kHz:
1. Set <code>I2C_Frequency = 100000</code>
2. Save and restart device
3. Issues should resolve if related to bus speed</p>
<p><strong>Fast mode (400 kHz) not working:</strong>
- Reduce wire length to &lt; 10 cm
- Use twisted pair wiring (twist SDA and GND together, SCL and VDD together)
- Add/reduce pull-up resistor values (try 2.2kΩ for very short wires)
- Verify no other I²C devices conflict
- Fall back to 100 kHz (recommended)</p>
<h4>Technical Background</h4>
<h5>I²C Bus Capacitance</h5>
<p>The maximum speed is limited by <strong>total bus capacitance</strong> from:
- Wire length (longer = more capacitance)
- Number of devices connected
- PCB trace capacitance
- Connector capacitance</p>
<p><strong>Standard Mode (100 kHz):</strong> Works up to 400 pF bus capacitance<br />
<strong>Fast Mode (400 kHz):</strong> Requires &lt; 200 pF bus capacitance</p>
<p>Typical wire: ~50-100 pF per meter → stick to 100 kHz for reliability.</p>
<h5>Performance Impact</h5>
<p>A single SHT3x read takes ~15-20 ms regardless of I²C speed because:
- Sensor measurement time is 12.5 ms (fixed by sensor)
- Data transfer is &lt; 1 ms even at 100 kHz</p>
<p><strong>Conclusion:</strong> Using 400 kHz provides negligible benefit for typical sensor applications.</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Address.md">SHT3x Address</a> - I²C address selection</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SDA.md">GPIO I²C SDA</a> - Data line configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/I2C-SCL.md">GPIO I²C SCL</a> - Clock line configuration</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">Enable MQTT</td>
            <td>
                <input type="checkbox" id="SHT3x_MQTT_Enable_value1" checked>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x MQTT Enable</h3>
<p>Enable or disable MQTT publishing for SHT3x temperature and humidity sensor readings.</p>
<h4>Value</h4>
<ul>
<li><code>true</code> - Enable MQTT publishing (default)</li>
<li><code>false</code> - Disable MQTT publishing</li>
</ul>
<h4>Description</h4>
<p>When enabled, temperature and humidity readings from the SHT3x sensor are published to MQTT broker. Both measurements are published to the same base topic with separate <code>/temperature</code> and <code>/humidity</code> subtopics.</p>
<h4>MQTT Topics</h4>
<h5>Topic Structure</h5>
<p><code>{MQTT_Topic}/temperature → temperature_value
{MQTT_Topic}/humidity → humidity_value</code></p>
<p>Example with default topic <code>enclosure/climate</code>:
<code>enclosure/climate/temperature → 24.5
enclosure/climate/humidity → 45.2</code></p>
<h4>Message Format</h4>
<p><strong>Temperature Topic</strong>: <code>{base_topic}/temperature</code><br />
<strong>Humidity Topic</strong>: <code>{base_topic}/humidity</code><br />
<strong>Payload</strong>: Numeric value as string (e.g., "24.5" or "45.2")<br />
<strong>Retained</strong>: Yes (last value persists)<br />
<strong>QoS</strong>: 1 (at least once delivery)</p>
<h4>Home Assistant Integration</h4>
<h5>Auto-Discovery (Manual Setup Required)</h5>
<p>Configure SHT3x sensors in Home Assistant:</p>
<p>```yaml</p>
<h3 style="margin: 0">configuration.yaml</h3>
<p>mqtt:
  sensor:
    - name: "Enclosure Temperature"
      state_topic: "enclosure/climate/temperature"
      unit_of_measurement: "°C"
      device_class: temperature
      state_class: measurement</p>
<pre><code>- name: "Enclosure Humidity"
  state_topic: "enclosure/climate/humidity"
  unit_of_measurement: "%"
  device_class: humidity
  state_class: measurement
</code></pre>
<p>```</p>
<h5>Complete Configuration Example</h5>
<p>```ini
[MQTT]
Enable = true
Uri = mqtt://192.168.1.100:1883
MainTopic = watermeter</p>
<p>[SHT3x]
Enable = true
Address = 0x44
Interval = -1
MQTT_Enable = true
MQTT_Topic = enclosure/climate
```</p>
<p>Publishes to:
<code>watermeter/enclosure/climate/temperature → 24.5
watermeter/enclosure/climate/humidity → 45.2</code></p>
<h4>Use Cases</h4>
<h5>Enclosure Health Monitoring</h5>
<p><strong>Problem</strong>: Device in outdoor enclosure exposed to condensation risk<br />
<strong>Solution</strong>: Monitor humidity to detect water ingress</p>
<p>Home Assistant automation:
<code>yaml
automation:
  - alias: "Alert: High Enclosure Humidity"
    trigger:
      - platform: numeric_state
        entity_id: sensor.enclosure_humidity
        above: 80
        for:
          minutes: 10
    action:
      - service: notify.mobile_app
        data:
          message: "Enclosure humidity is {{ states('sensor.enclosure_humidity') }}% - check for water ingress!"</code></p>
<h5>Temperature-Controlled Cooling</h5>
<p><strong>Problem</strong>: Overheating in direct sunlight<br />
<strong>Solution</strong>: Monitor temperature to trigger ventilation fan</p>
<p>```yaml
automation:
  - alias: "Enclosure Cooling Fan"
    trigger:
      - platform: numeric_state
        entity_id: sensor.enclosure_temperature
        above: 50
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.enclosure_fan</p>
<ul>
<li>alias: "Stop Cooling Fan"
    trigger:<ul>
<li>platform: numeric_state
    entity_id: sensor.enclosure_temperature
    below: 40
action:</li>
<li>service: switch.turn_off
    target:
      entity_id: switch.enclosure_fan
```</li>
</ul>
</li>
</ul>
<h5>Combined Climate Alerts</h5>
<p>Monitor both temperature and humidity:</p>
<p><code>yaml
automation:
  - alias: "Alert: Extreme Conditions"
    trigger:
      - platform: template
        value_template: &gt;
          {{ 
            states('sensor.enclosure_temperature')|float &gt; 60 or
            states('sensor.enclosure_humidity')|float &gt; 85
          }}
    action:
      - service: notify.mobile_app
        data:
          title: "⚠️ Enclosure Climate Warning"
          message: &gt;
            Temperature: {{ states('sensor.enclosure_temperature') }}°C
            Humidity: {{ states('sensor.enclosure_humidity') }}%</code></p>
<h4>Node-RED Integration</h4>
<p>Example flow to log extreme conditions:</p>
<p><code>json
[
  {
    "type": "mqtt in",
    "topic": "watermeter/enclosure/climate/temperature",
    "name": "Temperature"
  },
  {
    "type": "mqtt in",
    "topic": "watermeter/enclosure/climate/humidity",
    "name": "Humidity"
  },
  {
    "type": "function",
    "func": "if (msg.payload &gt; 60) { return msg; }"
  }
]</code></p>
<h4>Troubleshooting</h4>
<p><strong>No MQTT messages:</strong>
1. Verify global MQTT is enabled: <code>[MQTT] Enable = true</code>
2. Check MQTT broker connection in device logs
3. Confirm SHT3x sensor is reading (check Info page)
4. Verify MQTT_Enable = true for SHT3x specifically</p>
<p><strong>Messages not retained:</strong>
- Check MQTT broker configuration
- Ensure broker supports retained messages
- Some brokers require explicit permission for retained messages</p>
<p><strong>Home Assistant not showing sensor:</strong>
1. Check MQTT integration is configured
2. Verify topic matches configuration
3. Listen to MQTT topic with MQTT Explorer to confirm publishing
4. Check Home Assistant logs for MQTT errors</p>
<h4>Performance Considerations</h4>
<h5>Publishing Frequency</h5>
<p><strong>High-frequency publishing</strong> (Interval = 30 seconds):
- Pros: Rapid response to changes
- Cons: Higher network traffic, more broker load</p>
<p><strong>Follow-flow publishing</strong> (Interval = -1, typical 5-10 minutes):
- Pros: Minimal overhead, data aligned with meter readings
- Cons: Slower response to rapid changes</p>
<p><strong>Recommended</strong>: Use Interval = -1 unless rapid climate response is needed</p>
<h5>Network Usage</h5>
<p>Typical message sizes:
- Temperature: ~30 bytes
- Humidity: ~30 bytes
- Total per reading: ~60 bytes</p>
<p>At 5-minute intervals: ~17 KB/day<br />
At 1-minute intervals: ~86 KB/day</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="MQTT_Topic.md">SHT3x MQTT_Topic</a> - Configure base topic</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Set reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/Enable.md">MQTT Enable</a> - Global MQTT configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/Uri.md">MQTT Uri</a> - MQTT broker connection</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">MQTT Topic</td>
            <td>
                <input type="text" id="SHT3x_MQTT_Topic_value1" value="sensors/climate">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x MQTT Topic</h3>
<p>Set the base MQTT topic for publishing SHT3x temperature and humidity readings.</p>
<h4>Value</h4>
<p>Default: <code>enclosure/climate</code></p>
<p>String value representing the base topic path. Temperature and humidity are published to subtopics.</p>
<h4>Description</h4>
<p>The MQTT topic defines where temperature and humidity readings are published. The SHT3x publishes two separate values to subtopics under this base topic.</p>
<h4>Topic Structure</h4>
<h5>Format</h5>
<p><code>{MainTopic}/{MQTT_Topic}/temperature → temperature_value
{MainTopic}/{MQTT_Topic}/humidity → humidity_value</code></p>
<p>Where:
- <code>MainTopic</code>: Global MQTT topic prefix (from MQTT settings)
- <code>MQTT_Topic</code>: This parameter (SHT3x base topic)
- <code>/temperature</code>: Subtopic for temperature readings
- <code>/humidity</code>: Subtopic for humidity readings</p>
<h5>Examples</h5>
<p><strong>Basic Configuration:</strong>
```ini
[MQTT]
MainTopic = watermeter</p>
<p>[SHT3x]
MQTT_Topic = enclosure/climate
```</p>
<p>Publishes to:
<code>watermeter/enclosure/climate/temperature → 24.5
watermeter/enclosure/climate/humidity → 45.2</code></p>
<p><strong>Nested Topic Hierarchy:</strong>
```ini
[MQTT]
MainTopic = home/devices</p>
<p>[SHT3x]
MQTT_Topic = watermeter/enclosure/environment
```</p>
<p>Publishes to:
<code>home/devices/watermeter/enclosure/environment/temperature → 24.5
home/devices/watermeter/enclosure/environment/humidity → 45.2</code></p>
<h4>Topic Naming Conventions</h4>
<h5>Recommended Patterns</h5>
<p><strong>By Location:</strong>
<code>enclosure/climate           - Enclosure environmental conditions
outdoor/weather             - Outdoor weather station
basement/environment        - Basement conditions
garage/climate              - Garage climate
attic/environment           - Attic monitoring</code></p>
<p><strong>By Purpose:</strong>
<code>sensors/climate             - Generic climate monitoring
environment/indoor          - Indoor environmental data
monitoring/climate          - Climate monitoring system
device/health               - Device health monitoring</code></p>
<p><strong>By Device Type:</strong>
<code>watermeter/environment      - Watermeter enclosure
gasmeter/climate            - Gas meter enclosure
powermeter/environment      - Power meter enclosure</code></p>
<h5>Hierarchical Organization</h5>
<p><strong>Option 1: By Location Hierarchy</strong>
<code>building/floor/room/climate
home/basement/watermeter/climate
facility/outdoor/meter/environment</code></p>
<p><strong>Option 2: By System Hierarchy</strong>
<code>meters/water/enclosure/climate
meters/gas/enclosure/climate
monitors/environment/indoor/climate</code></p>
<p><strong>Option 3: By Function Hierarchy</strong>
<code>monitoring/environmental/enclosure
monitoring/health/device/climate
systems/metering/environment</code></p>
<h4>Home Assistant Best Practices</h4>
<h5>Descriptive Topics</h5>
<p>Use topics that clearly indicate what's being measured:</p>
<p><strong>Good:</strong>
<code>enclosure/climate          → Clear: enclosure environmental conditions
watermeter/environment     → Clear: watermeter-related environment
device/health/climate      → Clear: device health climate data</code></p>
<p><strong>Avoid:</strong>
<code>sensor1                    → Unclear: what sensor? where?
data                       → Unclear: what data?
temp                       → Unclear: temperature where?</code></p>
<h5>Topic Length Considerations</h5>
<p><strong>Optimal</strong>: 2-4 levels deep
<code>enclosure/climate          ✅ Good balance
device/enclosure/climate   ✅ Good balance</code></p>
<p><strong>Too shallow</strong>:
<code>climate                    ❌ Not specific enough
data                       ❌ Too generic</code></p>
<p><strong>Too deep</strong>:
<code>home/floor1/room3/device2/sensor1/climate/environmental/data  ❌ Excessive</code></p>
<h4>Advanced Configurations</h4>
<h5>Multiple SHT3x Sensors (Future)</h5>
<p>If multiple SHT3x sensors are supported in the future, use descriptive topics:</p>
<p>```ini</p>
<h3 style="margin: 0">Inside enclosure</h3>
<p>[SHT3x_Inside]
MQTT_Topic = enclosure/inside/climate</p>
<h3 style="margin: 0">Outside enclosure</h3>
<p>[SHT3x_Outside]
MQTT_Topic = enclosure/outside/climate
```</p>
<h5>Integration with Other Sensors</h5>
<p>Coordinate topics across sensor types:</p>
<p>```ini
[SHT3x]
MQTT_Topic = enclosure/climate</p>
<p>[DS18B20]
MQTT_Topic = enclosure/temperature
```</p>
<p>Results in:
<code>enclosure/climate/temperature     (SHT3x temperature)
enclosure/climate/humidity        (SHT3x humidity)
enclosure/temperature/28-XXX      (DS18B20 sensor)</code></p>
<h4>MQTT Explorer Organization</h4>
<p>Good topic structure makes MQTT Explorer visualization clean:</p>
<p><code>watermeter/
├── enclosure/
│   ├── climate/
│   │   ├── temperature → 24.5
│   │   └── humidity → 45.2
│   └── temperature/
│       └── 28-0123456789AB → 22.3
└── meter/
    └── value → 123.456</code></p>
<h4>Home Assistant Device Grouping</h4>
<p>Use consistent topic prefixes to group related sensors:</p>
<p>```yaml</p>
<h3 style="margin: 0">All enclosure sensors appear together</h3>
<p>sensor.enclosure_climate_temperature
sensor.enclosure_climate_humidity
sensor.enclosure_temperature_inside
sensor.enclosure_temperature_outside
```</p>
<h4>Troubleshooting</h4>
<p><strong>Topics not appearing in MQTT broker:</strong>
1. Check global MQTT settings are correct
2. Verify SHT3x Enable = true
3. Confirm MQTT_Enable = true for SHT3x
4. Check device logs for publish errors
5. Verify MQTT broker allows topic creation</p>
<p><strong>Topics malformed:</strong>
- Don't include leading <code>/</code> in topic (e.g., <code>/enclosure/climate</code> is wrong)
- Don't include trailing <code>/</code> in topic
- Use only alphanumeric, dash, underscore, and forward slash
- Avoid spaces (use underscore or dash instead)</p>
<p><strong>Home Assistant can't find sensors:</strong>
1. Verify exact topic matches (case-sensitive)
2. Check for typos in configuration.yaml
3. Use MQTT Explorer to see actual published topics
4. Confirm MainTopic is correctly applied</p>
<h4>Migration Guide</h4>
<h5>Changing Topic Structure</h5>
<p>When changing topics, old data remains under old topics. To migrate:</p>
<p><strong>Step 1: Update configuration</strong>
<code>ini
[SHT3x]
MQTT_Topic = new/topic/structure  ### Changed from old/topic</code></p>
<p><strong>Step 2: Update Home Assistant</strong>
<code>yaml
mqtt:
  sensor:
    - name: "Enclosure Temperature"
      state_topic: "watermeter/new/topic/structure/temperature"  ### Updated</code></p>
<p><strong>Step 3: Clean up old topics</strong> (optional)
- Old topics will naturally expire if retained messages have TTL
- Manually clear old topics via MQTT broker admin
- Or ignore - they don't cause issues unless broker has storage limits</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="MQTT_Enable.md">SHT3x MQTT_Enable</a> - Enable MQTT publishing</li>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Set reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/Enable.md">MQTT Enable</a> - Global MQTT configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/MainTopic.md">MQTT MainTopic</a> - MQTT topic prefix</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">Enable InfluxDB</td>
            <td>
                <input type="checkbox" id="SHT3x_InfluxDB_Enable_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x InfluxDB Enable</h3>
<p>Enable or disable InfluxDB logging for SHT3x temperature and humidity sensor readings.</p>
<h4>Value</h4>
<ul>
<li><code>true</code> - Enable InfluxDB logging</li>
<li><code>false</code> - Disable InfluxDB logging (default)</li>
</ul>
<h4>Description</h4>
<p>When enabled, temperature and humidity readings from the SHT3x sensor are written to InfluxDB for historical tracking and analysis. Both measurements are stored as separate fields in the same measurement.</p>
<h4>InfluxDB Field Structure</h4>
<h5>Measurement</h5>
<p>Configured via <a target=_blank href="InfluxDB_Measurement.md">InfluxDB_Measurement</a> parameter (default: <code>environment</code>)</p>
<h5>Fields</h5>
<p>The SHT3x creates two fields:
- <code>sht3x_temperature</code>: Temperature value (°C)
- <code>sht3x_humidity</code>: Humidity value (%)</p>
<p><strong>Example Data Point:</strong>
<code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  sht3x_temperature: 24.5
  sht3x_humidity: 45.2</code></p>
<p><strong>With Multiple Sensor Types:</strong>
<code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  sht3x_temperature: 24.5        (SHT3x inside enclosure)
  sht3x_humidity: 45.2           (SHT3x inside enclosure)
  temperature_28-0123456789AB: 15.2  (DS18B20 outside)
  temperature_28-FEDCBA987654: 22.3  (DS18B20 inside)</code></p>
<h4>Use Cases</h4>
<h5>Long-Term Climate Trending</h5>
<p>Track temperature and humidity patterns over time:</p>
<p><code>ini
[SHT3x]
Enable = true
Interval = 600        ; Every 10 minutes
InfluxDB_Enable = true
InfluxDB_Measurement = environment</code></p>
<p>Grafana query - Daily climate overview:
<code>sql
SELECT 
  mean("sht3x_temperature") as "Avg Temperature",
  mean("sht3x_humidity") as "Avg Humidity",
  max("sht3x_temperature") as "Peak Temp",
  max("sht3x_humidity") as "Peak Humidity"
FROM "environment" 
WHERE time &gt; now() - 30d 
GROUP BY time(1d)</code></p>
<p>Reveals: Daily cycles, seasonal trends, condensation risk periods</p>
<h5>Condensation Risk Analysis</h5>
<p>Identify when humidity is dangerously high:</p>
<p><code>sql
SELECT 
  "sht3x_temperature",
  "sht3x_humidity"
FROM "environment" 
WHERE 
  "sht3x_humidity" &gt; 80 AND
  time &gt; now() - 7d</code></p>
<p>Calculate dew point to predict condensation:
<code>sql
SELECT 
  "sht3x_temperature" as "temp",
  "sht3x_humidity" as "humidity",
  "sht3x_temperature" - ((100 - "sht3x_humidity") / 5) as "dew_point_approx"
FROM "environment" 
WHERE time &gt; now() - 24h</code></p>
<h5>Enclosure Health Monitoring</h5>
<p>Correlate climate with device performance:</p>
<p><code>sql
SELECT 
  mean("sht3x_temperature") as "temperature",
  count("error") as "error_count"
FROM "environment", "device_logs"
WHERE time &gt; now() - 30d 
GROUP BY time(1d)</code></p>
<p>Identify: Does device fail more often in extreme temperatures?</p>
<h5>Seasonal Analysis</h5>
<p>Compare conditions across seasons:</p>
<p>```sql
-- Summer vs Winter
SELECT 
  mean("sht3x_temperature") as "avg_temp",
  mean("sht3x_humidity") as "avg_humidity"
FROM "environment" 
WHERE time &gt; '2024-06-01' AND time &lt; '2024-09-01'  -- Summer
GROUP BY time(1w)</p>
<p>-- Compare to winter
WHERE time &gt; '2024-12-01' AND time &lt; '2025-03-01'  -- Winter
```</p>
<p>Helps plan: Heating/cooling requirements, insulation needs</p>
<h5>Correlation with External Conditions</h5>
<p>Compare inside vs outside (if you have weather data):</p>
<p><code>sql
SELECT 
  "sht3x_temperature" as "inside_temp",
  "sht3x_humidity" as "inside_humidity",
  "weather_temperature" as "outside_temp"
FROM "environment", "weather"
WHERE time &gt; now() - 24h</code></p>
<p>Reveals: Insulation effectiveness, ventilation needs</p>
<h4>Grafana Dashboard Examples</h4>
<h5>Climate Overview Panel</h5>
<p><code>json
{
  "title": "Enclosure Climate",
  "targets": [
    {
      "query": "SELECT mean(\"sht3x_temperature\") FROM \"environment\" WHERE $timeFilter GROUP BY time($__interval)"
    },
    {
      "query": "SELECT mean(\"sht3x_humidity\") FROM \"environment\" WHERE $timeFilter GROUP BY time($__interval)"
    }
  ]
}</code></p>
<h5>Comfort Zone Visualization</h5>
<p>Graph showing safe operating zone:
- Green: Temp 0-50°C, Humidity 20-60%
- Yellow: Temp 50-65°C, Humidity 60-80%
- Red: Above thresholds</p>
<h5>Heatmap of Daily Patterns</h5>
<p><code>sql
SELECT 
  mean("sht3x_temperature") as "temperature"
FROM "environment" 
WHERE $timeFilter
GROUP BY time(1h), day</code></p>
<p>Shows: Hottest time of day, daily cycles, weekly patterns</p>
<h4>Retention Policies</h4>
<h5>Default Retention (Forever)</h5>
<p>```ini
[InfluxDB]
Enable = true</p>
<p>[SHT3x]
InfluxDB_Enable = true
```</p>
<p>All data kept indefinitely (storage grows continuously)</p>
<h5>Custom Retention Policy</h5>
<p>Create time-based retention in InfluxDB:</p>
<p>```sql
-- Keep raw data for 90 days
CREATE RETENTION POLICY "90_days" ON "mydb" DURATION 90d REPLICATION 1 DEFAULT</p>
<p>-- Downsample to hourly averages, keep 2 years
CREATE CONTINUOUS QUERY "cq_hourly_climate" ON "mydb"
BEGIN
  SELECT mean("sht3x_temperature") AS "temperature",
         mean("sht3x_humidity") AS "humidity"
  INTO "2_years"."environment"
  FROM "environment"
  GROUP BY time(1h)
END
```</p>
<p>Result: Detailed data for 3 months, hourly averages for 2 years</p>
<h4>Data Volume Estimates</h4>
<h5>Storage Requirements</h5>
<p>Assuming one SHT3x sensor:</p>
<p><strong>High-frequency logging</strong> (30 second intervals):
- Data points per day: 2,880
- Storage per day: ~35 KB (with compression)
- Storage per year: ~12.5 MB</p>
<p><strong>Follow-flow logging</strong> (5 minute intervals):
- Data points per day: 288
- Storage per day: ~3.5 KB
- Storage per year: ~1.3 MB</p>
<p><strong>Recommended</strong>: Start with follow-flow (Interval = -1), increase frequency only if needed for specific monitoring requirements.</p>
<h4>Prerequisites</h4>
<h5>InfluxDB Configuration Required</h5>
<p>Before enabling SHT3x InfluxDB logging:</p>
<ol>
<li>
<p><strong>Global InfluxDB must be enabled:</strong>
<code>ini
[InfluxDB]
Enable = true
Uri = http://192.168.1.100:8086
Database = watermeter</code></p>
</li>
<li>
<p><strong>InfluxDB server must be accessible:</strong></p>
</li>
<li>Check network connectivity</li>
<li>Verify database exists</li>
<li>
<p>Confirm authentication (if required)</p>
</li>
<li>
<p><strong>Test connection in device logs:</strong>
Look for InfluxDB connection success message</p>
</li>
</ol>
<h5>Verification Steps</h5>
<p>After enabling:</p>
<ol>
<li>Check device logs for InfluxDB write success</li>
<li>Query InfluxDB directly:
<code>sql
SELECT * FROM environment WHERE time &gt; now() - 5m</code></li>
<li>Verify fields exist:
<code>sql
SHOW FIELD KEYS FROM environment</code>
Should show: <code>sht3x_temperature</code> and <code>sht3x_humidity</code></li>
</ol>
<h4>Troubleshooting</h4>
<p><strong>No data in InfluxDB:</strong>
1. Verify global InfluxDB is enabled: <code>[InfluxDB] Enable = true</code>
2. Check InfluxDB connection in device logs
3. Confirm SHT3x sensor is reading (check Info page)
4. Verify InfluxDB_Enable = true for SHT3x specifically
5. Check InfluxDB server logs for write errors</p>
<p><strong>Data not visible in Grafana:</strong>
1. Verify Grafana data source points to correct InfluxDB
2. Check measurement name matches: <code>environment</code> (or custom)
3. Verify field names: <code>sht3x_temperature</code>, <code>sht3x_humidity</code>
4. Use InfluxDB CLI to verify data exists
5. Check Grafana query syntax</p>
<p><strong>Intermittent data gaps:</strong>
- Check network stability
- Verify InfluxDB server isn't overloaded
- Check device logs for write failures
- Consider increasing Interval to reduce write frequency</p>
<p><strong>Storage growing too fast:</strong>
- Reduce reading frequency (increase Interval)
- Implement retention policy (see above)
- Enable InfluxDB compression
- Consider downsampling old data</p>
<h4>Performance Considerations</h4>
<h5>Write Frequency Impact</h5>
<p><strong>High-frequency writes</strong> (every 30 seconds):
- Pros: Detailed data, catch rapid changes
- Cons: Network traffic, storage usage, server load
- When: Monitoring rapid climate changes, troubleshooting</p>
<p><strong>Medium-frequency writes</strong> (every 5 minutes):
- Pros: Good balance of detail and efficiency
- Cons: May miss rapid fluctuations
- When: General monitoring, most use cases</p>
<p><strong>Follow-flow writes</strong> (Interval = -1, typically 5-10 minutes):
- Pros: Minimal overhead, aligned with meter readings
- Cons: Lower temporal resolution
- When: Long-term trending, minimal infrastructure</p>
<h5>Batch Writing</h5>
<p>InfluxDB handles batching internally. To optimize:
- Use consistent intervals (not random)
- Avoid very high frequency (&lt; 30 seconds) unless necessary
- Monitor InfluxDB write queue metrics</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="InfluxDB_Measurement.md">SHT3x InfluxDB_Measurement</a> - Set measurement name</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Set reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Enable.md">InfluxDB Enable</a> - Global InfluxDB configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Uri.md">InfluxDB Uri</a> - InfluxDB server connection</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="SHT3xItem">
            <td class="indent1">InfluxDB Measurement</td>
            <td>
                <input type="text" id="SHT3x_InfluxDB_Measurement_value1" value="environment">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">SHT3x InfluxDB Measurement</h3>
<p>Set the InfluxDB measurement name for SHT3x temperature and humidity sensor data.</p>
<h4>Value</h4>
<p>Default: <code>environment</code></p>
<p>String value representing the InfluxDB measurement name where sensor data is stored.</p>
<h4>Description</h4>
<p>In InfluxDB, a <strong>measurement</strong> is analogous to a database table. All SHT3x sensor readings are written to this measurement with two fields: <code>sht3x_temperature</code> and <code>sht3x_humidity</code>.</p>
<h4>Measurement Structure</h4>
<h5>Format</h5>
<p><code>Measurement: {InfluxDB_Measurement}
Fields:
  sht3x_temperature: {temperature_value}
  sht3x_humidity: {humidity_value}
Timestamp: {read_time}</code></p>
<h5>Example Data Point</h5>
<p><strong>Single SHT3x Sensor:</strong>
<code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  sht3x_temperature = 24.5
  sht3x_humidity = 45.2</code></p>
<p><strong>Multiple Sensor Types Combined:</strong>
<code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  sht3x_temperature = 24.5           (SHT3x inside)
  sht3x_humidity = 45.2              (SHT3x inside)
  temperature_28-0123456789AB = 15.2 (DS18B20 outside)
  temperature_28-FEDCBA987654 = 22.3 (DS18B20 inside)</code></p>
<h4>Naming Conventions</h4>
<h5>Recommended Measurement Names</h5>
<p><strong>By Data Category:</strong>
<code>environment      - Environmental monitoring (recommended)
sensors          - Generic sensor data
climate          - Climate-specific data
monitoring       - General monitoring data
device_health    - Device health metrics
enclosure        - Enclosure-specific data</code></p>
<p><strong>By Location:</strong>
<code>enclosure_env    - Enclosure environmental data
outdoor_env      - Outdoor environmental data
basement_sensors - Basement sensor readings
garage_climate   - Garage climate monitoring</code></p>
<p><strong>By System:</strong>
<code>watermeter_env   - Watermeter environmental data
gasmeter_env     - Gas meter environmental data
meter_health     - Meter health monitoring</code></p>
<h5>Best Practices</h5>
<p><strong>DO:</strong>
- ✅ Use lowercase names
- ✅ Use underscores for word separation
- ✅ Keep names descriptive but concise (&lt; 30 characters)
- ✅ Use consistent naming across devices
- ✅ Group related sensors in same measurement</p>
<p><strong>DON'T:</strong>
- ❌ Use spaces (breaks queries)
- ❌ Use special characters except underscore and dash
- ❌ Use overly long names
- ❌ Mix unrelated data types in same measurement
- ❌ Use database-reserved keywords</p>
<h4>Querying Data</h4>
<h5>Basic Queries</h5>
<p><strong>Get recent readings:</strong>
<code>sql
SELECT sht3x_temperature, sht3x_humidity 
FROM environment 
WHERE time &gt; now() - 1h</code></p>
<p><strong>Calculate averages:</strong>
<code>sql
SELECT 
  mean(sht3x_temperature) as avg_temp,
  mean(sht3x_humidity) as avg_humidity
FROM environment 
WHERE time &gt; now() - 24h 
GROUP BY time(1h)</code></p>
<p><strong>Find extremes:</strong>
<code>sql
SELECT 
  max(sht3x_temperature) as max_temp,
  min(sht3x_temperature) as min_temp,
  max(sht3x_humidity) as max_humidity,
  min(sht3x_humidity) as min_humidity
FROM environment 
WHERE time &gt; now() - 7d</code></p>
<h5>Advanced Queries</h5>
<p><strong>Correlation analysis:</strong>
<code>sql
SELECT 
  sht3x_temperature,
  sht3x_humidity,
  sht3x_temperature - ((100 - sht3x_humidity) / 5) as dew_point_estimate
FROM environment 
WHERE time &gt; now() - 24h</code></p>
<p><strong>Multi-sensor comparison:</strong>
<code>sql
SELECT 
  sht3x_temperature as "Inside Temp",
  temperature_28-0123456789AB as "Outside Temp",
  sht3x_humidity as "Inside Humidity"
FROM environment 
WHERE time &gt; now() - 24h</code></p>
<p><strong>Conditional filtering:</strong>
<code>sql
SELECT * 
FROM environment 
WHERE 
  sht3x_humidity &gt; 80 OR
  sht3x_temperature &gt; 60
AND time &gt; now() - 30d</code></p>
<h4>Grafana Integration</h4>
<h5>Datasource Configuration</h5>
<ol>
<li>Add InfluxDB datasource in Grafana</li>
<li>Set database name (e.g., <code>watermeter</code>)</li>
<li>Configure measurement name: <code>environment</code></li>
</ol>
<h5>Panel Queries</h5>
<p><strong>Temperature graph:</strong>
<code>sql
SELECT mean("sht3x_temperature") 
FROM "environment" 
WHERE $timeFilter 
GROUP BY time($__interval) fill(null)</code></p>
<p><strong>Humidity graph:</strong>
<code>sql
SELECT mean("sht3x_humidity") 
FROM "environment" 
WHERE $timeFilter 
GROUP BY time($__interval) fill(null)</code></p>
<p><strong>Combined panel:</strong>
<code>sql
SELECT 
  mean("sht3x_temperature") as "Temperature",
  mean("sht3x_humidity") as "Humidity"
FROM "environment" 
WHERE $timeFilter 
GROUP BY time($__interval)</code></p>
<h5>Dashboard Variables</h5>
<p>Create measurement variable for dynamic dashboards:</p>
<p><code>Name: measurement
Query: SHOW MEASUREMENTS</code></p>
<p>Then use in queries:
<code>sql
SELECT * FROM "$measurement" WHERE $timeFilter</code></p>
<h4>Organization Strategies</h4>
<h5>Single Measurement (Recommended for Small Deployments)</h5>
<p>Store all sensor data in one measurement:</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = environment</p>
<p>[DS18B20]
InfluxDB_Measurement = environment
```</p>
<p><strong>Pros:</strong>
- Simple queries
- Easy to correlate data
- Single dashboard for all sensors</p>
<p><strong>Cons:</strong>
- All data mixed together
- Harder to apply different retention policies</p>
<h5>Multiple Measurements (Better for Large Deployments)</h5>
<p>Separate by sensor type or location:</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = climate</p>
<p>[DS18B20]
InfluxDB_Measurement = temperature
```</p>
<p><strong>Pros:</strong>
- Clear data separation
- Different retention policies per type
- Better query performance for specific types</p>
<p><strong>Cons:</strong>
- More complex queries for correlation
- Multiple dashboard panels needed</p>
<h5>Hierarchical Naming</h5>
<p>Use consistent prefixes for organization:</p>
<p><code>device_climate        - Device climate data
device_temperature    - Device temperature sensors
system_health        - System health metrics
meter_readings       - Meter reading data</code></p>
<h4>Data Retention</h4>
<h5>Apply Retention by Measurement</h5>
<p><strong>Keep climate data longer:</strong>
```sql
-- Create retention policy for climate data
CREATE RETENTION POLICY "climate_2years" ON "mydb" 
  DURATION 104w 
  REPLICATION 1</p>
<p>-- Use for SHT3x data
[SHT3x]
InfluxDB_Measurement = climate
```</p>
<p><strong>Shorter retention for temperature:</strong>
```sql
-- Only keep temperature data 90 days
CREATE RETENTION POLICY "temp_90days" ON "mydb" 
  DURATION 90d 
  REPLICATION 1</p>
<p>[DS18B20]
InfluxDB_Measurement = temperature
```</p>
<h5>Downsampling Strategy</h5>
<p>Keep raw data short-term, aggregates long-term:</p>
<p><code>sql
-- Downsample to hourly averages
CREATE CONTINUOUS QUERY "cq_hourly_climate" ON "mydb"
BEGIN
  SELECT 
    mean("sht3x_temperature") AS "temperature",
    mean("sht3x_humidity") AS "humidity"
  INTO "longterm"."environment_hourly"
  FROM "environment"
  GROUP BY time(1h)
END</code></p>
<p>Result:
- Raw data: 90 days retention
- Hourly averages: 2 years retention
- Storage optimized</p>
<h4>Migration and Changes</h4>
<h5>Changing Measurement Name</h5>
<p>When changing measurement names, old data remains in old measurement.</p>
<p><strong>Step 1: Update configuration</strong>
<code>ini
[SHT3x]
InfluxDB_Measurement = new_measurement_name  ### Changed from environment</code></p>
<p><strong>Step 2: Update Grafana dashboards</strong>
<code>sql
-- Change FROM clause
SELECT * FROM "new_measurement_name" WHERE $timeFilter</code></p>
<p><strong>Step 3: Optional - migrate old data</strong>
<code>sql
-- Copy old data to new measurement
SELECT * INTO "new_measurement_name" FROM "environment" GROUP BY *</code></p>
<p><strong>Step 4: Optional - delete old data</strong>
<code>sql
DROP MEASUREMENT "environment"</code></p>
<h4>Troubleshooting</h4>
<p><strong>Measurement not appearing:</strong>
1. Check InfluxDB_Enable = true
2. Verify sensor is reading (Info page)
3. Check device logs for write errors
4. Verify InfluxDB server is accessible
5. Run: <code>SHOW MEASUREMENTS</code> in InfluxDB CLI</p>
<p><strong>Wrong measurement name in database:</strong>
- Check configuration spelling
- Verify no typos in InfluxDB_Measurement
- Case-sensitive - <code>environment</code> ≠ <code>Environment</code></p>
<p><strong>Cannot query measurement:</strong>
```sql
-- Check if measurement exists
SHOW MEASUREMENTS</p>
<p>-- Check fields in measurement
SHOW FIELD KEYS FROM "environment"</p>
<p>-- Should show: sht3x_temperature, sht3x_humidity
```</p>
<p><strong>Grafana can't find measurement:</strong>
1. Verify datasource connection
2. Check database name is correct
3. Confirm measurement name (case-sensitive)
4. Try refresh schema in Grafana
5. Use InfluxDB CLI to verify data exists</p>
<p><strong>Data in wrong measurement:</strong>
- Configuration was changed after data was written
- Old data stays in old measurement
- New data goes to new measurement
- Either migrate data or accept both measurements exist</p>
<h4>Performance Considerations</h4>
<h5>Query Performance</h5>
<p><strong>Optimize queries:</strong>
- Index by time automatically applied
- Use WHERE time clauses to limit data
- Avoid SELECT * on large datasets
- Use GROUP BY time($__interval) in Grafana
- Consider downsampling for old data</p>
<p><strong>Measurement size impact:</strong>
- Fewer measurements = simpler queries
- More measurements = better organization
- Typically not a concern for sensor data volumes</p>
<h5>Write Performance</h5>
<p><strong>Single measurement</strong> (all sensors):
- Fewer measurement lookups
- Simpler write path
- Good for &lt; 1000 writes/second</p>
<p><strong>Multiple measurements</strong> (per sensor type):
- Better write distribution
- Easier to partition data
- Better for &gt; 1000 writes/second</p>
<p>For typical home automation: Single measurement is fine</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="InfluxDB_Enable.md">SHT3x InfluxDB_Enable</a> - Enable InfluxDB logging</li>
<li><a target=_blank href="Enable.md">SHT3x Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">SHT3x Interval</a> - Set reading frequency</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Enable.md">InfluxDB Enable</a> - Global InfluxDB configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Database.md">InfluxDB Database</a> - InfluxDB database name</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <!------------- DS18B20 Sensor ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4>
                <input type="checkbox" id="Category_DS18B20_enabled" value="1"  onclick = 'UpdateAfterCategoryCheck()' unchecked >
                <label for=Category_DS18B20_enabled>DS18B20 (Temperature Sensor - Chainable)</label>
                </h4>
                <p style="font-size: 0.9em; color: #666; margin: 5px 0;">Multiple DS18B20 sensors can be chained on same wire. Each sensor is identified by unique ROM ID.</p>
                <div style="background-color: #e7f3ff; border-left: 4px solid #2196F3; padding: 10px; margin: 5px 0; font-size: 0.9em;">
                    <strong>⚠️ GPIO Configuration Required:</strong> Before enabling this sensor, you must configure GPIO pins for 1-Wire communication.
                    <br><br>
                    <strong>Steps:</strong>
                    <ol style="margin: 5px 0; padding-left: 20px;">
                        <li>Scroll down to the <strong>GPIO</strong> section below</li>
                        <li>Click <strong>"Show Expert Parameters"</strong> checkbox to reveal GPIO settings</li>
                        <li>Set one GPIO pin to <strong>onewire</strong> (e.g., IO12)</li>
                        <li>Save configuration and restart device</li>
                        <li>Then return here to enable and configure the DS18B20 sensor</li>
                    </ol>
                    See <a href="https://jomjol.github.io/AI-on-the-edge-device-docs/parameter-pages/Sensors-Overview/" target="_blank">Sensors Overview Documentation</a> for detailed wiring and setup instructions.
                </div>
            </td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">Expected Sensor Count</td>
            <td>
                <input type="number" id="DS18B20_ExpectedSensors_value1" min="-1" step="1" value="-1">
                <span style="font-size: 0.9em; color: #666;">(-1 = auto-detect, >0 = validate count with retry)</span>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 ExpectedSensors</h3>
<p>Define the expected number of DS18B20 sensors on the 1-Wire bus to enable retry logic during initialization.</p>
<h4>Value</h4>
<ul>
<li><code>-1</code> - Auto-detect mode (default) - Accept any number of sensors found on first successful scan</li>
<li>Positive integer (e.g., <code>1</code>, <code>2</code>, <code>3</code>) - Expected sensor count with validation and retry</li>
</ul>
<h4>Description</h4>
<p>Controls the ROM search behavior during sensor initialization to improve reliability in environments with electrical interference or timing issues.</p>
<h5>Auto-Detect Mode (ExpectedSensors = -1)</h5>
<p><strong>Default behavior - Recommended for most users</strong></p>
<p>The system performs a ROM search and accepts whatever sensors are found on the first successful scan.</p>
<p><strong>Behavior:</strong>
- Performs ROM search once at startup
- Accepts any positive number of sensors found
- No retries performed
- Fast initialization (typical: 100-200ms per sensor)</p>
<p><strong>Use when:</strong>
- Sensor count is flexible or unknown
- Reliable electrical environment
- Quick startup is priority
- Testing/development with varying sensor counts</p>
<p><strong>Example:</strong>
<code>ini
[DS18B20]
ExpectedSensors = -1        ; Auto-detect (default)</code></p>
<h5>Validation Mode (ExpectedSensors &gt; 0)</h5>
<p><strong>For production installations with known sensor counts</strong></p>
<p>The system validates the detected sensor count against the expected value and retries if there's a mismatch.</p>
<p><strong>Behavior:</strong>
- Performs up to 5 ROM search attempts
- Validates detected count matches expected value
- Increasing retry delays: 100ms, 150ms, 200ms, 250ms, 300ms
- Keeps best result (highest sensor count) if retries exhausted
- Continues initialization with partial detection if needed</p>
<p><strong>Use when:</strong>
- Fixed installation with known sensor count
- Noisy electrical environment (interference)
- Timing issues during startup
- Need validation that all sensors are detected
- Production/critical monitoring systems</p>
<p><strong>Example:</strong>
```ini
[GPIO]
IO3 = onewire               ; * Requires disabling USB logging              ; 3 DS18B20 sensors wired in parallel</p>
<p>[DS18B20]
ExpectedSensors = 3         ; Expect exactly 3 sensors
MQTT_Enable = true
```</p>
<h4>How Retry Logic Works</h4>
<p>When <code>ExpectedSensors</code> is set to a positive value, the initialization process becomes more robust:</p>
<h5>Retry Sequence</h5>
<ol>
<li><strong>First Attempt (0ms delay)</strong></li>
<li>Performs ROM search</li>
<li>If count matches expected → Success, continues</li>
<li>
<p>If count &lt; expected → Retry</p>
</li>
<li>
<p><strong>Retry 1 (100ms delay)</strong></p>
</li>
<li>Waits 100ms for bus to stabilize</li>
<li>Performs ROM search</li>
<li>If count matches expected → Success</li>
<li>
<p>Otherwise, continues retrying</p>
</li>
<li>
<p><strong>Retries 2-5 (150ms, 200ms, 250ms, 300ms delays)</strong></p>
</li>
<li>Progressive delays allow more time for bus stabilization</li>
<li>Each retry performs fresh ROM search</li>
<li>
<p>Tracks highest sensor count seen across all attempts</p>
</li>
<li>
<p><strong>After 5 Attempts</strong></p>
</li>
<li>If expected count achieved → Success</li>
<li>If not, uses best result (most sensors found)</li>
<li>Logs warning but continues operation</li>
<li>Better to have partial data than fail completely</li>
</ol>
<h5>Example Scenarios</h5>
<p><strong>Scenario 1: Perfect Detection</strong>
<code>ExpectedSensors = 3
Attempt 1: Found 3 sensors → Success immediately
Total time: ~200ms</code></p>
<p><strong>Scenario 2: Timing Issue Resolved by Retry</strong>
<code>ExpectedSensors = 3
Attempt 1: Found 2 sensors → Retry
Attempt 2 (100ms delay): Found 3 sensors → Success
Total time: ~400ms</code></p>
<p><strong>Scenario 3: Partial Detection (Hardware Issue)</strong>
<code>ExpectedSensors = 3
Attempt 1: Found 2 sensors → Retry
Attempt 2: Found 2 sensors → Retry
Attempt 3: Found 2 sensors → Retry
Attempt 4: Found 2 sensors → Retry
Attempt 5: Found 2 sensors → Uses best result
Warning: "Found 2 sensor(s) but expected 3 - continuing with detected sensors"
Total time: ~1200ms</code></p>
<h4>Choosing the Right Value</h4>
<h5>Use ExpectedSensors = -1 (Auto-Detect) When:</h5>
<p>✅ <strong>Development/Testing</strong>
- Experimenting with different sensor configurations
- Don't know final sensor count yet
- Rapid prototyping phase</p>
<p>✅ <strong>Flexible Installations</strong>
- Sensor count may vary over time
- Hot-swapping sensors (requires restart anyway)
- Not critical if count changes</p>
<p>✅ <strong>Known Reliable Setup</strong>
- No electrical interference
- Strong, short wiring
- Indoor, controlled environment
- Never had detection issues</p>
<h5>Use ExpectedSensors = 1, 2, 3, etc. When:</h5>
<p>✅ <strong>Production Systems</strong>
- Fixed installation with known sensor count
- Need validation during startup
- Early warning if sensor fails</p>
<p>✅ <strong>Challenging Environments</strong>
- Long wire runs (&gt;5 meters)
- Electrical noise (motors, pumps nearby)
- Outdoor installations
- Have experienced detection issues before</p>
<p>✅ <strong>Critical Monitoring</strong>
- All sensors must be operational
- Want to catch hardware failures early
- Compliance/regulatory requirements</p>
<h4>Performance Impact</h4>
<h5>Auto-Detect Mode (ExpectedSensors = -1)</h5>
<ul>
<li><strong>Best case</strong>: Single ROM search (~200ms for 3 sensors)</li>
<li><strong>Worst case</strong>: Same as best case</li>
<li><strong>Typical startup</strong>: 200-500ms</li>
</ul>
<h5>Validation Mode (ExpectedSensors = 3)</h5>
<ul>
<li><strong>Best case</strong>: Single ROM search (~200ms) if all sensors found immediately</li>
<li><strong>Worst case</strong>: 5 retries with delays (~2 seconds)</li>
<li><strong>Typical startup</strong>: 200-800ms (most succeed on first or second try)</li>
</ul>
<p>The additional time is negligible during device startup and provides significant reliability improvement.</p>
<h4>Best Practices</h4>
<h5>Wiring for Reliable Detection</h5>
<p>Even with retry logic, proper wiring is essential:</p>
<p><strong>Do's:</strong>
- Use proper pull-up resistor (4.7kΩ recommended)
- Keep wires as short as practical
- Use twisted pair or shielded cable for long runs
- Secure all connections
- Use quality sensors</p>
<p><strong>Don'ts:</strong>
- Don't use wire runs longer than 10 meters without special consideration
- Don't connect/disconnect sensors while powered (restart required anyway)
- Don't mix different cable types in same bus
- Don't use weak/loose connections</p>
<h5>Recommended Configurations</h5>
<p><strong>1-2 Sensors, Short Wires (&lt;3m), Indoor:</strong>
<code>ini
ExpectedSensors = -1        ; Auto-detect is fine</code></p>
<p><strong>3+ Sensors OR Long Wires (&gt;3m) OR Outdoor:</strong>
<code>ini
ExpectedSensors = 3         ; Your actual count</code></p>
<p><strong>Testing New Installation:</strong>
<code>ini
ExpectedSensors = -1        ; Start with auto-detect</code>
Monitor logs for detection issues. If problems occur, switch to exact count.</p>
<h4>Troubleshooting</h4>
<h5>Warning: "Found 2 sensor(s) but expected 3"</h5>
<p><strong>Possible causes:</strong>
1. <strong>Wiring issue</strong>: Check connections, solder joints
2. <strong>Sensor failure</strong>: One sensor may be defective
3. <strong>Power issue</strong>: Insufficient current for all sensors
4. <strong>Cable too long</strong>: Signal degradation over distance
5. <strong>Interference</strong>: Nearby electrical noise</p>
<p><strong>Steps:</strong>
1. Check device logs for ROM IDs detected
2. Physically verify all sensors are connected
3. Test sensors individually to isolate faulty one
4. Check power supply voltage (3.3V stable)
5. Reduce wire length if possible
6. Add/check pull-up resistor</p>
<h5>Field Locked/Disabled in UI</h5>
<p>If the ExpectedSensors field appears locked:
1. Ensure this documentation file exists (it does now!)
2. Rebuild web interface tooltips (done during build process)
3. Hard refresh browser (Ctrl+Shift+R)</p>
<h5>No Sensors Detected at All</h5>
<p>If no sensors are detected even with retries:
1. Verify GPIO pin is configured as <code>onewire</code>
2. Check physical wiring (data, ground, power)
3. Verify sensors are DS18B20 (not DHT22 or other types)
4. Test sensor(s) with different device/Arduino to confirm working
5. Check pull-up resistor is present and correct value</p>
<h4>Example Configurations</h4>
<h5>Example 1: Simple Indoor Setup</h5>
<p><strong>Scenario</strong>: Single sensor monitoring enclosure temperature</p>
<p>```ini
[GPIO]
IO3 = onewire               ; * Requires disabling USB logging</p>
<p>[DS18B20]
ExpectedSensors = 1         ; Validate sensor detected
Interval = -1
MQTT_Enable = true
MQTT_Topic = enclosure/temperature
```</p>
<p><strong>Benefit</strong>: Immediate alert at startup if sensor disconnected or failed.</p>
<h5>Example 2: Multi-Point Monitoring</h5>
<p><strong>Scenario</strong>: Three sensors (inside, outside, pipe) in outdoor enclosure</p>
<p>```ini
[GPIO]
IO3 = onewire               ; * Requires disabling USB logging              ; 3 sensors on same bus</p>
<p>[DS18B20]
ExpectedSensors = 3         ; Validate all 3 detected
Interval = 300              ; Read every 5 minutes
MQTT_Enable = true
MQTT_Topic = outdoor/temperature
InfluxDB_Enable = true
InfluxDB_Measurement = environment
```</p>
<p><strong>Benefit</strong>: Retry logic compensates for outdoor electrical interference. Logs warning if sensor count drops (maintenance needed).</p>
<h5>Example 3: Development/Testing</h5>
<p><strong>Scenario</strong>: Experimenting with different sensor configurations</p>
<p>```ini
[GPIO]
IO3 = onewire               ; * Requires disabling USB logging</p>
<p>[DS18B20]
ExpectedSensors = -1        ; Auto-detect whatever is connected
Interval = -1
MQTT_Enable = true
```</p>
<p><strong>Benefit</strong>: No need to update config when adding/removing test sensors.</p>
<h4>Log Output Examples</h4>
<h5>Successful Detection with Expected Count</h5>
<p><code>[INFO] DS18B20: Initializing DS18B20 sensor on GPIO12
[INFO] DS18B20: Expected sensor count: 3
[INFO] DS18B20: === DS18B20 ROM Search (startup only) ===
[INFO] DS18B20: Scanning 1-Wire bus for DS18B20 devices...
[INFO] DS18B20: ROM search found expected 3 sensor(s) on retry 1
[INFO] DS18B20: ROM search complete: Found 3 DS18B20 sensor(s)
[INFO] DS18B20: Discovered ROM IDs (will be used for all future reads):
[INFO] DS18B20:   Sensor #1: 28-0123456789AB
[INFO] DS18B20:   Sensor #2: 28-FEDCBA987654
[INFO] DS18B20:   Sensor #3: 28-AABBCCDD1122
[INFO] DS18B20: === DS18B20 initialization complete ===</code></p>
<h5>Detection with Retry</h5>
<p><code>[INFO] DS18B20: Expected sensor count: 3
[INFO] DS18B20: Scanning 1-Wire bus for DS18B20 devices...
[WARN] DS18B20: ROM search found 2 sensor(s), expected 3
[WARN] DS18B20: ROM search retry 2 after 150ms
[INFO] DS18B20: ROM search found expected 3 sensor(s) on retry 2
[INFO] DS18B20: ROM search complete: Found 3 DS18B20 sensor(s)</code></p>
<h5>Partial Detection (Warning)</h5>
<p><code>[INFO] DS18B20: Expected sensor count: 3
[WARN] DS18B20: ROM search found 2 sensor(s), expected 3
[WARN] DS18B20: ROM search retry 2 after 150ms
[WARN] DS18B20: ROM search found 2 sensor(s), expected 3
[WARN] DS18B20: ROM search retry 3 after 200ms
[WARN] DS18B20: ROM search found 2 sensor(s), expected 3
[WARN] DS18B20: ROM search retry 4 after 250ms
[WARN] DS18B20: ROM search found 2 sensor(s), expected 3
[WARN] DS18B20: ROM search retry 5 after 300ms
[WARN] DS18B20: Using best ROM search result: 2 sensor(s)
[WARN] DS18B20: Found 2 sensor(s) but expected 3 - continuing with detected sensors
[INFO] DS18B20: ROM search complete: Found 2 DS18B20 sensor(s)</code>
This indicates a hardware issue - check wiring and sensors.</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Interval.md">DS18B20 Interval</a> - Set reading frequency</li>
<li><a target=_blank href="MQTT_Enable.md">DS18B20 MQTT Enable</a> - Publish to MQTT</li>
<li><a target=_blank href="MQTT_Topic.md">DS18B20 MQTT Topic</a> - MQTT topic configuration</li>
<li><a target=_blank href="InfluxDB_Enable.md">DS18B20 InfluxDB Enable</a> - Log to InfluxDB</li>
<li><a target=_blank href="InfluxDB_Measurement.md">DS18B20 InfluxDB Measurement</a> - InfluxDB measurement name</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/OneWire.md">GPIO OneWire</a> - GPIO pin configuration for 1-Wire bus</li>
</ul>
<h4>Technical Details</h4>
<h5>ROM Search Algorithm</h5>
<p>The DS18B20 uses the Dallas/Maxim 1-Wire protocol for device enumeration:</p>
<ol>
<li><strong>Bus Reset</strong>: Master pulls line low, sensors respond with presence pulse</li>
<li><strong>Search ROM Command (0xF0)</strong>: Initiates device discovery</li>
<li><strong>Bit-by-bit Search</strong>: Master reads bit + complement bit for each ROM bit</li>
<li><strong>Discrepancy Resolution</strong>: Handles multiple devices on same bus</li>
<li><strong>CRC Validation</strong>: Ensures ROM ID integrity (8-bit CRC)</li>
<li><strong>Family Code Check</strong>: Verifies device is DS18B20 (0x28)</li>
</ol>
<h5>Why Retries Help</h5>
<p><strong>Timing Issues:</strong>
- 1-Wire protocol is software-based (bit-banged)
- Sensitive to CPU load and interrupts
- ESP32 background tasks can cause timing variations
- Retry with delay allows system to stabilize</p>
<p><strong>CRC Errors:</strong>
- Electrical noise can corrupt data
- Long wires increase susceptibility
- Retry often succeeds on second attempt
- Multiple attempts improve overall reliability</p>
<p><strong>Bus Initialization:</strong>
- Some sensors need time to power up
- Capacitance in long wires affects timing
- First reset may not detect all devices
- Delay + retry gives sensors time to stabilize</p>
<h5>Implementation Notes</h5>
<ul>
<li>Retry logic is <strong>only during initialization</strong> (not on every read)</li>
<li>ROM IDs are <strong>cached</strong> after successful detection</li>
<li>Future reads use cached ROM IDs (no re-scanning)</li>
<li>Retries add 0-2 seconds to startup time (one-time cost)</li>
<li>No runtime performance impact after initialization</li>
</ul>
<h4>Migration Guide</h4>
<p>If upgrading from a version without ExpectedSensors parameter:</p>
<p><strong>Existing config files:</strong>
- Parameter is optional
- Default value is <code>-1</code> (auto-detect)
- No changes needed to existing configs
- Behavior remains the same unless you set ExpectedSensors</p>
<p><strong>To enable retry logic:</strong>
1. Count your connected DS18B20 sensors
2. Add <code>ExpectedSensors = &lt;count&gt;</code> to DS18B20 section
3. Save and restart device
4. Check logs to verify detection</p>
<p><strong>Example migration:</strong>
```ini</p>
<h3 style="margin: 0">Before (still works):</h3>
<p>[DS18B20]
Interval = -1
MQTT_Enable = true</p>
<h3 style="margin: 0">After (adds validation):</h3>
<p>[DS18B20]
ExpectedSensors = 3         ; NEW: Enable retry logic
Interval = -1
MQTT_Enable = true
```</p>
<h4>Summary</h4>
<ul>
<li><strong>Default (-1)</strong>: Auto-detect, fast, works for most cases</li>
<li><strong>Positive integer</strong>: Validates count, enables retries, more robust</li>
<li><strong>Use exact count</strong>: For production systems with known hardware</li>
<li><strong>Use auto-detect</strong>: For development, testing, flexible setups</li>
<li><strong>Retry logic</strong>: Improves reliability without runtime overhead</li>
<li><strong>Backward compatible</strong>: Existing configs continue working unchanged</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">Read Interval (seconds)</td>
            <td>
                <input type="number" id="DS18B20_Interval_value1" min="-1" step="1" value="-1">
                <span style="font-size: 0.9em; color: #666;">(-1 = follow flow cycle)</span>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 Interval</h3>
<p>Set the reading interval for DS18B20 temperature sensor(s).</p>
<h4>Value</h4>
<ul>
<li><code>-1</code> - Follow flow cycle (default) - Read on every main flow execution</li>
<li><code>0</code> or positive integer - Custom interval in seconds</li>
</ul>
<h4>Description</h4>
<p>Controls how often the sensor(s) are read and data is published.</p>
<h5>Follow Flow Mode (Interval = -1)</h5>
<p><strong>Recommended for most users</strong></p>
<p>When set to <code>-1</code>, the sensor is read every time the main flow executes. This synchronizes sensor readings with meter readings.</p>
<p><strong>Benefits:</strong>
- Sensor data timestamped with meter data
- Correlate environmental conditions with meter readings
- No additional timer overhead
- Simple configuration</p>
<p><strong>Example:</strong>
```ini
[AutoTimer]
Interval = 10        ; Main flow every 10 minutes</p>
<p>[DS18B20]
Interval = -1        ; Read sensor every 10 minutes (follows flow)
```</p>
<p>Result: Sensor read every 10 minutes, aligned with meter readings.</p>
<h5>Custom Interval Mode (Interval &gt; 0)</h5>
<p><strong>For advanced monitoring scenarios</strong></p>
<p>Set a specific interval in seconds, independent of the main flow cycle.</p>
<p><strong>Note:</strong> As of version [current], custom intervals are now properly supported through a background task. Sensors with custom intervals will be read at their specified rate, even if shorter than the flow interval.</p>
<p><strong>Use Cases:</strong>
- <strong>High-frequency monitoring</strong>: Interval = 60 (every minute) for rapid temperature changes
- <strong>Low-frequency logging</strong>: Interval = 3600 (every hour) to reduce data volume
- <strong>Different cadence</strong>: Flow every 5 min, sensors every 15 min</p>
<p><strong>Example 1: Rapid Temperature Monitoring</strong>
```ini
[AutoTimer]
Interval = 10        ; Flow every 10 minutes</p>
<p>[DS18B20]
Interval = 60        ; Read sensor every 1 minute
```</p>
<p>Use when: Monitoring rapidly changing conditions (e.g., pipe temperature, outdoor exposure)</p>
<p><strong>Example 2: Low-Frequency Trending</strong>
```ini
[AutoTimer]
Interval = 2         ; Flow every 2 minutes</p>
<p>[DS18B20]
Interval = 900       ; Read sensor every 15 minutes
```</p>
<p>Use when: Long-term trending, reduce InfluxDB storage</p>
<h4>Multiple Sensors</h4>
<p>When multiple DS18B20 sensors are chained on the same 1-Wire bus, they are all read during each cycle. The interval applies to the entire bus, not individual sensors.</p>
<p><strong>Reading Time:</strong>
- Single sensor: ~800ms (750ms conversion + 50ms communication)
- Three sensors: ~2.4 seconds (sequential reads)</p>
<h4>Choosing the Right Interval</h4>
<h5>For Device Health Monitoring</h5>
<p><strong>General Purpose (Recommended):</strong>
<code>ini
Interval = -1        ; Follow flow cycle</code>
Good for: Most installations, balanced data collection</p>
<p><strong>Outdoor Extreme Weather:</strong>
<code>ini
Interval = 300       ; Every 5 minutes</code>
Good for: Detecting rapid temperature changes, weather events</p>
<p><strong>Indoor Stable Environment:</strong>
<code>ini
Interval = 1800      ; Every 30 minutes</code>
Good for: Basement, garage, minimal variation</p>
<p><strong>Failure Detection:</strong>
<code>ini
Interval = 60        ; Every 1 minute</code>
Good for: Debugging overheating, tracking cooling system performance</p>
<h5>Performance Considerations</h5>
<p><strong>DS18B20 Measurement Time:</strong>
- 12-bit resolution: 750ms conversion time
- Total read time: ~800ms per sensor</p>
<p><strong>Data Volume with 3 sensors:</strong>
- Every minute: 4,320 readings/day, 129,600/month
- Every 5 minutes: 864 readings/day, 25,920/month
- Every hour: 72 readings/day, 2,160/month</p>
<p>Consider InfluxDB storage and retention policies.</p>
<h4>Example Scenarios</h4>
<h5>Scenario 1: Multi-Point Temperature Monitoring</h5>
<p><strong>Goal</strong>: Track inside, outside, and pipe temperatures</p>
<p>```ini
[GPIO]
IO3 = onewire               ; * Requires disabling USB logging       ; 3 sensors on same wire</p>
<p>[DS18B20]
Enable = true
Interval = -1        ; Follow flow (e.g., every 10 min)
MQTT_Enable = true
MQTT_Topic = enclosure/temperature
```</p>
<p>MQTT output:
<code>enclosure/temperature/28-0123456789AB → 24.5  (inside)
enclosure/temperature/28-FEDCBA987654 → 15.2  (outside)
enclosure/temperature/28-AABBCCDD1122 → 12.8  (pipe)</code></p>
<h5>Scenario 2: Freeze Protection</h5>
<p><strong>Goal</strong>: Alert when pipe temperature drops too low</p>
<p><code>ini
[DS18B20]
Interval = 120       ; Check every 2 minutes
MQTT_Enable = true</code></p>
<p>In Home Assistant:
<code>yaml
automation:
  - alias: "Pipe Freeze Alert"
    trigger:
      platform: numeric_state
      entity_id: sensor.pipe_temperature
      below: 2
      for: "00:04:00"  ### 2 consecutive readings
    action:
      - service: notify.mobile_app
        data:
          message: "⚠️ Pipe temperature: {{ states('sensor.pipe_temperature') }}°C - Freeze risk!"</code></p>
<h5>Scenario 3: Thermal Gradient Analysis</h5>
<p><strong>Goal</strong>: Understand temperature distribution</p>
<p><code>ini
[DS18B20]
Interval = 600       ; Every 10 minutes
InfluxDB_Enable = true
InfluxDB_Measurement = environment</code></p>
<p>Grafana query:
<code>SELECT 
  mean("temperature_28-0123456789AB") as "Inside",
  mean("temperature_28-FEDCBA987654") as "Outside",
  mean("temperature_28-AABBCCDD1122") as "Pipe"
FROM "environment" 
WHERE time &gt; now() - 7d 
GROUP BY time(1h)</code></p>
<p>Reveals: Temperature gradients, insulation effectiveness, heat loss patterns</p>
<h4>How Custom Intervals Work (Technical Details)</h4>
<p>When you set a custom interval (e.g., <code>Interval = 5</code>), the system uses a background task to read sensors independently of the main flow cycle.</p>
<p><strong>Background Task Behavior:</strong>
- Runs every 1 second checking if sensors need reading
- Minimal CPU overhead - only checks timestamps
- Low priority to not interfere with main flow
- Automatically starts when sensors are initialized</p>
<p><strong>Example Scenario:</strong>
```ini
[AutoTimer]
Interval = 5        ; Flow every 5 minutes (300 seconds)</p>
<p>[DS18B20]
Interval = 5        ; Read sensor every 5 seconds
```</p>
<p><strong>What happens:</strong>
1. Main flow runs every 300 seconds
2. Background task wakes up every 1 second
3. Checks if 5 seconds elapsed since last sensor read
4. If yes, reads sensor and publishes to MQTT/InfluxDB
5. Result: ~60 sensor readings per flow cycle</p>
<p><strong>Performance Impact:</strong>
- CPU: Minimal (task mostly sleeps)
- Memory: 4KB for background task stack
- Sensor read time: ~800ms per DS18B20 (unchanged)</p>
<h4>Minimum Interval</h4>
<p>While technically you could set <code>Interval = 1</code> (every second), this is <strong>not recommended</strong>:
- Unnecessary wear on sensor
- Floods MQTT broker
- Fills InfluxDB quickly
- No benefit (environment doesn't change that fast)</p>
<p><strong>Minimum recommended</strong>: 30 seconds for debugging, 60 seconds for monitoring</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">DS18B20 Enable</a> - Enable the sensor</li>
<li><a target=_blank href="MQTT_Enable.md">DS18B20 MQTT Enable</a> - Publish to MQTT</li>
<li><a target=_blank href="MQTT_Topic.md">DS18B20 MQTT Topic</a> - MQTT topic configuration</li>
<li><a target=_blank href="InfluxDB_Enable.md">DS18B20 InfluxDB Enable</a> - Log to InfluxDB</li>
<li><a target=_blank href="InfluxDB_Measurement.md">DS18B20 InfluxDB Measurement</a> - InfluxDB measurement name</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/GPIO/OneWire.md">GPIO OneWire</a> - GPIO pin configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/AutoTimer/Interval.md">AutoTimer Interval</a> - Main flow cycle</li>
</ul>
<h4>Troubleshooting</h4>
<p><strong>Readings not updating:</strong>
1. Check sensor is enabled
2. Verify interval is not too long (e.g., 86400 = once per day)
3. Look in device logs for read errors
4. Confirm GPIO pin is configured for 1-Wire mode
5. Verify MQTT/InfluxDB is configured if expecting data</p>
<p><strong>Too much data:</strong>
- Increase interval to reduce volume
- Adjust InfluxDB retention policy
- Use downsampling in Grafana</p>
<p><strong>Missed critical events:</strong>
- Decrease interval for faster response
- Use Home Assistant automation with state change triggers
- Consider multiple intervals (frequent for alerts, slow for trending)</p>
<p><strong>Slow reads with multiple sensors:</strong>
- Each sensor takes ~800ms to read
- 3 sensors = ~2.4 seconds per cycle
- This is normal and acceptable for typical intervals (&gt;= 60 seconds)</p>
    </span></div></div>
</td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">Enable MQTT</td>
            <td>
                <input type="checkbox" id="DS18B20_MQTT_Enable_value1" checked>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 MQTT Enable</h3>
<p>Enable or disable MQTT publishing for DS18B20 temperature sensor readings.</p>
<h4>Value</h4>
<ul>
<li><code>true</code> - Enable MQTT publishing (default)</li>
<li><code>false</code> - Disable MQTT publishing</li>
</ul>
<h4>Description</h4>
<p>When enabled, temperature readings from all DS18B20 sensors on the 1-Wire bus are published to MQTT broker. Each sensor publishes to a unique topic that includes its ROM ID.</p>
<h4>MQTT Topics</h4>
<h5>Single Sensor</h5>
<p><code>{MQTT_Topic}/{ROM_ID} → temperature_value</code></p>
<p>Example:
<code>enclosure/temperature/28-0123456789AB → 24.5</code></p>
<h5>Multiple Sensors (Chainable)</h5>
<p>Each sensor publishes to its own topic with ROM ID:</p>
<p><code>enclosure/temperature/28-0123456789AB → 24.5  (Sensor #1)
enclosure/temperature/28-FEDCBA987654 → 15.2  (Sensor #2)
enclosure/temperature/28-AABBCCDD1122 → 12.8  (Sensor #3)</code></p>
<p>The ROM ID uniquely identifies each physical sensor, allowing you to:
- Track specific sensor locations
- Maintain sensor identity even if bus order changes
- Configure per-sensor automations</p>
<h4>Message Format</h4>
<p><strong>Topic</strong>: <code>{base_topic}/{ROM_ID}</code>
<strong>Payload</strong>: Temperature value as string (e.g., "24.5")
<strong>Retained</strong>: Yes (last value persists)
<strong>QoS</strong>: 1 (at least once delivery)</p>
<h4>Home Assistant Integration</h4>
<h5>Auto-Discovery (Manual Setup Required)</h5>
<p>DS18B20 sensors require manual configuration in Home Assistant:</p>
<p>```yaml</p>
<h3 style="margin: 0">configuration.yaml</h3>
<p>mqtt:
  sensor:
    - name: "Enclosure Inside Temperature"
      state_topic: "enclosure/temperature/28-0123456789AB"
      unit_of_measurement: "°C"
      device_class: temperature
      state_class: measurement</p>
<pre><code>- name: "Enclosure Outside Temperature"
  state_topic: "enclosure/temperature/28-FEDCBA987654"
  unit_of_measurement: "°C"
  device_class: temperature
  state_class: measurement

- name: "Pipe Temperature"
  state_topic: "enclosure/temperature/28-AABBCCDD1122"
  unit_of_measurement: "°C"
  device_class: temperature
  state_class: measurement
</code></pre>
<p>```</p>
<h5>Finding ROM IDs</h5>
<p>Check device Info page or logs during initialization:
<code>[INFO] DS18B20: Sensor #1: 28-0123456789AB
[INFO] DS18B20: Sensor #2: 28-FEDCBA987654
[INFO] DS18B20: Sensor #3: 28-AABBCCDD1122</code></p>
<p>Or use MQTT Explorer to see published topics.</p>
<h4>Use Cases</h4>
<h5>Device Health Monitoring</h5>
<p><code>ini
[DS18B20]
Enable = true
Interval = 300       ; Every 5 minutes
MQTT_Enable = true
MQTT_Topic = watermeter/enclosure/temperature</code></p>
<p>Home Assistant automation:
<code>yaml
automation:
  - alias: "Watermeter Overheat Alert"
    trigger:
      platform: numeric_state
      entity_id: sensor.enclosure_inside_temperature
      above: 65
      for: "00:10:00"
    action:
      - service: notify.mobile_app
        data:
          message: "⚠️ Watermeter overheating: {{ states('sensor.enclosure_inside_temperature') }}°C"</code></p>
<h5>Multi-Point Comparison</h5>
<p><code>yaml
automation:
  - alias: "Temperature Gradient Warning"
    trigger:
      platform: template
      value_template: &gt;
        {{ (states('sensor.enclosure_inside_temperature') | float - 
            states('sensor.enclosure_outside_temperature') | float) &gt; 25 }}
    action:
      - service: notify.mobile_app
        data:
          message: "High temperature gradient detected - check ventilation"</code></p>
<h5>Freeze Protection</h5>
<p><code>yaml
automation:
  - alias: "Pipe Freeze Alert"
    trigger:
      platform: numeric_state
      entity_id: sensor.pipe_temperature
      below: 2
      for: "00:05:00"
    action:
      - service: switch.turn_on
        target:
          entity_id: switch.pipe_heater
      - service: notify.mobile_app
        data:
          message: "Pipe heater activated - temperature: {{ states('sensor.pipe_temperature') }}°C"</code></p>
<h4>When to Disable</h4>
<p>Disable MQTT publishing if:
- <strong>InfluxDB only</strong>: You only use InfluxDB for logging
- <strong>MQTT not configured</strong>: No MQTT broker available
- <strong>Reduce traffic</strong>: Minimize network activity (use InfluxDB instead)
- <strong>Local only</strong>: Device monitoring via web interface only</p>
<p>You can use:
- MQTT only: Quick alerts, real-time Home Assistant integration
- InfluxDB only: Historical analysis, Grafana dashboards
- Both: Full monitoring stack (alerts + history)</p>
<h4>MQTT Broker Requirements</h4>
<p><strong>Minimum:</strong>
- MQTT broker accessible on network
- Credentials configured in MQTT settings
- QoS 1 support</p>
<p><strong>Recommended:</strong>
- Retained message support for last value persistence
- Sufficient message throughput for your interval</p>
<p><strong>Example Brokers:</strong>
- Mosquitto (local or remote)
- Home Assistant's built-in MQTT broker
- CloudMQTT / HiveMQ Cloud
- AWS IoT Core / Azure IoT Hub</p>
<h4>Performance Impact</h4>
<p><strong>Minimal:</strong>
- Message size: ~10-20 bytes per sensor
- Frequency: Once per interval (e.g., every 10 minutes)
- Network: &lt;1 KB/hour for 3 sensors at 10-min intervals</p>
<p>Even with multiple sensors and short intervals, MQTT overhead is negligible.</p>
<h4>Troubleshooting</h4>
<p><strong>Messages not appearing:</strong>
1. Verify MQTT broker is configured and connected
2. Check MQTT enable checkbox in main MQTT settings
3. Look for MQTT errors in device logs
4. Use MQTT Explorer to monitor broker
5. Verify DS18B20 is enabled and reading successfully</p>
<p><strong>Wrong topic structure:</strong>
- Expected: <code>topic/ROM_ID</code>
- Check MQTT_Topic setting
- Verify sensors were discovered (check logs for ROM IDs)</p>
<p><strong>Values not updating:</strong>
- Check Interval setting (not too long)
- Verify sensor read errors in logs
- Confirm MQTT connection is stable</p>
<p><strong>Home Assistant not showing sensors:</strong>
- Manual configuration required (no auto-discovery yet)
- Check ROM IDs match configuration
- Reload MQTT integration after config changes
- Verify topic subscription</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">DS18B20 Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">DS18B20 Interval</a> - Reading interval</li>
<li><a target=_blank href="MQTT_Topic.md">DS18B20 MQTT Topic</a> - Base MQTT topic</li>
<li><a target=_blank href="InfluxDB_Enable.md">DS18B20 InfluxDB Enable</a> - Alternative data logging</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/Enable.md">MQTT Enable</a> - Global MQTT configuration</li>
</ul>
<h4>Example Complete Configuration</h4>
<p>```ini
[MQTT]
Enable = true
Uri = mqtt://192.168.1.100
User = mqtt_user
Password = mqtt_pass
MainTopic = watermeter</p>
<p>[GPIO]
IO3 = onewire               ; * Requires disabling USB logging</p>
<p>[DS18B20]
Enable = true
Interval = -1
MQTT_Enable = true
MQTT_Topic = enclosure/temperature
InfluxDB_Enable = false
```</p>
<p>Results in topics:
- <code>watermeter/enclosure/temperature/28-0123456789AB</code>
- <code>watermeter/enclosure/temperature/28-FEDCBA987654</code>
- etc.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">MQTT Topic</td>
            <td>
                <input type="text" id="DS18B20_MQTT_Topic_value1" value="sensors/temperature">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 MQTT Topic</h3>
<p>Set the base MQTT topic for publishing DS18B20 temperature readings.</p>
<h4>Value</h4>
<p>Default: <code>enclosure/temperature</code></p>
<p>String value representing the base topic path. Each sensor's ROM ID is appended to create unique topics.</p>
<h4>Description</h4>
<p>The MQTT topic defines where temperature readings are published. For multiple DS18B20 sensors, each sensor publishes to a unique subtopic using its ROM ID.</p>
<h4>Topic Structure</h4>
<h5>Format</h5>
<p><code>{MainTopic}/{MQTT_Topic}/{ROM_ID}</code></p>
<p>Where:
- <code>MainTopic</code>: Global MQTT topic prefix (from MQTT settings)
- <code>MQTT_Topic</code>: This parameter (DS18B20 base topic)
- <code>ROM_ID</code>: Unique 64-bit ROM ID of each sensor (format: 28-XXXXXXXXXXXX)</p>
<h5>Examples</h5>
<p><strong>Single Sensor:</strong>
```ini
[MQTT]
MainTopic = watermeter</p>
<p>[DS18B20]
MQTT_Topic = enclosure/temperature
```</p>
<p>Publishes to:
<code>watermeter/enclosure/temperature/28-0123456789AB</code></p>
<p><strong>Multiple Sensors (3 sensors):</strong>
<code>watermeter/enclosure/temperature/28-0123456789AB → 24.5  (Inside)
watermeter/enclosure/temperature/28-FEDCBA987654 → 15.2  (Outside)
watermeter/enclosure/temperature/28-AABBCCDD1122 → 12.8  (Pipe)</code></p>
<h4>Topic Naming Conventions</h4>
<h5>Recommended Patterns</h5>
<p><strong>By Location:</strong>
<code>enclosure/temperature
outdoor/temperature
basement/temperature
garage/temperature</code></p>
<p><strong>By Purpose:</strong>
<code>sensors/temperature
environment/temperature
monitoring/temperature</code></p>
<p><strong>By Device:</strong>
<code>watermeter/temperature
gasmeter/temperature
device/temperature</code></p>
<h5>Hierarchical Topics</h5>
<p>Use hierarchy for organization:</p>
<p><strong>Option 1: By Location Hierarchy</strong>
<code>home/basement/watermeter/temperature
home/garage/gasmeter/temperature</code></p>
<p><strong>Option 2: By System Hierarchy</strong>
<code>monitoring/watermeter/enclosure/temperature
monitoring/watermeter/pipe/temperature</code></p>
<p><strong>Option 3: By Sensor Type</strong>
<code>sensors/temperature/enclosure
sensors/temperature/outdoor
sensors/humidity/enclosure</code></p>
<h4>Home Assistant Integration</h4>
<h5>Sensor Configuration</h5>
<p>Match your topic in Home Assistant:</p>
<p>```yaml
mqtt:
  sensor:
    - name: "Watermeter Enclosure Inside"
      state_topic: "watermeter/enclosure/temperature/28-0123456789AB"
      unit_of_measurement: "°C"
      device_class: temperature</p>
<pre><code>- name: "Watermeter Enclosure Outside"
  state_topic: "watermeter/enclosure/temperature/28-FEDCBA987654"
  unit_of_measurement: "°C"
  device_class: temperature

- name: "Watermeter Pipe"
  state_topic: "watermeter/enclosure/temperature/28-AABBCCDD1122"
  unit_of_measurement: "°C"
  device_class: temperature
</code></pre>
<p>```</p>
<h5>Topic Wildcards</h5>
<p>You can use MQTT wildcards for monitoring:</p>
<p><strong>Subscribe to all sensors:</strong>
<code>watermeter/enclosure/temperature/#</code></p>
<p><strong>Subscribe to all temperature topics:</strong>
<code>watermeter/+/temperature/#</code></p>
<h4>Best Practices</h4>
<h5>DO:</h5>
<ul>
<li>✅ Use descriptive names (e.g., <code>enclosure/temperature</code> not <code>temp1</code>)</li>
<li>✅ Use lowercase for consistency</li>
<li>✅ Use forward slashes for hierarchy</li>
<li>✅ Keep topics reasonably short</li>
<li>✅ Group related sensors under common parent</li>
</ul>
<h5>DON'T:</h5>
<ul>
<li>❌ Use spaces (use underscores or hyphens)</li>
<li>❌ Use special characters (stick to alphanumeric, <code>-</code>, <code>_</code>, <code>/</code>)</li>
<li>❌ Make overly deep hierarchies (3-4 levels is enough)</li>
<li>❌ Use leading or trailing slashes</li>
<li>❌ Include ROM IDs in base topic (system adds them automatically)</li>
</ul>
<h4>Multiple Device Installations</h4>
<p>If you have multiple devices (multiple water meters), use device-specific topics:</p>
<p><strong>Device 1: Main Watermeter</strong>
```ini
[MQTT]
MainTopic = home/watermeter1</p>
<p>[DS18B20]
MQTT_Topic = enclosure/temperature
```</p>
<p><strong>Device 2: Secondary Watermeter</strong>
```ini
[MQTT]
MainTopic = home/watermeter2</p>
<p>[DS18B20]
MQTT_Topic = enclosure/temperature
```</p>
<p>Results in:
<code>home/watermeter1/enclosure/temperature/28-XXXX → 24.5
home/watermeter2/enclosure/temperature/28-YYYY → 22.1</code></p>
<h4>Topic Organization Examples</h4>
<h5>Example 1: Simple Installation</h5>
<p><strong>One device, multiple sensors in same enclosure</strong></p>
<p><code>ini
[DS18B20]
MQTT_Topic = temperature</code></p>
<p>Topics:
<code>watermeter/temperature/28-0123456789AB
watermeter/temperature/28-FEDCBA987654</code></p>
<h5>Example 2: Detailed Location Tracking</h5>
<p><strong>Multiple measurement points</strong></p>
<p>Use descriptive topics if you want to emphasize location:</p>
<p>```ini</p>
<h3 style="margin: 0">For sensors you can identify by physical location</h3>
<p>MQTT_Topic = sensors/temperature
```</p>
<p>Then in Home Assistant, name each sensor by its location:
```yaml
- name: "Enclosure Inside Temp"
  state_topic: "watermeter/sensors/temperature/28-0123456789AB"</p>
<ul>
<li>
<p>name: "Enclosure Outside Temp"
  state_topic: "watermeter/sensors/temperature/28-FEDCBA987654"</p>
</li>
<li>
<p>name: "Inlet Pipe Temp"
  state_topic: "watermeter/sensors/temperature/28-AABBCCDD1122"
```</p>
</li>
</ul>
<h5>Example 3: Multi-Sensor System</h5>
<p><strong>Both DS18B20 and SHT3x sensors</strong></p>
<p>```ini
[SHT3x]
MQTT_Topic = climate</p>
<p>[DS18B20]
MQTT_Topic = temperature
```</p>
<p>Clear separation:
<code>watermeter/climate/temperature → 24.5°C (from SHT3x)
watermeter/climate/humidity → 45%
watermeter/temperature/28-0123456789AB → 24.3°C (from DS18B20 #1)
watermeter/temperature/28-FEDCBA987654 → 15.2°C (from DS18B20 #2)</code></p>
<h4>Finding ROM IDs</h4>
<p>To configure Home Assistant, you need to know each sensor's ROM ID.</p>
<p><strong>Method 1: Check Device Logs</strong>
Look for startup messages:
<code>[INFO] DS18B20: Sensor #1: 28-0123456789AB
[INFO] DS18B20: Sensor #2: 28-FEDCBA987654
[INFO] DS18B20: Sensor #3: 28-AABBCCDD1122</code></p>
<p><strong>Method 2: Use MQTT Explorer</strong>
- Connect to your MQTT broker
- Browse to your base topic
- See all published subtopics with ROM IDs</p>
<p><strong>Method 3: Check Info Page</strong>
The device Info page shows discovered sensors with ROM addresses.</p>
<h4>Changing Topics</h4>
<p><strong>Important</strong>: If you change MQTT_Topic:
1. Update Home Assistant sensor configurations
2. Old topics will no longer receive updates
3. Consider using retained messages so last value persists</p>
<p><strong>Migration Strategy:</strong>
1. Note old topic names and ROM IDs
2. Change MQTT_Topic in config
3. Update Home Assistant configuration.yaml
4. Reload MQTT integration
5. Verify new topics are working
6. Remove old topics from broker if needed</p>
<h4>Performance Impact</h4>
<p>MQTT topic length has minimal impact:
- <code>temperature</code> vs <code>enclosure/temperature/monitoring</code> - negligible difference
- Focus on clarity over brevity
- Typical message: topic + value = 50-100 bytes total</p>
<h4>Troubleshooting</h4>
<p><strong>Topics not appearing:</strong>
1. Verify MQTT_Enable is true
2. Check MQTT broker connection
3. Use MQTT Explorer to monitor broker
4. Look for errors in device logs</p>
<p><strong>Wrong topic structure:</strong>
- Verify you're setting base topic only (ROM ID is added automatically)
- Check for typos in topic name
- Ensure no leading/trailing slashes</p>
<p><strong>Home Assistant not finding sensors:</strong>
- ROM IDs in configuration must match actual sensor ROM IDs
- Check case sensitivity (topics are case-sensitive)
- Reload MQTT integration after changes</p>
<p><strong>Topics clashing with other devices:</strong>
- Use unique MainTopic for each device
- Or use unique MQTT_Topic per device
- Ensure devices don't share the same full topic path</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">DS18B20 Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">DS18B20 Interval</a> - Reading interval</li>
<li><a target=_blank href="MQTT_Enable.md">DS18B20 MQTT Enable</a> - Enable MQTT publishing</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/MainTopic.md">MQTT MainTopic</a> - Global topic prefix</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/MQTT/Enable.md">MQTT Enable</a> - Global MQTT configuration</li>
</ul>
<h4>Example Complete Configuration</h4>
<p>```ini
[MQTT]
Enable = true
Uri = mqtt://192.168.1.100
User = mqtt_user
Password = mqtt_pass
MainTopic = home/watermeter
ClientName = watermeter-device</p>
<p>[GPIO]
IO3 = onewire               ; * Requires disabling USB logging</p>
<p>[DS18B20]
Enable = true
Interval = 300
MQTT_Enable = true
MQTT_Topic = enclosure/temperature
```</p>
<p>Resulting topics:
<code>home/watermeter/enclosure/temperature/28-0123456789AB → 24.5
home/watermeter/enclosure/temperature/28-FEDCBA987654 → 15.2
home/watermeter/enclosure/temperature/28-AABBCCDD1122 → 12.8</code></p>
    </span></div></div>
</td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">Enable InfluxDB</td>
            <td>
                <input type="checkbox" id="DS18B20_InfluxDB_Enable_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 InfluxDB Enable</h3>
<p>Enable or disable InfluxDB logging for DS18B20 temperature sensor readings.</p>
<h4>Value</h4>
<ul>
<li><code>true</code> - Enable InfluxDB logging</li>
<li><code>false</code> - Disable InfluxDB logging (default)</li>
</ul>
<h4>Description</h4>
<p>When enabled, temperature readings from all DS18B20 sensors are written to InfluxDB for historical tracking and analysis. Each sensor creates a unique field with its ROM ID included in the field name.</p>
<h4>InfluxDB Field Structure</h4>
<h5>Measurement</h5>
<p>Configured via <a target=_blank href="InfluxDB_Measurement.md">InfluxDB_Measurement</a> parameter (default: <code>environment</code>)</p>
<h5>Fields</h5>
<p>Each sensor creates a field named: <code>temperature_{ROM_ID}</code></p>
<p><strong>Single Sensor:</strong>
<code>Measurement: environment
Field: temperature_28-0123456789AB
Value: 24.5</code></p>
<p><strong>Multiple Sensors (3 sensors):</strong>
<code>Measurement: environment
Fields:
  - temperature_28-0123456789AB: 24.5  (Inside)
  - temperature_28-FEDCBA987654: 15.2  (Outside)
  - temperature_28-AABBCCDD1122: 12.8  (Pipe)</code></p>
<p>ROM IDs ensure each sensor's data is uniquely identified even if sensors are added/removed.</p>
<h4>Use Cases</h4>
<h5>Long-Term Trending</h5>
<p>Track temperature patterns over days, weeks, months:</p>
<p><code>ini
[DS18B20]
Enable = true
Interval = 600        ; Every 10 minutes
InfluxDB_Enable = true
InfluxDB_Measurement = environment</code></p>
<p>Grafana query:
<code>sql
SELECT 
  mean("temperature_28-0123456789AB") as "Inside",
  mean("temperature_28-FEDCBA987654") as "Outside"
FROM "environment" 
WHERE time &gt; now() - 30d 
GROUP BY time(1h)</code></p>
<p>Reveals: Daily cycles, seasonal trends, anomalies</p>
<h5>Capacity Planning</h5>
<p>Understand when heating/cooling is needed:</p>
<p><code>sql
SELECT 
  max("temperature_28-0123456789AB") as "Peak",
  min("temperature_28-0123456789AB") as "Low"
FROM "environment" 
WHERE time &gt; now() - 7d 
GROUP BY time(1d)</code></p>
<p>Helps plan: Heater scheduling, insulation upgrades</p>
<h5>Multi-Point Correlation</h5>
<p>Compare temperatures across locations:</p>
<p><code>sql
SELECT 
  mean("temperature_28-0123456789AB") - mean("temperature_28-FEDCBA987654") as "Gradient"
FROM "environment" 
WHERE time &gt; now() - 24h 
GROUP BY time(1h)</code></p>
<p>Reveals: Heat loss, insulation effectiveness</p>
<h5>Root Cause Analysis</h5>
<p>When issues occur, look back at environmental conditions:</p>
<p><code>sql
SELECT 
  "temperature_28-0123456789AB",
  "temperature_28-FEDCBA987654"
FROM "environment" 
WHERE time &gt;= '2024-01-15T14:00:00Z' 
  AND time &lt;= '2024-01-15T15:00:00Z'</code></p>
<p>Correlate with: Device failures, reading errors, anomalies</p>
<h4>InfluxDB vs MQTT</h4>
<p>| Feature | InfluxDB | MQTT |
|---------|----------|------|
| <strong>Purpose</strong> | Historical storage | Real-time alerts |
| <strong>Retention</strong> | Configurable (days to years) | Last value only (retained) |
| <strong>Query</strong> | Powerful SQL-like queries | Simple subscribe |
| <strong>Visualization</strong> | Grafana dashboards | Home Assistant cards |
| <strong>Alerting</strong> | Kapacitor, Grafana | Home Assistant automation |
| <strong>Storage</strong> | Database on disk | In-memory + retained |
| <strong>Best For</strong> | Trending, analysis | Immediate response |</p>
<h5>Recommended Combinations</h5>
<p><strong>Option 1: Both Enabled (Full Stack)</strong>
<code>ini
MQTT_Enable = true
InfluxDB_Enable = true</code>
- Real-time alerts via MQTT → Home Assistant
- Historical analysis via InfluxDB → Grafana
- Best for: Production monitoring</p>
<p><strong>Option 2: InfluxDB Only</strong>
<code>ini
MQTT_Enable = false
InfluxDB_Enable = true</code>
- Focused on data analysis
- Reduced network traffic
- Best for: Data logging, trending</p>
<p><strong>Option 3: MQTT Only</strong>
<code>ini
MQTT_Enable = true
InfluxDB_Enable = false</code>
- Real-time monitoring only
- Minimal storage requirements
- Best for: Simple alert systems</p>
<h4>Grafana Dashboards</h4>
<h5>Basic Temperature Panel</h5>
<p><code>json
{
  "targets": [
    {
      "query": "SELECT mean(\"temperature_28-0123456789AB\") FROM \"environment\" WHERE $timeFilter GROUP BY time($__interval)",
      "alias": "Enclosure Inside"
    },
    {
      "query": "SELECT mean(\"temperature_28-FEDCBA987654\") FROM \"environment\" WHERE $timeFilter GROUP BY time($__interval)",
      "alias": "Enclosure Outside"
    }
  ]
}</code></p>
<h5>Temperature Gradient</h5>
<p><code>json
{
  "targets": [
    {
      "query": "SELECT mean(\"temperature_28-0123456789AB\") - mean(\"temperature_28-FEDCBA987654\") FROM \"environment\" WHERE $timeFilter GROUP BY time($__interval)",
      "alias": "Inside - Outside Gradient"
    }
  ]
}</code></p>
<h5>Daily Min/Max</h5>
<p><code>json
{
  "targets": [
    {
      "query": "SELECT max(\"temperature_28-0123456789AB\") as \"Peak\", min(\"temperature_28-0123456789AB\") as \"Low\" FROM \"environment\" WHERE $timeFilter GROUP BY time(1d)",
      "alias": "Daily Range"
    }
  ]
}</code></p>
<h4>Performance Considerations</h4>
<h5>Write Frequency</h5>
<p>Based on your interval:
- Interval = 60s: 1,440 points/day per sensor
- Interval = 300s: 288 points/day per sensor
- Interval = 600s: 144 points/day per sensor</p>
<h5>Storage Requirements</h5>
<p>Approximate storage per sensor:
- 1 point ≈ 100-150 bytes (compressed)
- 1 day at 5-min intervals: 288 points ≈ 35 KB
- 1 month: ~1 MB per sensor
- 1 year: ~12 MB per sensor</p>
<p>With 3 sensors: ~36 MB/year (very manageable)</p>
<h5>Retention Policies</h5>
<p>Configure in InfluxDB to manage storage:</p>
<p><code>sql
CREATE RETENTION POLICY "one_week" ON "mydb" DURATION 7d REPLICATION 1
CREATE RETENTION POLICY "one_month" ON "mydb" DURATION 30d REPLICATION 1
CREATE RETENTION POLICY "one_year" ON "mydb" DURATION 365d REPLICATION 1</code></p>
<h5>Downsampling</h5>
<p>Create continuous queries for long-term data:</p>
<p><code>sql
CREATE CONTINUOUS QUERY "cq_temperature_1h" ON "mydb"
BEGIN
  SELECT mean("temperature_28-0123456789AB") as "temperature_28-0123456789AB"
  INTO "one_year"."environment"
  FROM "environment"
  GROUP BY time(1h)
END</code></p>
<p>Keeps: Hourly averages forever, raw data for 30 days</p>
<h4>When to Enable</h4>
<p><strong>Enable InfluxDB if:</strong>
- ✅ You want historical trend analysis
- ✅ You use Grafana dashboards
- ✅ You need long-term data retention
- ✅ You want to correlate with other metrics
- ✅ You need advanced queries and analytics</p>
<p><strong>Disable InfluxDB if:</strong>
- ❌ You only need real-time alerts (use MQTT)
- ❌ InfluxDB not configured on network
- ❌ Limited storage available
- ❌ Temporary testing/debugging only</p>
<h4>InfluxDB Configuration Requirements</h4>
<p><strong>Prerequisites:</strong>
1. InfluxDB server installed and running
2. Database created
3. InfluxDB section configured in device settings:
   - Uri
   - Database name
   - Credentials (if required)</p>
<p><strong>Minimum InfluxDB Config:</strong>
<code>ini
[InfluxDB]
Enable = true
Uri = http://192.168.1.100:8086
Database = homeautomation
User = influx_user
Password = influx_pass</code></p>
<h4>Data Quality</h4>
<h5>Accurate Timestamps</h5>
<p>InfluxDB stores precise timestamps for each reading, enabling:
- Exact time correlation
- Sub-second precision
- Time-based queries</p>
<h5>Missing Data Handling</h5>
<p>If sensor read fails:
- No data point written (better than writing error values)
- Grafana shows gap in graph
- Can detect sensor failures by missing data</p>
<h4>Querying Examples</h4>
<h5>Current Temperature</h5>
<p><code>sql
SELECT last("temperature_28-0123456789AB") 
FROM "environment"</code></p>
<h5>Average Over Time</h5>
<p><code>sql
SELECT mean("temperature_28-0123456789AB") 
FROM "environment" 
WHERE time &gt; now() - 24h</code></p>
<h5>Temperature Range</h5>
<p><code>sql
SELECT 
  max("temperature_28-0123456789AB") as "Max",
  min("temperature_28-0123456789AB") as "Min",
  max("temperature_28-0123456789AB") - min("temperature_28-0123456789AB") as "Range"
FROM "environment" 
WHERE time &gt; now() - 7d</code></p>
<h5>Hourly Averages</h5>
<p><code>sql
SELECT mean("temperature_28-0123456789AB") 
FROM "environment" 
WHERE time &gt; now() - 7d 
GROUP BY time(1h)</code></p>
<h5>Multiple Sensors</h5>
<p><code>sql
SELECT 
  mean("temperature_28-0123456789AB") as "Inside",
  mean("temperature_28-FEDCBA987654") as "Outside",
  mean("temperature_28-AABBCCDD1122") as "Pipe"
FROM "environment" 
WHERE time &gt; now() - 30d 
GROUP BY time(1d)</code></p>
<h4>Troubleshooting</h4>
<p><strong>Data not appearing in InfluxDB:</strong>
1. Verify InfluxDB is enabled globally
2. Check InfluxDB connection in device logs
3. Verify database exists
4. Check credentials
5. Confirm DS18B20 sensors are reading successfully
6. Use InfluxDB CLI to check for data:
   <code>USE homeautomation
   SELECT * FROM environment ORDER BY time DESC LIMIT 10</code></p>
<p><strong>Old data but no recent data:</strong>
- Check if device is reading sensors (look at logs)
- Verify interval isn't too long
- Check InfluxDB connection status</p>
<p><strong>Missing some sensors:</strong>
- Check that all sensors are discovered (ROM search at startup)
- Verify all sensors read successfully
- Look for errors in device logs</p>
<p><strong>Too much data:</strong>
- Increase read interval
- Set up retention policies
- Use downsampling with continuous queries</p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">DS18B20 Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">DS18B20 Interval</a> - Reading interval (affects write frequency)</li>
<li><a target=_blank href="InfluxDB_Measurement.md">DS18B20 InfluxDB Measurement</a> - Measurement name</li>
<li><a target=_blank href="MQTT_Enable.md">DS18B20 MQTT Enable</a> - Alternative data publishing</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Enable.md">InfluxDB Enable</a> - Global InfluxDB configuration</li>
</ul>
<h4>Example Complete Configuration</h4>
<p>```ini
[InfluxDB]
Enable = true
Uri = http://192.168.1.100:8086
Database = homeautomation
User = influx_user
Password = influx_pass</p>
<p>[GPIO]
IO3 = onewire               ; * Requires disabling USB logging</p>
<p>[DS18B20]
Enable = true
Interval = 300        ; Every 5 minutes
MQTT_Enable = true    ; For alerts
InfluxDB_Enable = true
InfluxDB_Measurement = environment
```</p>
<p><strong>Result:</strong>
- Real-time alerts via MQTT
- Long-term trending via InfluxDB
- Data written every 5 minutes
- Unique field per sensor: <code>temperature_{ROM_ID}</code></p>
    </span></div></div>
</td>
        </tr>

        <tr class="DS18B20Item">
            <td class="indent1">InfluxDB Measurement</td>
            <td>
                <input type="text" id="DS18B20_InfluxDB_Measurement_value1" value="environment">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">DS18B20 InfluxDB Measurement</h3>
<p>Set the InfluxDB measurement name for DS18B20 temperature sensor data.</p>
<h4>Value</h4>
<p>Default: <code>environment</code></p>
<p>String value representing the InfluxDB measurement name where sensor data is stored.</p>
<h4>Description</h4>
<p>In InfluxDB, a <strong>measurement</strong> is analogous to a database table. All DS18B20 sensor readings are written to this measurement, with each sensor creating a unique field identified by its ROM ID.</p>
<h4>Measurement Structure</h4>
<h5>Format</h5>
<p><code>Measurement: {InfluxDB_Measurement}
Field: temperature_{ROM_ID}
Value: {temperature}
Timestamp: {read_time}</code></p>
<h5>Example with Single Sensor</h5>
<p><code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Field: temperature_28-0123456789AB = 24.5</code></p>
<h5>Example with Multiple Sensors</h5>
<p><code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  temperature_28-0123456789AB = 24.5  (Inside)
  temperature_28-FEDCBA987654 = 15.2  (Outside)
  temperature_28-AABBCCDD1122 = 12.8  (Pipe)</code></p>
<h4>Naming Conventions</h4>
<h5>Recommended Measurement Names</h5>
<p><strong>By Data Category:</strong>
<code>environment      - Environmental monitoring (recommended)
sensors          - Generic sensor data
temperature      - Temperature-specific data
monitoring       - General monitoring data
device_health    - Device health metrics</code></p>
<p><strong>By Location:</strong>
<code>enclosure_env    - Enclosure environmental data
outdoor_env      - Outdoor environmental data
basement_sensors - Basement sensor readings</code></p>
<p><strong>By System:</strong>
<code>watermeter_env   - Watermeter environmental data
gasmeter_env     - Gas meter environmental data</code></p>
<h5>Best Practices</h5>
<p><strong>DO:</strong>
- ✅ Use lowercase names
- ✅ Use underscores for word separation
- ✅ Keep names descriptive but concise
- ✅ Use consistent naming across devices
- ✅ Group related sensors in same measurement</p>
<p><strong>DON'T:</strong>
- ❌ Use spaces (breaks queries)
- ❌ Use special characters except underscore
- ❌ Use overly long names
- ❌ Mix unrelated data in same measurement
- ❌ Include ROM IDs in measurement name (they're in field names)</p>
<h4>Sharing Measurements</h4>
<h5>Multiple Sensor Types in One Measurement</h5>
<p>You can store multiple sensor types together:</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = environment</p>
<p>[DS18B20]
InfluxDB_Measurement = environment
```</p>
<p>Result in InfluxDB:
<code>Measurement: environment
Time: 2024-01-15T14:30:00Z
Fields:
  temperature = 24.5                      (from SHT3x)
  humidity = 45.2                         (from SHT3x)
  temperature_28-0123456789AB = 24.3      (from DS18B20 #1)
  temperature_28-FEDCBA987654 = 15.2      (from DS18B20 #2)</code></p>
<p><strong>Benefits:</strong>
- All environmental data in one place
- Easy to query together
- Correlate different sensor types</p>
<h5>Separate Measurements per Sensor Type</h5>
<p>Or keep them separate:</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = climate</p>
<p>[DS18B20]
InfluxDB_Measurement = temperature
```</p>
<p><strong>Benefits:</strong>
- Clear separation
- Independent retention policies
- Easier to manage if one sensor type is temporary</p>
<h4>Grafana Queries</h4>
<h5>Query Single Measurement</h5>
<p><code>sql
SELECT 
  mean("temperature_28-0123456789AB") as "Inside",
  mean("temperature_28-FEDCBA987654") as "Outside"
FROM "environment"
WHERE $timeFilter
GROUP BY time($__interval)</code></p>
<h5>Query Multiple Measurements</h5>
<p><code>sql
SELECT 
  mean("temperature") as "SHT3x",
  mean("temperature_28-0123456789AB") as "DS18B20"
FROM "climate", "temperature"
WHERE $timeFilter
GROUP BY time($__interval)</code></p>
<h5>All Fields in Measurement</h5>
<p><code>sql
SHOW FIELD KEYS FROM "environment"</code></p>
<p>Returns:
<code>temperature
humidity
temperature_28-0123456789AB
temperature_28-FEDCBA987654
temperature_28-AABBCCDD1122</code></p>
<h4>Use Cases</h4>
<h5>Case 1: Unified Environmental Monitoring</h5>
<p><strong>Goal:</strong> All environmental data together</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = environment</p>
<p>[DS18B20]
InfluxDB_Measurement = environment
```</p>
<p>Grafana dashboard shows:
- Inside temperature (SHT3x)
- Inside humidity (SHT3x)
- Outside temperature (DS18B20)
- Pipe temperature (DS18B20)</p>
<p>All correlated by timestamp.</p>
<h5>Case 2: Separate Temperature Measurements</h5>
<p><strong>Goal:</strong> Different retention for different sensors</p>
<p>```ini
[SHT3x]
InfluxDB_Measurement = climate_realtime</p>
<p>[DS18B20]
InfluxDB_Measurement = temperature_longterm
```</p>
<p>InfluxDB retention policies:
```sql
-- Keep realtime data for 7 days
CREATE RETENTION POLICY "realtime" ON "mydb" DURATION 7d REPLICATION 1</p>
<p>-- Keep long-term temperature for 2 years
CREATE RETENTION POLICY "longterm" ON "mydb" DURATION 730d REPLICATION 1
```</p>
<p>Different policies for different needs.</p>
<h5>Case 3: Multi-Device Installation</h5>
<p><strong>Goal:</strong> Multiple devices writing to same InfluxDB</p>
<p>```ini</p>
<h3 style="margin: 0">Device 1: Main watermeter</h3>
<p>[DS18B20]
InfluxDB_Measurement = watermeter1_environment</p>
<h3 style="margin: 0">Device 2: Secondary watermeter</h3>
<p>[DS18B20]
InfluxDB_Measurement = watermeter2_environment
```</p>
<p>Keeps data from different devices separate.</p>
<h4>Measurement Tags (Advanced)</h4>
<p>InfluxDB measurements can have tags for better organization. While the DS18B20 implementation doesn't currently add tags, you could enhance it to add:</p>
<p><strong>Potential future tags:</strong>
- <code>location</code>: inside/outside/pipe
- <code>device_id</code>: unique device identifier
- <code>sensor_type</code>: DS18B20</p>
<p>This would enable queries like:
<code>sql
SELECT mean("temperature_*")
FROM "environment"
WHERE "location" = 'outside'
AND $timeFilter</code></p>
<h4>Performance Considerations</h4>
<h5>Write Performance</h5>
<ul>
<li>Multiple sensors writing to same measurement: No performance impact</li>
<li>InfluxDB handles many fields efficiently</li>
<li>Typical write: &lt;1ms</li>
</ul>
<h5>Query Performance</h5>
<ul>
<li>Fewer measurements = Simpler queries</li>
<li>Many fields in one measurement: Still fast</li>
<li>Use appropriate time ranges and GROUP BY</li>
</ul>
<h5>Storage</h5>
<p>Measurement name has minimal storage impact:
- Short name: <code>env</code> = 3 bytes
- Long name: <code>watermeter_environment</code> = 23 bytes
- Difference per point: ~20 bytes
- Over 1 million points: ~20 MB difference</p>
<p>Use readable names; storage difference is negligible.</p>
<h4>Changing Measurements</h4>
<p><strong>Important:</strong> Changing the measurement name creates a NEW measurement. Old data remains in the old measurement.</p>
<p><strong>Migration Steps:</strong>
1. Note current measurement name
2. Update configuration with new name
3. Wait for data to accumulate in new measurement
4. Update Grafana queries to use new measurement
5. Optionally: Migrate old data or set up parallel queries</p>
<p><strong>Example Migration Query:</strong>
<code>sql
-- Copy data from old to new measurement
SELECT * INTO "new_environment" FROM "environment" WHERE time &gt; now() - 30d</code></p>
<h4>Troubleshooting</h4>
<p><strong>Data not appearing:</strong>
1. Verify InfluxDB is enabled and connected
2. Check measurement name doesn't have typos
3. Use InfluxDB CLI to check measurements:
   <code>SHOW MEASUREMENTS</code>
4. Query specific measurement:
   <code>SELECT * FROM "environment" ORDER BY time DESC LIMIT 10</code></p>
<p><strong>Can't find measurement in Grafana:</strong>
- Refresh Grafana datasource
- Check measurement name spelling
- Verify data has been written (check with CLI)
- Confirm correct database selected</p>
<p><strong>Wrong field structure:</strong>
- Each DS18B20 sensor should create <code>temperature_{ROM_ID}</code> field
- Check ROM IDs in device logs
- Verify sensors are reading successfully</p>
<p><strong>Measurement name conflicts:</strong>
- Ensure different devices use different measurements
- Or use tags to differentiate
- Check existing measurements: <code>SHOW MEASUREMENTS</code></p>
<h4>Related Parameters</h4>
<ul>
<li><a target=_blank href="Enable.md">DS18B20 Enable</a> - Enable the sensor</li>
<li><a target=_blank href="Interval.md">DS18B20 Interval</a> - Reading interval</li>
<li><a target=_blank href="InfluxDB_Enable.md">DS18B20 InfluxDB Enable</a> - Enable InfluxDB logging</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Enable.md">InfluxDB Enable</a> - Global InfluxDB configuration</li>
<li><a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/InfluxDB/Database.md">InfluxDB Database</a> - Database name</li>
</ul>
<h4>Example Complete Configuration</h4>
<h5>Simple Configuration</h5>
<p>```ini
[InfluxDB]
Enable = true
Uri = http://192.168.1.100:8086
Database = homeautomation</p>
<p>[DS18B20]
Enable = true
Interval = 300
InfluxDB_Enable = true
InfluxDB_Measurement = environment
```</p>
<h5>Advanced Multi-Sensor Configuration</h5>
<p>```ini
[InfluxDB]
Enable = true
Uri = http://192.168.1.100:8086
Database = homeautomation
User = influx_user
Password = influx_pass</p>
<p>[SHT3x]
Enable = true
Interval = -1
InfluxDB_Enable = true
InfluxDB_Measurement = environment</p>
<p>[DS18B20]
Enable = true
Interval = -1
InfluxDB_Enable = true
InfluxDB_Measurement = environment
```</p>
<p><strong>Result:</strong> All sensors write to <code>environment</code> measurement:
<code>Measurement: environment
Fields:
  - temperature (from SHT3x)
  - humidity (from SHT3x)
  - temperature_28-0123456789AB (from DS18B20 #1)
  - temperature_28-FEDCBA987654 (from DS18B20 #2)
  - temperature_28-AABBCCDD1122 (from DS18B20 #3)</code></p>
<p>Perfect for unified environmental monitoring dashboards!</p>
    </span></div></div>
</td>
        </tr>

        <!------------- GPIO ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;">
                <h4><input type="checkbox" id="Category_GPIO_enabled" value="1"  onclick='UpdateAfterCategoryCheck()' unchecked > 
                <label for=Category_GPIO_enabled>GPIO (General Purpose Input / Output)</label></h4>
            </td>
        </tr>

        <!------------- GPIO0 begin ------------------>
        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO0_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO0")' unchecked>
                <label for=GPIO_IO0_enabled><span id="GPIO_IO0_text">GPIO0 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO0_value1">
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO0</code></h3>
<p>Default Value: <code>input disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO0</code> pin.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This pin is only usable with restrictions!
It must be disabled when the camera is used.
Additionally, it is used to activate Bootloader mode and must therefore be HIGH after a reset!</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 0 state</code>: One of <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 0 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 0 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 0 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 0 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 0 name</code>: MQTT topic name (empty = <code>GPIO0</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent2">
                <span id="GPIO_IO0_text" class="GPIO_IO0 GPIO_item">GPIO0 Use Interrupt</span>
            </td>
            <td>
                <select id="GPIO_IO0_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge">rising edge</option>
                    <option value="falling-edge">falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>	
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO0 GPIO_item">GPIO0 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO0_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO0 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO0 GPIO_item">GPIO0 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO0_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO0 GPIO_item">GPIO0 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO0_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO0 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO0 GPIO_item">GPIO0 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO0_value6"></td>
            <td></td>
        </tr>
        <!------------- GPIO0 end ------------------>

        <!------------- GPIO1 begin ------------------>
        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO1_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO1")' unchecked>
                <label for=GPIO_IO1_enabled><span id="GPIO_IO1_text">GPIO1 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO1_value1">
                    <option value="disabled">disabled</option>
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                    <option value="i2c-sda">I²C SDA (SHT3x)</option>
                    <option value="i2c-scl">I²C SCL (SHT3x)</option>
                    <option value="onewire">1-Wire (DS18B20)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO1</code></h3>
<p>Default Value: <code>input disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO1</code> pin.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This pin is by default used for the serial communication as TX pin (USB logging)!</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 1 state</code>: One of <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 1 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 1 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 1 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 1 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 1 name</code>: MQTT topic name (empty = <code>GPIO1</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO1 GPIO_item" class="expert">GPIO1 Use Interrupt</span>
            </td>
            <td>
                <select id="GPIO_IO1_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge" disabled>rising edge</option>
                    <option value="falling-edge" disabled>falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO1 GPIO_item">GPIO1 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO1_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO1 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO1 GPIO_item">GPIO1 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO1_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO1 GPIO_item">GPIO1 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO1_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO1 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO1 GPIO_item" class="expert">GPIO1 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO1_value6"></td>
            <td></td>
        </tr>
        <!------------- GPIO1 end ------------------>

        <!------------- GPIO3 begin ------------------>
        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO3_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO3")' unchecked>
                <label for=GPIO_IO3_enabled><span id="GPIO_IO3_text">GPIO3 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO3_value1">
                    <option value="disabled">disabled</option>
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                    <option value="i2c-sda">I²C SDA (SHT3x)</option>
                    <option value="i2c-scl">I²C SCL (SHT3x)</option>
                    <option value="onewire">1-Wire (DS18B20)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO3</code></h3>
<p>Default Value: <code>input disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO3</code> pin.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This pin is by default used for the serial communication as RX pin (USB logging)!</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 3 state</code>: One of <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 3 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 3 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 3 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 3 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 3 name</code>: MQTT topic name (empty = <code>GPIO3</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO3 GPIO_item">GPIO3 Use Interrupt</span>
            </td>
            <td>
                <select id="GPIO_IO3_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge" disabled>rising edge</option>
                    <option value="falling-edge" disabled>falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO3 GPIO_item">GPIO3 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO3_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO3 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO3 GPIO_item">GPIO3 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO3_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO3 GPIO_item">GPIO3 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO3_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO3 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO3 GPIO_item">GPIO3 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO3_value6"></td>
            <td></td>
        </tr>
        <!------------- GPIO3 end ------------------>

        <!------------- GPIO4 begin ------------------>
        <tr class="GPIO_item" style="border-bottom: 0px;">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO4_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO4")' checked>
                <label for=GPIO_IO4_enabled><span id="GPIO_IO4_text">GPIO4 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO4_value1">
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                    <option value="built-in-led" select>built-in led flash light</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO4</code></h3>
<p>Default Value: <code>built-in-led disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO4</code> pin.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This pin is only usable with restrictions!
By default, it is used for build-in flash light (onboard LED).</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 4 state</code>: One of <code>built-in-led</code>, <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 4 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 4 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 4 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 4 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 4 name</code>: MQTT topic name (empty = <code>GPIO4</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_item" style="border-top: 0px;">
            <td colspan="2" style="padding-left:28px">
                <b>IMPORTANT NOTE:</b><br>
                If you'd like to use the built-in flash LED in parallel with other GPIO functionality,
                you have to explicitely activate the "built-in LED flash light" option on GPIO4. The light 
                intensity control (PWM) of the LED flash light is not functional anymore (only 100%).
            </td>
        </tr>

        <tr class="GPIO_IO4 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO4 GPIO_item">GPIO4 Use Interrupt</span>
            </td>
            <td>
                <select id="GPIO_IO4_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge">rising edge</option>
                    <option value="falling-edge">falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>	
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO4 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO4 GPIO_item">GPIO4 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO4_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO4 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO4 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO4 GPIO_item">GPIO4 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO4_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO4 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO4 GPIO_item">GPIO4 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO4_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO4 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO4 GPIO_item">GPIO4 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO4_value6"></td>
            <td></td>
        </tr>
        <!------------- GPIO4 end ------------------>

        <!------------- GPIO12 begin ------------------>
        <tr class="GPIO_item">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO12_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO12")' unchecked>
                <label for=GPIO_IO12_enabled><span id="GPIO_IO12_text">GPIO12 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO12_value1">
                    <option value="disabled">disabled</option>
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                    <!-- <option value="output-pwm">output-pwm</option> -->
                    <!-- <option value="external-flash-pwm">external-flash-pwm</option> -->				
                    <option value="external-flash-ws281x">external flash light ws281x controlled</option>
                    <!-- I2C and 1-Wire options removed from GPIO12 - boot strapping pin conflict with pull-up resistors -->
                    <!-- <option value="i2c-sda">I²C SDA (SHT3x)</option> -->
                    <!-- <option value="i2c-scl">I²C SCL (SHT3x)</option> -->
                    <!-- <option value="onewire">1-Wire (DS18B20)</option> -->
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO12</code></h3>
<p>Default Value: <code>input-pullup disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO12</code> pin.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This pin is usable without known restrictions!</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 12 state</code>: One of <code>external-flash-ws281x</code>, <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 12 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 12 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 12 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 12 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 12 name</code>: MQTT topic name (empty = <code>GPIO12</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_IO12 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO12 GPIO_item">GPIO12 Use Interrupt</span>
            </td>
            <td>
                <select class="GPIO_IO12 GPIO_item" id="GPIO_IO12_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge">rising edge</option>
                    <option value="falling-edge">falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>	
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO12 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO12 GPIO_item">GPIO12 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO12_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO12 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO12 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO12 GPIO_item">GPIO12 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO12_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO12 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO12 GPIO_item">GPIO12 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO12_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO12 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO12 GPIO_item">GPIO12 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO12_value6"></td>
            <td></td>
        </tr>

        <tr class="GPIO_item" unused_id="wstypeex3">
            <td class="indent1">
                <span class="GPIO_IO12 GPIO_item" id="GPIO_LEDType_text">LED Type (NeoPixel)</span>
            </td>
            <td class="GPIO_item">
                <select class="GPIO_item" id="GPIO_LEDType_value1">
                    <option value="WS2812" selected>WS2812</option>
                    <option value="WS2812B">WS2812B</option>
                    <option value="SK6812">SK6812</option>
                    <option value="WS2813">WS2813 (not tested)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LEDType</code></h3>
<p>Default Value: <code>WS2812</code>
Type of the <code>WS2812x</code> which is connected to GPIO12 (See <code>IO12</code> parameter).</p>
    </span></div></div>
</td>
        </tr>

        <tr  class="GPIO_item" unused_id="LEDANZex8" >
            <td class="indent1">
                <span class="GPIO_item" id="GPIO_LEDNumbers_text">Numbers of LEDs</span>
            </td>
            <td>
                <input required type="number" name="name" id="GPIO_LEDNumbers_value1" size="13" min="1"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LEDNumbers</code></h3>
<p>Default Value: <code>2</code></p>
<p>Number of LEDs on the external LED-stripe attached to GPIO12 (See <code>IO12</code> parameter).</p>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_item" unused_id="LEDRGBex9">
            <td class="indent1">
                <span class="GPIO_item" id="GPIO_LEDColor_text">LED Color</span>
            </td>
            <td>
                R <input required type="number" class="GPIO_IO12 GPIO_item" id="GPIO_LEDColor_value1"
                    min="0" max="255" step="1" oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LEDColor</code></h3>
<p>Default Value: <code>150 150 150</code></p>
<p>Color of the attached LEDs to GPIO12 in <strong>R</strong>ed, <strong>G</strong>reen <strong>B</strong>lue from <code>0</code> (full off) .. <code>255</code> (full on) 
(See <code>IO12</code> parameter).</p>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_item" unused_id="LEDRGBex9">
            <td></td>
            <td>			
                G <input required type="number" class="GPIO_IO12 GPIO_item" id="GPIO_LEDColor_value2"
                    min="0" max="255" step="1" oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
        </tr>

        <tr class="GPIO_item" unused_id="LEDRGBex9">
            <td></td>		
            <td>				
                B <input required type="number" class="GPIO_IO12 GPIO_item" id="GPIO_LEDColor_value3"
                    min="0" max="255" step="1" oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">
            </td>
        </tr>
        <!------------- GPIO12 end ------------------>

        <!------------- GPIO13 begin ------------------>
        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent1">
                <input type="checkbox" id="GPIO_IO13_enabled" value="1"  onclick = 'InvertEnableItem("GPIO", "IO13")' unchecked>
                <label for=GPIO_IO13_enabled><span id="GPIO_IO13_text">GPIO13 Configuration</span></label>
            </td>
            <td>
                <select id="GPIO_IO13_value1">
                    <option value="disabled">disabled</option>
                    <option value="input">input</option>
                    <option value="input-pullup">input pullup</option>
                    <option value="input-pulldown">input pulldown</option>
                    <option value="output">output</option>
                    <option value="i2c-sda">I²C SDA (SHT3x)</option>
                    <option value="i2c-scl">I²C SCL (SHT3x)</option>
                    <option value="onewire">1-Wire (DS18B20)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>IO13</code></h3>
<p>Default Value: <code>input-pullup disabled 10 false false</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter can be used to configure the GPIO <code>IO13</code> pin.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This pin is usable without known restrictions!</p>
</div>
<p>Parameters:</p>
<ul>
<li><code>GPIO 13 state</code>: One of <code>input</code>, <code>input pullup</code>, <code>input pulldown</code> or <code>output</code>.</li>
<li><code>GPIO 13 use interrupt</code>: Enable interrupt trigger</li>
<li><code>GPIO 13 PWM duty resolution</code>: LEDC PWM duty resolution in bit</li>
<li><code>GPIO 13 enable MQTT</code>: Enable MQTT publishing/subscribing</li>
<li><code>GPIO 13 enable HTTP</code>: Enable HTTP write/read</li>
<li><code>GPIO 13 name</code>: MQTT topic name (empty = <code>GPIO13</code>). Allowed characters: <code>a-z, A-Z, 0-9, _, -</code>.</li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO13 GPIO_item">GPIO13 Use Interrupt</span>
            </td>
            <td>
                <select id="GPIO_IO13_value2">
                    <option value="disabled">disabled</option>
                    <option value="rising-edge" disabled>rising edge</option>
                    <option value="falling-edge" disabled>falling edge</option>
                    <option value="rising-and-falling">rising and falling</option>
                    <option value="low-level-trigger">low level trigger</option>
                    <option value="high-level-trigger">high level trigger</option>
                </select>	
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO13 GPIO_item">GPIO13 PWM Duty Cycle Resolution</span>
            </td>
            <td>
                <input required type="number" id="GPIO_IO13_value3" min="1" max="20"
                    oninput="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=20)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));"><span class="GPIO_IO13 GPIO_item">Bits</span>
            </td>
            <td></td>
        </tr>

        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO13 GPIO_item">GPIO13 Enable MQTT</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO13_value4"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO13 GPIO_item">GPIO13 Enable REST API</span>
            </td>
            <td><input type="checkbox" id="GPIO_IO13_value5"></td>
            <td></td>
        </tr>

        <tr class="GPIO_IO13 GPIO_item expert">
            <td class="indent2">
                <span class="GPIO_IO13 GPIO_item">GPIO13 Name</span>
            </td>
            <td><input type="text" id="GPIO_IO13_value6"></td>
            <td></td>
        </tr>
        <!------------- GPIO13 end ------------------>

        <!------------- Autotimer ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Auto Timer</h4></td>
        </tr>
        <!--
        <tr class="expert" unused_id="ex13">
            <td class="indent1">
                <class id="AutoTimer_AutoStart_text" style="color:black;">Automatic Round Start</class>
            </td>
            <td>
                <select id="AutoTimer_AutoStart_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>AutoStart</code></h3>
<p>Default Value: <code>true</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This parameter is no longer available. The flow is now always enabled. If you want it to be disabled, set an interval which is high enough (eg. 1440 = 24h).</p>
</div>
    </span></div></div>
</td>
        </tr>
        -->
        <tr>
            <td class="indent1">
                <class id="AutoTimer_Interval_text" style="color:black;">Round Interval</class>
            </td>
            <td>
                <input required type="number" id="AutoTimer_Interval_value1" size="13" min="1" step="any"
                    oninput="(!validity.rangeUnderflow||(value=1));">Minutes
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Interval</code></h3>
<p>Default Value: <code>5</code></p>
<p>Unit: Minutes</p>
<p>Interval in which the Flow (Digitization Round) is run.
It will run immediately on startup and then the next time after the given interval.
If a round takes longer than this interval, the next round gets postponed until the current round completes.</p>
<p>If the flow gets started by a MQTT message or the REST API call, the interval automatically gets reset.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want the flow to be disabled, set an interval which is high enough (eg. 1440 = 24h).</p>
</div>
    </span></div></div>
</td>
        </tr>

        <!------------- Data Logging ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Data Logging</h4></td>
        </tr>

        <tr>
            <td class="indent1">
                <class id="DataLogging_DataLogActive_text" style="color:black;">Data Logging</class>
            </td>
            <td>
                <select id="DataLogging_DataLogActive_value1">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>DataLogActive</code></h3>
<p>Default Value: <code>true</code>
Activate data logging to the SD-Card.</p>
<p>The files will be stored in <code>/log/data/data_YYYY-MM-DD.csv</code>. See <a target=_blank href="https://jomjol.github.io/AI-on-the-edge-device-docs/data-logging"><code>Data Logging</code></a> for details.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A SD-Card has limited write cycles. Since the device does not do <a target=_blank href="https://en.wikipedia.org/wiki/Wear_leveling">Wear Leveling</a>, this can wear out your SD-Card!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent1">
                <class id="DataLogging_DataFilesRetention_text" style="color:black;">Data Files Retention</class>
            </td>
            <td>
                <input required type="number" id="DataLogging_DataFilesRetention_value1" size="13" min="0" step="1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Days
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>DataFilesRetention</code></h3>
<p>Default Value: <code>3</code></p>
<p>Unit: Days</p>
<p>Number of days to keep the data files (<code>0</code> = forever).</p>
    </span></div></div>
</td>
        </tr>

        <!------------- Debug Logging ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>Debug</h4></td>
        </tr>

        <tr>
            <td class="indent1">
                <class id="Debug_LogLevel_text" style="color:black;">Logfile Log Level</class>
            </td>
            <td>
                <select id="Debug_LogLevel_value1">
                    <option value="1" selected>ERROR</option> <!-- matches esp_log_level_t -->
                    <option value="2">WARNING</option>
                    <option value="3">INFO</option>
                    <option value="4">DEBUG</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LogLevel</code></h3>
<p>Default Value: <code>1</code> (<code>ERROR</code>)
Define the log level for the logging to the SD-Card.</p>
<p>Available options:</p>
<ul>
<li><code>1</code>: <code>ERROR</code></li>
<li><code>2</code>: <code>WARNING</code></li>
<li><code>3</code>: <code>INFO</code></li>
<li><code>4</code>: <code>DEBUG</code></li>
</ul>
<p>As higher the level, as more log messages get written to the SD-Card.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>DEBUG</code> or <code>INFO</code> might damage the SD-Card if enabled long term due to excessive writes to the SD-Card!
A SD-Card has limited write cycles. Since the device does not do <a target=_blank href="https://en.wikipedia.org/wiki/Wear_leveling">Wear Leveling</a>, this can wear out your SD-Card!</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent1">
                <class id="Debug_LogfilesRetention_text" style="color:black;">Logfiles Retention</class>
            </td>
            <td>
                <input required type="number" id="Debug_LogfilesRetention_value1" size="13" min="0" step="1"
                    oninput="(!validity.rangeUnderflow||(value=0)) && (!validity.stepMismatch||(value=parseInt(this.value)));">Days
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>LogfilesRetention</code></h3>
<p>Default Value: <code>3</code></p>
<p>Unit: Days</p>
<p>Number of days to keep the log files (<code>0</code> = forever).</p>
    </span></div></div>
</td>
        </tr>

        <!------------- System ------------------>
        <tr style="border-bottom: 2px solid lightgray;">
            <td colspan="3" style="padding-left: 0px; padding-bottom: 3px;"><h4>System</h4></td>
        </tr>

        <tr>
            <td class="indent1">
                <input type="checkbox" id="System_TimeZone_enabled" value="1"  onclick = 'InvertEnableItem("System", "TimeZone")' unchecked >
                <label for=System_TimeZone_enabled><class id="System_TimeZone_text" style="color:black;">Time Zone</class></label>
                <p></p><p></p>
            </td>
            <td>
                <input type="text" id="System_TimeZone_value1">
                <p>Use <a href="timezones.html" target="_blank">timezones</a> to find your settings</p>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>TimeZone</code></h3>
<p>Default Value: <code>CET-1CEST,M3.5.0,M10.5.0/3</code></p>
<p>Time zone in POSIX syntax (Europe/Berlin = <code>CET-1CEST,M3.5.0,M10.5.0/3</code> - incl. daylight saving)
Check the table on <code>http://&lt;DEVICE IP&gt;/timezones.html</code> to find the settings for your region.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="ex16">
            <td class="indent1">
                <input type="checkbox" id="System_TimeServer_enabled" value="1"  onclick = 'InvertEnableItem("System", "TimeServer")' unchecked >
                <label for=System_TimeServer_enabled><class id="System_TimeServer_text" style="color:black;">Time Server (NTP)</class></label>
            </td>
            <td>
                <input type="text" id="System_TimeServer_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>TimeServer</code></h3>
<p>Default Value: <code>pool.ntp.org</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Time server to synchronize system time. If it is disabled or <code>undefined</code>, <code>pool.ntp.org</code> will be used.
You can also set it to the IP of your router. Many routers like Fritzboxes can act as a local NTP server.
To disable NTP, you need to activate it but set the TimeServer config to be empty (<code>""</code>).
In such case the time always starts at <code>01.01.1970</code> after each power cycle!</p>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="System_Hostname">
            <td class="indent1">
                <input type="checkbox" id="System_Hostname_enabled" value="1"  onclick = 'InvertEnableItem("System", "Hostname")' unchecked >
                <label for=System_Hostname_enabled><class id="System_Hostname_text" style="color:black;">Hostname</class></label>
            </td>
            <td>
                <input type="text" id="System_Hostname_value1">
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>Hostname</code></h3>
<p>Default Value: <code>undefined</code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>Hostname for the device.
It gets automatically transferred to <code>/wlan.ini</code> on the SD-Card at the next startup.</p>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="System_RSSIThreshold">
            <td class="indent1">
                <input type="checkbox" id="System_RSSIThreshold_enabled" value="1"  onclick = 'InvertEnableItem("System", "RSSIThreshold")' unchecked >
                <label for=System_RSSIThreshold_enabled><class id="System_RSSIThreshold_text" style="color:black;">RSSI Threshold</class></label>
            </td>
            <td>
                <input required type="number" name="name" id="System_RSSIThreshold_value1" min="-100" max="0" step="1"
                    oninput="(!validity.rangeUnderflow||(value=-100)) && (!validity.rangeOverflow||(value=0)) && 
                        (!validity.stepMismatch||(value=parseInt(this.value)));">dBm
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>RSSIThreshold</code></h3>
<p>Default Value: <code>0</code></p>
<p>Possible values: <code>-100</code> .. <code>0</code> (<code>0</code> = disabled).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an <strong>Expert Parameter</strong>! Only change it if you understand what it does!</p>
</div>
<p>This parameter activates a client triggered AP switching functionality (simplified roaming). 
If actual RSSI value is lower (more negative) than <code>RSSIThreshold</code>, all WIFI channels will be scanned for configured access point SSID. If an access point is in range which has better RSSI value (less negative) than actual RSSI value + 5 dBm, the device is trying to connect to this access point with the better RSSI value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The RSSI check only gets initiated at the end of each round to avoid any disturbance of processing.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It gets automatically transferred to <code>/wlan.ini</code> on the SD-Card at next startup.</p>
</div>
    </span></div></div>
</td>
        </tr>

        <tr class="expert" unused_id="System_CPUFrequency">
            <td class="indent1">
                <input type="checkbox" id="System_CPUFrequency_enabled" value="1"  onclick = 'InvertEnableItem("System", "CPUFrequency")' unchecked >
                <label for=System_CPUFrequency_enabled><class id="System_CPUFrequency_text" style="color:black;">CPU Frequency</class></label>
            </td>
            <td>
                <select id="System_CPUFrequency_value1">
                    <option value="160" selected>160 MHz</option>
                    <option value="240">240 MHz</option>
                </select>
            </td>
            <td>
    <div class="rst-content"><div class="tooltip"><img src="help.png" width="32px"><span class="tooltiptext">
<h3 style="margin: 0">Parameter <code>CPUFrequency</code></h3>
<p>Default Value: <code>160</code></p>
<p>Set the CPU Frequency.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Setting it to 240 will lead to a faster device, but it will also require a stronger power supply!
Additionally, depending on the quality of your ESP32-CAM, it might run unstable!</p>
</div>
<p>Possible values: </p>
<ul>
<li>160</li>
<li>240 </li>
</ul>
    </span></div></div>
</td>
        </tr>

        <tr>
            <td class="indent1">
                <class id="System_Tooltip_text" style="color:black;">Tooltip</class>
            </td>
            <td>
                <select id="System_Tooltip_value1" onchange="UpdateTooltipModus()">
                    <option value="true">enabled (true)</option>
                    <option value="false" selected>disabled (false)</option>
                </select>
            </td>
            <td></td>
        </tr>
    </table>

    <hr>
    <button class="button" onclick="saveTextAsFile()">Save Config</button>
</div>

<script type="text/javascript" src="readconfigparam.js?v=$COMMIT_HASH"></script>
<script type="text/javascript" src="readconfigcommon.js?v=$COMMIT_HASH"></script> 
 
<script type="text/javascript">
var canvas = document.getElementById('canvas'),
    domainname = getDomainname(),
    changeCamValue = 0,	
    param,
    category,
    NUNBERSAkt = -1,
    NUMBERS;

function cameraParameterChanged() {
    changeCamValue = 1;

    if(!document.getElementById("TakeImage_CamZoom_value1").selectedIndex) {
        // EnDisableItem(_status, _param, _category, _cat, _name, _optional, _number = -1)
        EnDisableItem(true, param, category, "TakeImage", "CamZoomOffsetX", false);
        EnDisableItem(true, param, category, "TakeImage", "CamZoomOffsetY", false);
        EnDisableItem(true, param, category, "TakeImage", "CamZoomSize", false);				
    }
    else {
        EnDisableItem(false, param, category, "TakeImage", "CamZoomOffsetX", false);
        EnDisableItem(false, param, category, "TakeImage", "CamZoomOffsetY", false);
        EnDisableItem(false, param, category, "TakeImage", "CamZoomSize", false);				
    }

    if(document.getElementById("TakeImage_CamAutoSharpness_value1").selectedIndex) {
        EnDisableItem(true, param, category, "TakeImage", "CamSharpness", false);				
    }
    else {
        EnDisableItem(false, param, category, "TakeImage", "CamSharpness", false);				
    }
}

function LoadConfigNeu() {
    if (!loadConfig(domainname)) {
        firework.launch('Configuration could not be loaded! Please reload the page!', 'danger', 30000);
        return;
    }
	
    param = getCamConfig();
    category = getConfigCategory();
    InitIndivParameter();

    UpdateInput();
    var sel = document.getElementById("Numbers_value1");
    UpdateInputIndividual(sel);
	
    UpdateExpertModus();
    UpdateTooltipModus();	
    document.getElementById("divall").style.display = ''; 

    if(!document.getElementById("TakeImage_CamZoom_value1").selectedIndex) {
        // EnDisableItem(_status, _param, _category, _cat, _name, _optional, _number = -1)
        EnDisableItem(true, param, category, "TakeImage", "CamZoomOffsetX", false);
        EnDisableItem(true, param, category, "TakeImage", "CamZoomOffsetY", false);
        EnDisableItem(true, param, category, "TakeImage", "CamZoomSize", false);				
    }
    else {
        EnDisableItem(false, param, category, "TakeImage", "CamZoomOffsetX", false);
        EnDisableItem(false, param, category, "TakeImage", "CamZoomOffsetY", false);
        EnDisableItem(false, param, category, "TakeImage", "CamZoomSize", false);				
    }

    if(document.getElementById("TakeImage_CamAutoSharpness_value1").selectedIndex) {
        EnDisableItem(true, param, category, "TakeImage", "CamSharpness", false);				
    }
    else {
        EnDisableItem(false, param, category, "TakeImage", "CamSharpness", false);				
    }	
}

function InitIndivParameter() {
    NUMBERS = getNUMBERInfo();

    var _index = document.getElementById("Numbers_value1");
    while (_index.length) {
        _index.remove(0);
    }

    var _indexInflux = document.getElementById("NumbersInfluxDBv2_value1");
    while (_indexInflux.length) {
        _indexInflux.remove(0);
    }

    var _indexInfluxv1 = document.getElementById("NumbersInfluxDB_value1");
    while (_indexInfluxv1.length) {
        _indexInfluxv1.remove(0);
    }

    var _indexMQTTIdx = document.getElementById("NumbersMQTTIdx_value1");
    while (_indexMQTTIdx.length) {
        _indexMQTTIdx.remove(0);
    }	

    for (var i = 0; i < NUMBERS.length; ++i) {
        var option = document.createElement("option");
        option.text = NUMBERS[i]["name"];
        option.value = i;
        _index.add(option);

        var optionInflux = document.createElement("option");
        optionInflux.text = NUMBERS[i]["name"];
        optionInflux.value = i;
        _indexInflux.add(optionInflux);

        var optionInfluxv1 = document.createElement("option");
        optionInfluxv1.text = NUMBERS[i]["name"];
        optionInfluxv1.value = i;
        _indexInfluxv1.add(optionInfluxv1);

        var optionMQTTIdx = document.createElement("option");
        optionMQTTIdx.text = NUMBERS[i]["name"];
        optionMQTTIdx.value = i;
        _indexMQTTIdx.add(optionMQTTIdx);
    }
	
    _index.selectedIndex = 0; 
    _indexInflux.selectedIndex = 0;
    _indexInfluxv1.selectedIndex = 0;
    _indexMQTTIdx.selectedIndex = 0;
}

function UpdateInputIndividual(sel) {
    if (NUNBERSAkt != -1) {
        // ReadParameter(param, "PostProcessing", "PreValueUse", false, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "DecimalShift", true, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "AnalogToDigitTransitionStart", true, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "ChangeRateThreshold", true, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "MaxRateValue", true, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "MaxRateType", true, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "ExtendedResolution", false, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "IgnoreLeadingNaN", false, NUNBERSAkt);
        // ReadParameter(param, "PostProcessing", "IgnoreAllNaN", false, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "AllowNegativeRates", false, NUNBERSAkt);
        ReadParameter(param, "PostProcessing", "CheckDigitIncreaseConsistency", false, NUNBERSAkt);
        ReadParameter(param, "InfluxDB", "Field", true, NUNBERSAkt);
        ReadParameter(param, "InfluxDBv2", "Field", true, NUNBERSAkt);
        ReadParameter(param, "InfluxDB", "Measurement", true, NUNBERSAkt);
        ReadParameter(param, "InfluxDBv2", "Measurement", true, NUNBERSAkt);
        ReadParameter(param, "MQTT", "DomoticzIDX", true, NUNBERSAkt);
    }

    // var sel = document.getElementById("Numbers_value1");
    NUNBERSAkt = sel.selectedIndex;
    // WriteParameter(param, category, "PostProcessing", "PreValueUse", false, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "DecimalShift", true, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "AnalogToDigitTransitionStart", true, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "ChangeRateThreshold", true, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "MaxRateValue", true, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "MaxRateType", true, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "ExtendedResolution", false, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "IgnoreLeadingNaN", false, NUNBERSAkt);
    // WriteParameter(param, category, "PostProcessing", "IgnoreAllNaN", false, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "AllowNegativeRates", false, NUNBERSAkt);
    WriteParameter(param, category, "PostProcessing", "CheckDigitIncreaseConsistency", false, NUNBERSAkt);
    WriteParameter(param, category, "InfluxDB", "Field", true, NUNBERSAkt);
    WriteParameter(param, category, "InfluxDBv2", "Field", true, NUNBERSAkt);
    WriteParameter(param, category, "InfluxDB", "Measurement", true, NUNBERSAkt);
    WriteParameter(param, category, "InfluxDBv2", "Measurement", true, NUNBERSAkt);
    WriteParameter(param, category, "MQTT", "DomoticzIDX", true, NUNBERSAkt);
}

function UpdateInput() {
    document.getElementById("Category_Digits_enabled").checked = category["Digits"]["enabled"];
    setVisible("DigitItem", category["Digits"]["enabled"]);

    document.getElementById("Category_Analog_enabled").checked = category["Analog"]["enabled"];
    setVisible("AnalogItem", category["Analog"]["enabled"]);

    document.getElementById("Category_MQTT_enabled").checked = category["MQTT"]["enabled"];
    setVisible("MQTTItem", category["MQTT"]["enabled"]);

    document.getElementById("Category_GPIO_enabled").checked = category["GPIO"]["enabled"];
    setVisible("GPIO_item", category["GPIO"]["enabled"]);

    document.getElementById("Category_InfluxDB_enabled").checked = category["InfluxDB"]["enabled"];
    setVisible("InfluxDBv1Item", category["InfluxDB"]["enabled"]);

    document.getElementById("Category_InfluxDBv2_enabled").checked = category["InfluxDBv2"]["enabled"];
    setVisible("InfluxDBv2Item", category["InfluxDBv2"]["enabled"]);

    document.getElementById("Category_Webhook_enabled").checked = category["Webhook"]["enabled"];
    setVisible("WebhookItem", category["Webhook"]["enabled"]);

    document.getElementById("Category_SHT3x_enabled").checked = category["SHT3x"]["enabled"];
    setVisible("SHT3xItem", category["SHT3x"]["enabled"]);

    document.getElementById("Category_DS18B20_enabled").checked = category["DS18B20"]["enabled"];
    setVisible("DS18B20Item", category["DS18B20"]["enabled"]);

    WriteParameter(param, category, "TakeImage", "RawImagesLocation", true);
    WriteParameter(param, category, "TakeImage", "RawImagesRetention", true);

    WriteParameter(param, category, "TakeImage", "WaitBeforeTakingPicture", false);
    WriteParameter(param, category, "TakeImage", "CamGainceiling", false);	
    WriteParameter(param, category, "TakeImage", "CamQuality", false);
    WriteParameter(param, category, "TakeImage", "CamBrightness", false);
    WriteParameter(param, category, "TakeImage", "CamContrast", false);
    WriteParameter(param, category, "TakeImage", "CamSaturation", false);
    WriteParameter(param, category, "TakeImage", "CamSharpness", false);
    WriteParameter(param, category, "TakeImage", "CamAutoSharpness", false);	
    WriteParameter(param, category, "TakeImage", "CamSpecialEffect", false);
    WriteParameter(param, category, "TakeImage", "CamWbMode", false);
    WriteParameter(param, category, "TakeImage", "CamAwb", false);
    WriteParameter(param, category, "TakeImage", "CamAwbGain", false);	
    WriteParameter(param, category, "TakeImage", "CamAec", false);
    WriteParameter(param, category, "TakeImage", "CamAec2", false);
    WriteParameter(param, category, "TakeImage", "CamAeLevel", false);
    WriteParameter(param, category, "TakeImage", "CamAecValue", false);	
    WriteParameter(param, category, "TakeImage", "CamAgc", false);
    WriteParameter(param, category, "TakeImage", "CamAgcGain", false);	
    WriteParameter(param, category, "TakeImage", "CamBpc", false);
    WriteParameter(param, category, "TakeImage", "CamWpc", false);
    WriteParameter(param, category, "TakeImage", "CamRawGma", false);
    WriteParameter(param, category, "TakeImage", "CamLenc", false);
    WriteParameter(param, category, "TakeImage", "CamHmirror", false);
    WriteParameter(param, category, "TakeImage", "CamVflip", false);
    WriteParameter(param, category, "TakeImage", "CamDcw", false);
    WriteParameter(param, category, "TakeImage", "CamDenoise", false);
    WriteParameter(param, category, "TakeImage", "CamZoom", false);
    WriteParameter(param, category, "TakeImage", "CamZoomOffsetX", false);
    WriteParameter(param, category, "TakeImage", "CamZoomOffsetY", false);
    WriteParameter(param, category, "TakeImage", "CamZoomSize", false);	
    WriteParameter(param, category, "TakeImage", "LEDIntensity", false);
    WriteParameter(param, category, "TakeImage", "Demo", false);
	
    WriteParameter(param, category, "Alignment", "SearchFieldX", false);		
    WriteParameter(param, category, "Alignment", "SearchFieldY", false);		
    WriteParameter(param, category, "Alignment", "AlignmentAlgo", true);			
    WriteParameter(param, category, "Alignment", "InitialRotate", false);

    WriteParameter(param, category, "Digits", "CNNGoodThreshold", true);
    WriteParameter(param, category, "Digits", "ROIImagesLocation", true);		
    WriteParameter(param, category, "Digits", "ROIImagesRetention", true);		
    
    WriteParameter(param, category, "Analog", "ROIImagesLocation", true);		
    WriteParameter(param, category, "Analog", "ROIImagesRetention", true);		
    
    WriteParameter(param, category, "PostProcessing", "PreValueUse", false);		
    WriteParameter(param, category, "PostProcessing", "PreValueAgeStartup", true);		
    WriteParameter(param, category, "PostProcessing", "ErrorMessage", false);
    // WriteParameter(param, category, "PostProcessing", "CheckDigitIncreaseConsistency", false);

    WriteParameter(param, category, "MQTT", "Uri", true);	
    WriteParameter(param, category, "MQTT", "MainTopic", true);	
    WriteParameter(param, category, "MQTT", "ClientID", true);	
    WriteParameter(param, category, "MQTT", "user", true);	
    WriteParameter(param, category, "MQTT", "password", true);
    WriteParameter(param, category, "MQTT", "RetainMessages", false);
    WriteParameter(param, category, "MQTT", "HomeassistantDiscovery", false);
    WriteParameter(param, category, "MQTT", "MeterType", true);
    WriteParameter(param, category, "MQTT", "CACert", true);
    WriteParameter(param, category, "MQTT", "ClientCert", true);
    WriteParameter(param, category, "MQTT", "ClientKey", true);
    WriteParameter(param, category, "MQTT", "ValidateServerCert", true);
    WriteParameter(param, category, "MQTT", "DomoticzTopicIn", true);
    
    WriteParameter(param, category, "InfluxDB", "Uri", true);	
    WriteParameter(param, category, "InfluxDB", "Database", true);	
    // WriteParameter(param, category, "InfluxDB", "Measurement", true);	
    WriteParameter(param, category, "InfluxDB", "user", true);	
    WriteParameter(param, category, "InfluxDB", "password", true);	
    // WriteParameter(param, category, "InfluxDB", "Field", true);

    WriteParameter(param, category, "InfluxDBv2", "Uri", true);	
    WriteParameter(param, category, "InfluxDBv2", "Bucket", true);	
    // WriteParameter(param, category, "InfluxDBv2", "Measurement", true);	
    WriteParameter(param, category, "InfluxDBv2", "Org", true);	
    WriteParameter(param, category, "InfluxDBv2", "Token", true);	
    // WriteParameter(param, category, "InfluxDBv2", "Field", true);

    WriteParameter(param, category, "Webhook", "Uri", true);	
    WriteParameter(param, category, "Webhook", "ApiKey", true);
    WriteParameter(param, category, "Webhook", "UploadImg", false);

    WriteParameter(param, category, "GPIO", "IO0", true);
    WriteParameter(param, category, "GPIO", "IO1", true);
    WriteParameter(param, category, "GPIO", "IO3", true);
    WriteParameter(param, category, "GPIO", "IO4", true);
    WriteParameter(param, category, "GPIO", "IO12", true);
    WriteParameter(param, category, "GPIO", "IO13", true);
    WriteParameter(param, category, "GPIO", "LEDType", false);
    WriteParameter(param, category, "GPIO", "LEDNumbers", false);
    WriteParameter(param, category, "GPIO", "LEDColor", false);

    //WriteParameter(param, category, "AutoTimer", "AutoStart", false);	
    WriteParameter(param, category, "AutoTimer", "Interval", false);

    WriteParameter(param, category, "DataLogging", "DataLogActive", false);	
    WriteParameter(param, category, "DataLogging", "DataFilesRetention", false);	

    WriteParameter(param, category, "Debug", "LogLevel", false);
    WriteParameter(param, category, "Debug", "LogfilesRetention", false);

    WriteParameter(param, category, "System", "Tooltip", false);
    WriteParameter(param, category, "System", "TimeZone", true);
    WriteParameter(param, category, "System", "Hostname", true);
    WriteParameter(param, category, "System", "TimeServer", true);
    WriteParameter(param, category, "System", "RSSIThreshold", true);
    WriteParameter(param, category, "System", "CPUFrequency", true);

    // Sensor parameters
    WriteParameter(param, category, "SHT3x", "Address", false);
    WriteParameter(param, category, "SHT3x", "Interval", false);
    WriteParameter(param, category, "SHT3x", "I2C_Frequency", false);
    WriteParameter(param, category, "SHT3x", "MQTT_Enable", false);
    WriteParameter(param, category, "SHT3x", "MQTT_Topic", false);
    WriteParameter(param, category, "SHT3x", "InfluxDB_Enable", false);
    WriteParameter(param, category, "SHT3x", "InfluxDB_Measurement", false);

    WriteParameter(param, category, "DS18B20", "ExpectedSensors", false);
    WriteParameter(param, category, "DS18B20", "Interval", false);
    WriteParameter(param, category, "DS18B20", "MQTT_Enable", false);
    WriteParameter(param, category, "DS18B20", "MQTT_Topic", false);
    WriteParameter(param, category, "DS18B20", "InfluxDB_Enable", false);
    WriteParameter(param, category, "DS18B20", "InfluxDB_Measurement", false);

    WriteModelFiles();
}

function WriteModelFiles() {
    list_tflite = getTFLITEList();

    var _indexDig = document.getElementById("Digits_Model_value1");
    var _indexAna = document.getElementById("Analog_Model_value1");
	
    while (_indexDig.length) {
        _indexDig.remove(0);
    }
	
    while (_indexAna.length) {
        _indexAna.remove(0);
    }

    for (var i = 0; i < list_tflite.length; ++i) {
        var optionDig = document.createElement("option");
        var optionAna = document.createElement("option");
        
        var text = list_tflite[i].replace("/config/", "");
        
        if (list_tflite[i].includes("/dig")) { // Its a digit file, only show in the digits list box
            optionDig.text = text;
            optionDig.value = list_tflite[i];
            _indexDig.add(optionDig);
        }
        else if (list_tflite[i].includes("/ana")) { // Its a digit file, only show in the analog list box
            optionAna.text = text;
            optionAna.value = list_tflite[i];
            _indexAna.add(optionAna);
        }
        else { // all other files, show in both list boxes
            optionDig.text = text;
            optionDig.value = list_tflite[i];
            _indexDig.add(optionDig);
        
            optionAna.text = text;
            optionAna.value = list_tflite[i];
            _indexAna.add(optionAna);
        }
    }

    WriteParameter(param, category, "Analog", "Model", false);		
    WriteParameter(param, category, "Digits", "Model", false);		
}

function ReadParameterAll() {
    category["Analog"]["enabled"] = document.getElementById("Category_Analog_enabled").checked;
    category["Digits"]["enabled"] = document.getElementById("Category_Digits_enabled").checked;
    category["MQTT"]["enabled"] = document.getElementById("Category_MQTT_enabled").checked;
    category["InfluxDB"]["enabled"] = document.getElementById("Category_InfluxDB_enabled").checked;
    category["InfluxDBv2"]["enabled"] = document.getElementById("Category_InfluxDBv2_enabled").checked;
    category["Webhook"]["enabled"] = document.getElementById("Category_Webhook_enabled").checked;
    category["GPIO"]["enabled"] = document.getElementById("Category_GPIO_enabled").checked;
    category["SHT3x"]["enabled"] = document.getElementById("Category_SHT3x_enabled").checked;
    category["DS18B20"]["enabled"] = document.getElementById("Category_DS18B20_enabled").checked;

    ReadParameter(param, "TakeImage", "RawImagesLocation", true);
    ReadParameter(param, "TakeImage", "RawImagesRetention", true);
    ReadParameter(param, "TakeImage", "WaitBeforeTakingPicture", false);
    ReadParameter(param, "TakeImage", "CamGainceiling", false);	
    ReadParameter(param, "TakeImage", "CamQuality", false);	
    ReadParameter(param, "TakeImage", "CamBrightness", false);
    ReadParameter(param, "TakeImage", "CamContrast", false);
    ReadParameter(param, "TakeImage", "CamSaturation", false);
    ReadParameter(param, "TakeImage", "CamSharpness", false);
    ReadParameter(param, "TakeImage", "CamAutoSharpness", false);	
    ReadParameter(param, "TakeImage", "CamSpecialEffect", false);
    ReadParameter(param, "TakeImage", "CamWbMode", false);
    ReadParameter(param, "TakeImage", "CamAwb", false);
    ReadParameter(param, "TakeImage", "CamAwbGain", false);	
    ReadParameter(param, "TakeImage", "CamAec", false);
    ReadParameter(param, "TakeImage", "CamAec2", false);
    ReadParameter(param, "TakeImage", "CamAeLevel", false);
    ReadParameter(param, "TakeImage", "CamAecValue", false);	
    ReadParameter(param, "TakeImage", "CamAgc", false);
    ReadParameter(param, "TakeImage", "CamAgcGain", false);
    ReadParameter(param, "TakeImage", "CamBpc", false);
    ReadParameter(param, "TakeImage", "CamWpc", false);
    ReadParameter(param, "TakeImage", "CamRawGma", false);
    ReadParameter(param, "TakeImage", "CamLenc", false);
    ReadParameter(param, "TakeImage", "CamHmirror", false);
    ReadParameter(param, "TakeImage", "CamVflip", false);
    ReadParameter(param, "TakeImage", "CamDcw", false);
    ReadParameter(param, "TakeImage", "CamDenoise", false);
    ReadParameter(param, "TakeImage", "CamZoom", false);
    ReadParameter(param, "TakeImage", "CamZoomOffsetX", false);
    ReadParameter(param, "TakeImage", "CamZoomOffsetY", false);	
    ReadParameter(param, "TakeImage", "CamZoomSize", false);	
    ReadParameter(param, "TakeImage", "LEDIntensity", false);	
    ReadParameter(param, "TakeImage", "Demo", false);	

    ReadParameter(param, "Alignment", "SearchFieldX", false);	
    ReadParameter(param, "Alignment", "SearchFieldY", false);
    ReadParameter(param, "Alignment", "AlignmentAlgo", true);
    ReadParameter(param, "Alignment", "InitialRotate", false);

    ReadParameter(param, "Digits", "Model", false);
    ReadParameter(param, "Digits", "CNNGoodThreshold", true);
    ReadParameter(param, "Digits", "ROIImagesLocation", true);
    ReadParameter(param, "Digits", "ROIImagesRetention", true);

    ReadParameter(param, "Analog", "Model", false);
    ReadParameter(param, "Analog", "ROIImagesLocation", true);
    ReadParameter(param, "Analog", "ROIImagesRetention", true);

    ReadParameter(param, "PostProcessing", "PreValueUse", false);
    ReadParameter(param, "PostProcessing", "PreValueAgeStartup", true);
    ReadParameter(param, "PostProcessing", "ErrorMessage", false);
    // ReadParameter(param, "PostProcessing", "CheckDigitIncreaseConsistency", false);	

    ReadParameter(param, "MQTT", "Uri", true);
    ReadParameter(param, "MQTT", "MainTopic", true);
    ReadParameter(param, "MQTT", "ClientID", true);
    ReadParameter(param, "MQTT", "user", true);
    ReadParameter(param, "MQTT", "password", true);
    ReadParameter(param, "MQTT", "RetainMessages", false);
    ReadParameter(param, "MQTT", "HomeassistantDiscovery", false);
    ReadParameter(param, "MQTT", "MeterType", true);
    ReadParameter(param, "MQTT", "CACert", true);
    ReadParameter(param, "MQTT", "ClientCert", true);
    ReadParameter(param, "MQTT", "ClientKey", true);
    ReadParameter(param, "MQTT", "ValidateServerCert", true);
    ReadParameter(param, "MQTT", "DomoticzTopicIn", true);

    ReadParameter(param, "InfluxDB", "Uri", true);
    ReadParameter(param, "InfluxDB", "Database", true);
    ReadParameter(param, "InfluxDB", "Measurement", true);
    ReadParameter(param, "InfluxDB", "user", true);
    ReadParameter(param, "InfluxDB", "password", true);

    ReadParameter(param, "InfluxDBv2", "Uri", true);
    ReadParameter(param, "InfluxDBv2", "Bucket", true);
    ReadParameter(param, "InfluxDBv2", "Measurement", true);
    ReadParameter(param, "InfluxDBv2", "Org", true);
    ReadParameter(param, "InfluxDBv2", "Token", true);
    // ReadParameter(param, "InfluxDB", "Field", true);	

    ReadParameter(param, "Webhook", "Uri", true);	
    ReadParameter(param, "Webhook", "ApiKey", true);
    ReadParameter(param, "Webhook", "UploadImg", false);

    ReadParameter(param, "GPIO", "IO0", true);
    ReadParameter(param, "GPIO", "IO1", true);
    ReadParameter(param, "GPIO", "IO3", true);
    ReadParameter(param, "GPIO", "IO4", true);
    ReadParameter(param, "GPIO", "IO12", true);
    ReadParameter(param, "GPIO", "IO13", true);
    ReadParameter(param, "GPIO", "LEDType", false);
    ReadParameter(param, "GPIO", "LEDNumbers", false);
    ReadParameter(param, "GPIO", "LEDColor", false);
	
    // Folgende Zeilen sind für Abwärtskompatibität < v9.0.0 notwendig (manchmal parameter auskommentiert)
    param["GPIO"]["LEDType"]["enabled"] = true;
    param["GPIO"]["LEDNumbers"]["enabled"] = true;
    param["GPIO"]["LEDColor"]["enabled"] = true;
    param["GPIO"]["LEDType"]["found"] = true;
    param["GPIO"]["LEDNumbers"]["found"] = true;
    param["GPIO"]["LEDColor"]["found"] = true;

    //ReadParameter(param, "AutoTimer", "AutoStart", false);
    ReadParameter(param, "AutoTimer", "Interval", false);
    
    ReadParameter(param, "DataLogging", "DataLogActive", false);
    ReadParameter(param, "DataLogging", "DataFilesRetention", false);

    ReadParameter(param, "Debug", "LogLevel", false);
    ReadParameter(param, "Debug", "LogfilesRetention", false);

    ReadParameter(param, "System", "Tooltip", false);
    ReadParameter(param, "System", "TimeZone", true);
    ReadParameter(param, "System", "Hostname", true);
    ReadParameter(param, "System", "TimeServer", true);
    ReadParameter(param, "System", "RSSIThreshold", true);
    ReadParameter(param, "System", "CPUFrequency", true);

    // Sensor parameters (Note: Enable parameter is handled via category checkbox, not ReadParameter)
    ReadParameter(param, "SHT3x", "Address", false);
    ReadParameter(param, "SHT3x", "Interval", false);
    ReadParameter(param, "SHT3x", "I2C_Frequency", false);
    ReadParameter(param, "SHT3x", "MQTT_Enable", false);
    ReadParameter(param, "SHT3x", "MQTT_Topic", false);
    ReadParameter(param, "SHT3x", "InfluxDB_Enable", false);
    ReadParameter(param, "SHT3x", "InfluxDB_Measurement", false);

    ReadParameter(param, "DS18B20", "ExpectedSensors", false);
    ReadParameter(param, "DS18B20", "Interval", false);
    ReadParameter(param, "DS18B20", "MQTT_Enable", false);
    ReadParameter(param, "DS18B20", "MQTT_Topic", false);
    ReadParameter(param, "DS18B20", "InfluxDB_Enable", false);
    ReadParameter(param, "DS18B20", "InfluxDB_Measurement", false);

    var sel = document.getElementById("Numbers_value1");
    UpdateInputIndividual(sel);

    // FormatDecimalValue(param, "PostProcessing", "MaxRateValue");
}

function UpdateAfterCategoryCheck() {
    ReadParameterAll();
    category["Analog"]["enabled"] = document.getElementById("Category_Analog_enabled").checked;
    category["Digits"]["enabled"] = document.getElementById("Category_Digits_enabled").checked;
    category["MQTT"]["enabled"] = document.getElementById("Category_MQTT_enabled").checked;
    category["InfluxDB"]["enabled"] = document.getElementById("Category_InfluxDB_enabled").checked;
    category["InfluxDBv2"]["enabled"] = document.getElementById("Category_InfluxDBv2_enabled").checked;
    category["GPIO"]["enabled"] = document.getElementById("Category_GPIO_enabled").checked;
    category["Webhook"]["enabled"] = document.getElementById("Category_Webhook_enabled").checked;
    category["SHT3x"]["enabled"] = document.getElementById("Category_SHT3x_enabled").checked;
    category["DS18B20"]["enabled"] = document.getElementById("Category_DS18B20_enabled").checked;

    UpdateInput();
    var sel = document.getElementById("Numbers_value1");
    UpdateInputIndividual(sel);
}

function UpdateExpertModus() {
    // var _style = 'display:none;';
    var _style_pur = 'none';
    var _hidden = true;
    if (document.getElementById("ExpertModus_enabled").checked) {
        // _style = '';
        _style_pur = '';
        _hidden = false;
        document.getElementById("Button_Edit_Config_Raw").style.display = "";
        firework.launch("Expert view activated. Please use it carefully", 'warning', 5000);
    }
    else {
        document.getElementById("Button_Edit_Config_Raw").style.display = "none"; 
    }

    const expert = document.querySelectorAll(".expert");
    for (var i = 0; i < expert.length; i++) {
        expert[i].style.display = _style_pur;
        // document.getElementById(expert[i].id).style = _style;
    }

    // Enable / Disable die Optionen in den Menues für die Auswahl. Falls kein Expertenmodus soll nur ein Wert (built-in-led oder externan-flash-ws281x) möglich sein
    Array.from(document.querySelector("#GPIO_IO4_value1").options).forEach(function(option_element) {
        if (option_element.value != "built-in-led") {
            option_element.hidden = _hidden;
        }
    });	

    Array.from(document.querySelector("#GPIO_IO12_value1").options).forEach(function(option_element) {
        if (option_element.value != "external-flash-ws281x") {
            option_element.hidden = _hidden;
        }
    });
}

function UpdateTooltipModus() {
    var _style_pur = 'none';
    var _hidden = true;
	
    if (!document.getElementById("System_Tooltip_value1").selectedIndex) {
        _style_pur = '';
        _hidden = false;
        //firework.launch("Tooltip view activated.", 'warning', 5000);
    }

    const tooltip = document.querySelectorAll(".tooltip");
	
    for (var i = 0; i < tooltip.length; i++) {
        tooltip[i].style.display = _style_pur;
    }
}

function saveTextAsFile() {
    ReadParameterAll();
    if (document.getElementsByClassName("invalid-input").length > 0) {
        firework.launch("Settings cannot be saved. Please check your entries!", 'danger', 30000);
        return;
    }

	ReadParameterAll();
	WriteConfigININew();
	SaveConfigToServer(domainname);

    if(window.location.hash) {
        var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
		
        if(hash == 'description') {
            firework.launch('Configuration saved.', 'success', 2000);
        }
		else {
	        firework.launch('Configuration saved. It will get applied after the next reboot!<br><br>\n<a id="reboot_button" onclick="doReboot()">reboot now</a>', 'success', 5000);
	    }
    }
	else {
	    firework.launch('Configuration saved. It will get applied after the next reboot!<br><br>\n<a id="reboot_button" onclick="doReboot()">reboot now</a>', 'success', 5000);
	}

	if (changeCamValue == 1) {
		camSettingsSet();
		firework.launch('You have changed the camera settings, creating a new reference image and updating the alignment marks is mandatory!', 'success', 5000);
	}
}

function camSettingsSet(){
    document.getElementById("overlay").style.display = "block";
    document.getElementById("overlaytext").innerHTML = "Save Cam Settings...";
	
    var _waitb_temp = document.getElementById("TakeImage_WaitBeforeTakingPicture_value1").value;

    var _aecgc_temp = document.getElementById("TakeImage_CamGainceiling_value1").selectedIndex;
    var _qual_temp = document.getElementById("TakeImage_CamQuality_value1").value;	
                
    var _bri_temp = document.getElementById("TakeImage_CamBrightness_value1").value;
    var _con_temp = document.getElementById("TakeImage_CamContrast_value1").value;
    var _sat_temp = document.getElementById("TakeImage_CamSaturation_value1").value;
    var _shp_temp = document.getElementById("TakeImage_CamSharpness_value1").value;
	
    var _ashp_temp = document.getElementById("TakeImage_CamAutoSharpness_value1").value;
    if (_ashp_temp == '0') {
        _ashp_temp = '1';
    }
    else {
        _ashp_temp = '0';
    }	

    var _spe_temp = document.getElementById("TakeImage_CamSpecialEffect_value1").selectedIndex;
    var _wbm_temp = document.getElementById("TakeImage_CamWbMode_value1").selectedIndex;
	
    var _awb_temp = document.getElementById("TakeImage_CamAwb_value1").selectedIndex;
    if (_awb_temp == '0') {
        _awb_temp = '1';
    }
    else {
        _awb_temp = '0';
    }

    var _awbg_temp = document.getElementById("TakeImage_CamAwbGain_value1").selectedIndex;
    if (_awbg_temp == '0') {
        _awbg_temp = '1';
    }
    else {
        _awbg_temp = '0';
    }	

    var _aec_temp = document.getElementById("TakeImage_CamAec_value1").selectedIndex;
    if (_aec_temp == '0') {
        _aec_temp = '1';
    }
    else {
        _aec_temp = '0';
    }	
	
    var _aec2_temp = document.getElementById("TakeImage_CamAec2_value1").selectedIndex;
    if (_aec2_temp == '0') {
        _aec2_temp = '1';
    }
    else {
        _aec2_temp = '0';
    }
	
    var _ael_temp = document.getElementById("TakeImage_CamAeLevel_value1").value;
    var _aecv_temp = document.getElementById("TakeImage_CamAecValue_value1").value;

    var _agc_temp = document.getElementById("TakeImage_CamAgc_value1").selectedIndex;
    if (_agc_temp == '0') {
        _agc_temp = '1';
    }
    else {
        _agc_temp = '0';
    }	
	
    var _agcg_temp = document.getElementById("TakeImage_CamAgcGain_value1").value;
	
    var _bpc_temp = document.getElementById("TakeImage_CamBpc_value1").selectedIndex;
    if (_bpc_temp == '0') {
        _bpc_temp = '1';
    }
    else {
        _bpc_temp = '0';
    }
	
    var _wpc_temp = document.getElementById("TakeImage_CamWpc_value1").selectedIndex;
    if (_wpc_temp == '0') {
        _wpc_temp = '1';
    }
    else {
        _wpc_temp = '0';
    }	
	
    var _rgma_temp = document.getElementById("TakeImage_CamRawGma_value1").selectedIndex;
    if (_rgma_temp == '0') {
        _rgma_temp = '1';
    }
    else {
        _rgma_temp = '0';
    }	
	
    var _lenc_temp = document.getElementById("TakeImage_CamLenc_value1").selectedIndex;
    if (_lenc_temp == '0') {
        _lenc_temp = '1';
    }
    else {
        _lenc_temp = '0';
    }

    var _mirror_temp = document.getElementById("TakeImage_CamHmirror_value1").selectedIndex;
    if (_mirror_temp == '0') {
        _mirror_temp = '1';
    }
    else {
        _mirror_temp = '0';
    }
	
    var _flip_temp = document.getElementById("TakeImage_CamVflip_value1").selectedIndex;
    if (_flip_temp == '0') {
        _flip_temp = '1';
    }
    else {
        _flip_temp = '0';
    }	
	
    var _dcw_temp = document.getElementById("TakeImage_CamDcw_value1").selectedIndex;
    if (_dcw_temp == '0') {
        _dcw_temp = '1';
    }
    else {
        _dcw_temp = '0';
    }

    var _denoise_temp = document.getElementById("TakeImage_CamDenoise_value1").value;
    var _ledi_temp = document.getElementById("TakeImage_LEDIntensity_value1").value;

    var _zoom_temp = document.getElementById("TakeImage_CamZoom_value1").selectedIndex;
    if (_zoom_temp == '0') {
        _zoom_temp = '1';
    }
    else {
        _zoom_temp = '0';
    }

    var _zoomx_temp = document.getElementById("TakeImage_CamZoomOffsetX_value1").value;
    var _zoomy_temp = document.getElementById("TakeImage_CamZoomOffsetY_value1").value;
    var _zooms_temp = document.getElementById("TakeImage_CamZoomSize_value1").value;	
	
    var url = domainname + "/editflow?task=cam_settings";
	
    if (domainname.length > 0){
        url = url + "&host=" + domainname;		
    }
	
    url = url + "&waitb=" + _waitb_temp + "&aecgc=" + _aecgc_temp + "&qual=" + _qual_temp;
    url = url + "&bri=" + _bri_temp + "&con=" + _con_temp + "&sat=" + _sat_temp + "&shp=" + _shp_temp + "&ashp=" + _ashp_temp;
    url = url + "&spe=" + _spe_temp + "&wbm=" + _wbm_temp + "&awb=" + _awb_temp + "&awbg=" + _awbg_temp;
    url = url + "&aec=" + _aec_temp + "&aec2=" + _aec2_temp + "&ael=" + _ael_temp + "&aecv=" + _aecv_temp;

    url = url + "&agc=" + _agc_temp + "&agcg=" + _agcg_temp + "&bpc=" + _bpc_temp + "&wpc=" + _wpc_temp;
    url = url + "&rgma=" + _rgma_temp + "&lenc=" + _lenc_temp + "&mirror=" + _mirror_temp + "&flip=" + _flip_temp;
    url = url + "&dcw=" + _dcw_temp + "&den=" + _denoise_temp + "&ledi=" + _ledi_temp;

    if (_zoom_temp != '0') {
        url = url + "&zoom=" + _zoom_temp + "&zooms=" + _zooms_temp;
        url = url + "&zoomx=" + _zoomx_temp + "&zoomy=" + _zoomy_temp;
    }
    else {
        url = url + "&zoom=0" + "&zooms=0" + "&zoomx=0" + "&zoomy=0";
    }

    var durchlaufe = 0;

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
	
    async function task() {
        while (true) {
            var xhttp = new XMLHttpRequest();
			
            if (durchlaufe > 10) {
                document.getElementById("overlay").style.display = "none";
                firework.launch('Save Cam Settings aborted, timeout!', 'danger', 5000);
                return;
            }			

            try {
                xhttp.open("GET", url, false);
                xhttp.send();			
            } catch (error){}				
            
            if (xhttp.responseText == "CamSettingsSet") {
                document.getElementById("overlay").style.display = "none";
                firework.launch('Cam Settings saved', 'success', 2000);
                return;
            }
            else {
                // Get status
                var _xhttp = new XMLHttpRequest();
                durchlaufe = durchlaufe + 1;				
				
                try {
                    _xhttp.open("GET", domainname + "/statusflow", false);
                    _xhttp.send();
                }
                catch (error){}

                document.getElementById("overlaytext").innerHTML = "Device is busy, please wait.<br><br>Current step: " + _xhttp.responseText;
                console.log("Device is busy, waiting 2s then checking again...");
                await sleep(2000);
            }
        }   
    }

    setTimeout(function() { 
        // Delay so the overlay gets shown
        task();
    }, 1);
}
	
function doReboot() {
    var stringota = domainname + "/reboot";
    window.location = stringota;
    window.location.href = stringota;
    window.location.assign(stringota);
    window.location.replace(stringota);
}

function FormatDecimalValue(_param, _cat, _name) {
    for (var j = 1; j <= _param[_cat][_name]["anzParam"]; ++j) {
        var _val = _param[_cat][_name]["value"+j];
        _val = _val.replace(",", ".");
        _param[_cat][_name]["value"+j] = _val;
    }
}

function editConfigRaw() {
    if (confirm("Proceed to switch to raw edit mode? Unsaved changes will get lost")) {
        var stringota = domainname + "/edit_config_raw.html?v=$COMMIT_HASH";
        window.location = stringota;
        window.location.href = stringota;
        window.location.assign(stringota);
        window.location.replace(stringota);
    }	
}

function numberChanged() {
    var sel = document.getElementById("Numbers_value1");
    _neu = sel.selectedIndex;
    UpdateInputIndividual(sel);

    var _selInflux = document.getElementById("NumbersInfluxDBv2_value1");
    if (_selInflux.selectedIndex != _neu) {
        _selInflux.selectedIndex = _neu
    }

    var _sel3 = document.getElementById("NumbersInfluxDB_value1");
    if (_sel3.selectedIndex != _neu) {
        _sel3.selectedIndex = _neu
    }

    var _sel4 = document.getElementById("NumbersMQTTIdx_value1");
    if (_sel4.selectedIndex != _neu) {
        _sel4.selectedIndex = _neu
    }

}

function numberMQTTIdxChanged() {
    var sel = document.getElementById("NumbersMQTTIdx_value1");
    _neu = sel.selectedIndex;
    UpdateInputIndividual(sel);

    var _sel2 = document.getElementById("Numbers_value1");
    if (_sel2.selectedIndex != _neu) {
        _sel2.selectedIndex = _neu
    }

    var _sel3 = document.getElementById("NumbersInfluxDB_value1");
    if (_sel3.selectedIndex != _neu) {
        _sel3.selectedIndex = _neu
    }

    var _sel4 = document.getElementById("NumbersInfluxDBv2_value1");
    if (_sel4.selectedIndex != _neu) {
        _sel4.selectedIndex = _neu
    }
}
    
function numberInfluxDBv2Changed() {
    var sel = document.getElementById("NumbersInfluxDBv2_value1");
    _neu = sel.selectedIndex;
    UpdateInputIndividual(sel);

    var _sel2 = document.getElementById("Numbers_value1");
    if (_sel2.selectedIndex != _neu) {
        _sel2.selectedIndex = _neu
    }

    var _sel3 = document.getElementById("NumbersInfluxDB_value1");
    if (_sel3.selectedIndex != _neu) {
        _sel3.selectedIndex = _neu
    }

    var _sel4 = document.getElementById("NumbersMQTTIdx_value1");
    if (_sel4.selectedIndex != _neu) {
        _sel4.selectedIndex = _neu
    }
}

function numberInfluxDBChanged() {
    var sel = document.getElementById("NumbersInfluxDB_value1");
    _neu = sel.selectedIndex;
    UpdateInputIndividual(sel);
    
    var _sel2 = document.getElementById("Numbers_value1");
    if (_sel2.selectedIndex != _neu) {
        _sel2.selectedIndex = _neu
    }

    var _sel3 = document.getElementById("NumbersInfluxDBv2_value1");
    if (_sel3.selectedIndex != _neu) {
        _sel3.selectedIndex = _neu
    }

    var _sel4 = document.getElementById("NumbersMQTTIdx_value1");
    if (_sel4.selectedIndex != _neu) {
        _sel4.selectedIndex = _neu
    }
}

function getParameterByName(name, url = window.location.href) {
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
    results = regex.exec(url);

    if (!results) {return null;}
    if (!results[2]) {return '';}
	
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}	

function InvertEnableItem(_cat, _param) {
    _zw = _cat + "_" + _param + "_enabled";
    _isOn = document.getElementById(_zw).checked;

    _color = "rgb(122, 122, 122)";
	
    if (_isOn) {
        _color = "black";
    }

    _zw = _cat + "_" + _param + "_text";
    document.getElementById(_zw).disabled = !_isOn;
    document.getElementById(_zw).style.color = _color;

    setEnabled(_cat + "_" + _param, _isOn);

    for (var j = 1; j <= param[_cat][_param]["anzParam"]; ++j) {
        document.getElementById(_cat+"_"+_param+"_value"+j).disabled = !_isOn;	
        document.getElementById(_cat+"_"+_param+"_value"+j).style.color = _color;
    }
}

function setEnabled(className, enabled) {
    _color = "rgb(122, 122, 122)";
	
    if (enabled) {
        _color = "black";
    }

    let elements = document.getElementsByClassName(className);
    for (i = 0; i < elements.length; i++) {
        if (enabled) {
            elements[i].classList.remove("disabled");
        } 
        else {
            elements[i].classList.add("disabled");
        }

        let inputs = elements[i].getElementsByTagName("input");
        for (j = 0; j < inputs.length; j++) {
            if (inputs[j].id.endsWith("_enabled")) {
                continue;
            }

            inputs[j].style.color = _color;
            if (enabled) {
                inputs[j].removeAttribute("disabled");
            } 
            else {
                inputs[j].setAttribute("disabled", "disabled");
            }
        }
    }
}

function setVisible(className, visible) {
    let elements = document.getElementsByClassName(className);
	
    for (i = 0; i < elements.length; i++) {
        if (visible) {
            elements[i].classList.remove("hidden");
        } 
        else {
            elements[i].classList.add("hidden");
        }
    }
}

function EnDisableItem(_status, _param, _category, _cat, _name, _optional, _number = -1) {
    // _status = _category[_cat]["enabled"];
    _color = "rgb(122, 122, 122)";
	
    if (_status) {
        _color = "black";
    }

    if (_optional) {
        document.getElementById(_cat+"_"+_name+"_enabled").disabled = !_status;
        document.getElementById(_cat+"_"+_name+"_enabled").style.color = _color;	
    }

    if (_number == -1) {
        if (!_param[_cat][_name]["enabled"]) {
            _status = false;
            _color = "rgb(122, 122, 122)";
        }
    }
    else {
        if (!NUMBERS[_number][_cat][_name]["enabled"]) {
            _status = false;
            _color = "rgb(122, 122, 122)";
        }
    }

    let textElement = document.getElementById(_cat+"_"+_name+"_text");
    if (textElement) {
        textElement.disabled = !_status;
        textElement.style.color = _color;
    }

    setEnabled(_cat+"_"+_name, _status);

    for (var j = 1; j <= _param[_cat][_name]["anzParam"]; ++j) {
        document.getElementById(_cat+"_"+_name+"_value"+j).disabled = !_status;	
        document.getElementById(_cat+"_"+_name+"_value"+j).style.color = _color;	
    }
}

function ReadParameter(_param, _cat, _name, _optional, _number = -1) {
    if (_number > -1) {
        if (_cat == "Digits") {
            _cat = "digit";
        }
	    
        if (_cat == "Analog") {
            _cat = "analog";
        }

        if ((NUMBERS[_number] == undefined) || (NUMBERS[_number][_cat] == undefined) ||  (NUMBERS[_number][_cat][_name] == undefined)) {
            return;
        }

        if (_optional) {
            NUMBERS[_number][_cat][_name]["enabled"] = document.getElementById(_cat+"_"+_name+"_enabled").checked;			
        } else {
            NUMBERS[_number][_cat][_name]["enabled"] = true;  // Non-optional parameters are always enabled
        }

        for (var j = 1; j <= _param[_cat][_name]["anzParam"]; ++j) {
            let element = document.getElementById(_cat+"_"+_name+"_value"+j);
			
            if (element.tagName.toLowerCase() == "select") {
                NUMBERS[_number][_cat][_name]["value"+j] = element.selectedIndex > -1 ? element.options[element.selectedIndex].value : "";
            }
            else if ((element.getAttribute("type") != null) && (element.getAttribute("type").toLowerCase() == "checkbox")) {
                NUMBERS[_number][_cat][_name]["value"+j] = element.checked ? "true" : "false";
            }
            else {
                if ((NUMBERS[_number][_cat][_name].checkRegExList != null) && (NUMBERS[_number][_cat][_name].checkRegExList[j-1] != null)) {
                    if (!element.value.match(NUMBERS[_cat][_name].checkRegExList[j-1])) {
                        element.classList.add("invalid-input");
                    } 
                    else {
                        element.classList.remove("invalid-input");
                    }
                }
				
                NUMBERS[_number][_cat][_name]["value"+j] = element.value;
            }
        }
    }
    else
    {
        if (_optional) {
            _param[_cat][_name]["enabled"] = document.getElementById(_cat+"_"+_name+"_enabled").checked;			
        } else {
            _param[_cat][_name]["enabled"] = true;  // Non-optional parameters are always enabled
        }

        for (var j = 1; j <= _param[_cat][_name]["anzParam"]; ++j) {
            let element = document.getElementById(_cat+"_"+_name+"_value"+j);
			
            if (element.tagName.toLowerCase() == "select") {
                _param[_cat][_name]["value"+j] = element.selectedIndex > -1 ? element.options[element.selectedIndex].value : "";
            }
            else if ((element.getAttribute("type") != null) && (element.getAttribute("type").toLowerCase() == "checkbox")) {
                _param[_cat][_name]["value"+j] = element.checked ? "true" : "false";
            }
            else {
                if ((_param[_cat][_name].checkRegExList != null) && (_param[_cat][_name].checkRegExList[j-1] != null)) {
                    if (!element.value.match(_param[_cat][_name].checkRegExList[j-1])) {
                        element.classList.add("invalid-input");
                    } 
                    else {
                        element.classList.remove("invalid-input");
                    }
                }
				
                _param[_cat][_name]["value"+j] = element.value;
            }
        }		
    }
}

function WriteParameter(_param, _category, _cat, _name, _optional, _number = -1) {
    let anzpara;
    try {
        anzpara = _param[_cat][_name].anzParam;	
    }
    catch (error) {
        firework.launch("Parameter '" + _name + "' in category '" + _cat + "' is unknown!", 'danger', 30000);
        return;
    }

    if (_number > -1) {
        if ((NUMBERS[_number] == undefined) || (NUMBERS[_number][_cat] == undefined) ||  (NUMBERS[_number][_cat][_name] == undefined)) {
            return;
        }

        if (_optional) {
            document.getElementById(_cat+"_"+_name+"_enabled").checked = NUMBERS[_number][_cat][_name]["enabled"];
			
            for (var j = 1; j <= anzpara; ++j) {
                document.getElementById(_cat+"_"+_name+"_value"+j).disabled = !NUMBERS[_number][_cat][_name]["enabled"];	
            }		
        }
	    
        let textElement = document.getElementById(_cat+"_"+_name+"_text");
        if (textElement) {
            textElement.style.color = "black";
        }
        setEnabled(_cat+"_"+_name, true);

        for (var j = 1; j <= anzpara; ++j) {
            let element = document.getElementById(_cat+"_"+_name+"_value"+j);
			
            if (element.tagName.toLowerCase() == "select") {
                var textToFind = NUMBERS[_number][_cat][_name]["value"+j];
				
                if (textToFind == undefined || textToFind === "") {
                    continue;
                }

                _isFound = false;
                element.selectedIndex = -1;
				
                for (var i = 0; i < element.options.length; i++) {
                    if (element.options[i].value.toLowerCase() === textToFind.toLowerCase()) {
                        element.selectedIndex = i;
                        _isFound = true;
                        break;
                    }
                }
				
                if (!_isFound) {
                    _zw_txt = "In the selected field the value '" + textToFind + "' in the parameter '";
                    _zw_txt = _zw_txt + _cat + "' in the field '" + _name + "' is invalid. PLEASE CHECK BEFORE SAVING!";
                    firework.launch(_zw_txt, 'warning', 10000);
                }
            }
            else if ((element.getAttribute("type") != null) && (element.getAttribute("type").toLowerCase() == "checkbox")) {
                element.checked = NUMBERS[_number][_cat][_name]["value"+j] == "true";
            }
            else {
                element.value = NUMBERS[_number][_cat][_name]["value"+j];
            }
        }
    }
    else {
        if (_optional) {
            document.getElementById(_cat+"_"+_name+"_enabled").checked = _param[_cat][_name]["enabled"];
			
            for (var j = 1; j <= anzpara; ++j) {
                document.getElementById(_cat+"_"+_name+"_value"+j).disabled = !_param[_cat][_name]["enabled"];	
            }		
        }
		
        let textElement = document.getElementById(_cat+"_"+_name+"_text");
        if (textElement) {
            textElement.style.color = "black";
        }
        setEnabled(_cat+"_"+_name, true);

        for (var j = 1; j <= anzpara; ++j) {
            let element = document.getElementById(_cat+"_"+_name+"_value"+j);
			
            if (element.tagName.toLowerCase() == "select") {
                var textToFind = _param[_cat][_name]["value"+j];
				
                if (textToFind == undefined || textToFind === "") {
                    continue;
                }
                
                _isFound = false;
                element.selectedIndex = -1;
				
                for (var i = 0; i < element.options.length; i++) {
                    if (element.options[i].value.toLowerCase() === textToFind.toLowerCase()) {
                        element.selectedIndex = i;
                        _isFound = true;
                        break;
                    }
                }
				
                if (!_isFound) {
                    _zw_txt = "In the selected field the value '" + textToFind + "' in the section '";
                    _zw_txt = _zw_txt + _cat + "' in the field '" + _name + "' is invalid. PLEASE CHECK BEFORE SAVING!";
                    firework.launch(_zw_txt, 'warning', 10000);
                }

            }
            else if ((element.getAttribute("type") != null) && (element.getAttribute("type").toLowerCase() == "checkbox")) {
                element.checked = _param[_cat][_name]["value"+j] == "true";
            }
            else {
                element.value = _param[_cat][_name]["value"+j];
            }
        }	
    }

    ///////////////// am Ende, falls Kategorie als gesamtes nicht ausgewählt --> deaktivieren
    if (_category[_cat]["enabled"] == false) {
        if (_optional) {
            document.getElementById(_cat+"_"+_name+"_enabled").disabled = true;
			
            for (var j = 1; j <= anzpara; ++j) {
                document.getElementById(_cat+"_"+_name+"_value"+j).disabled = true;
            }	
        }
		
        let textElement = document.getElementById(_cat+"_"+_name+"_text");
        if (textElement) {
            textElement.style = "color: gray;";
        }
        setEnabled(_cat+"_"+_name, false);
    }

    EnDisableItem(_category[_cat]["enabled"], _param, _category, _cat, _name, _optional, _number);
}
	
/* hash #description open the details part of the page */
function openDescription() {
    if(window.location.hash) {
        var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
		
        if(hash == 'description') {
            document.getElementById("desc_details").open = true;
            // document.getElementById("reboot").style.display = "none";
            document.getElementById("reboot_text").style.display = "none";
        }
    }
}

openDescription();
LoadConfigNeu();
 
</script>
</body>
</html>
